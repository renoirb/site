__NUXT_JSONP__("/blog/tag/operations", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a_,a$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS,cT,cU,cV,cW,cX,cY,cZ,c_,c$,da,db,dc,dd,de,df,dg,dh,di,dj,dk,dl,dm,dn,do0,dp,dq,dr,ds,dt,du,dv,dw,dx,dy,dz,dA,dB,dC,dD,dE,dF,dG,dH,dI,dJ,dK,dL,dM,dN,dO,dP,dQ,dR,dS,dT,dU,dV,dW,dX,dY,dZ,d_,d$,ea,eb,ec,ed,ee,ef,eg,eh,ei,ej,ek,el,em,en,eo,ep,eq,er,es,et,eu,ev,ew,ex,ey,ez,eA,eB,eC,eD,eE,eF,eG,eH,eI,eJ,eK,eL,eM,eN,eO,eP,eQ,eR,eS,eT,eU,eV,eW,eX,eY,eZ,e_,e$,fa,fb,fc,fd,fe,ff,fg,fh,fi,fj,fk,fl,fm,fn,fo,fp,fq,fr,fs,ft,fu,fv,fw,fx,fy,fz,fA,fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f_,f$,ga,gb,gc,gd,ge,gf,gg,gh,gi,gj,gk,gl,gm,gn,go,gp,gq,gr,gs,gt,gu,gv,gw,gx,gy,gz,gA,gB,gC,gD,gE,gF,gG,gH,gI,gJ,gK,gL,gM,gN,gO,gP,gQ,gR,gS,gT,gU,gV,gW,gX,gY,gZ,g_,g$,ha,hb,hc,hd,he,hf,hg,hh,hi,hj,hk,hl,hm,hn,ho,hp,hq,hr,hs,ht,hu,hv,hw,hx,hy,hz,hA,hB,hC,hD,hE,hF,hG,hH,hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h_,h$,ia,ib,ic,id,ie,if0,ig,ih,ii,ij,ik,il,im,in0,io,ip,iq,ir,is,it,iu,iv,iw,ix,iy,iz,iA,iB,iC,iD,iE,iF,iG){return {data:[{},{},{contents:[{title:"Recover Discourse from a backup, adjust domain name",locale:aE,created:"2015-11-20T00:00:00.000Z",updated:aO,canonical:"https:\u002F\u002Frenoirboulanger.com\u002Fblog\u002F2015\u002F11\u002Frecover-discourse-backup-change-domain-name\u002F",status:ax,revising:R,migrateLinks:$,migrateImages:R,gallery:R,caption:R,categories:[dC],tags:[aH,ar,aI,aP],keywords:[cj,"DNS",ck],coverImage:{src:cl,text:cm},preamble:{text:"This was written at the time I was closing loops at the [end of my time with the W3C][leaving-w3c].\nThe intent at the time (before WebPlatform project closed was to host *discuss.webplatform.org* what is now known as [W3C‚Äôs Web Platform Incubator Community Group (WICG)][wicg-article] and is available as [discourse.wicg.io][wicg]\n[leaving-w3c]: \u002Fblog\u002F2015\u002F07\u002Fleaving-w3c\u002F \"Leaving W3C\"\n[wicg]: https:\u002F\u002Fdiscourse.wicg.io\u002F\n[wicg-article]: https:\u002F\u002Fwww.w3.org\u002Fblog\u002F2015\u002F07\u002Fwicg\u002F\n"},excerpt:"Here is some preliminary notes on how one can restore a Discourse instance and change the domain name.",toc:[],body:{type:ap,children:[{type:b,tag:f,props:{},children:[{type:a,value:"Roughly based on "},{type:b,tag:h,props:{href:dD,rel:[m,n,o],target:p},children:[{type:a,value:dE}]},{type:a,value:" post.\nBut without using the web UI. Because sysadmins prefers terminal."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:dF}]},{type:a,value:": Make "},{type:b,tag:E,props:{},children:[{type:a,value:"SURE"}]},{type:a,value:" the backup dump was generated from the same\nDiscourse version the one you'll import it into."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Copy from host backup into shared folder. Imagine you uploaded via SSH in your\nhost home directory."}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:dG}]},{type:a,value:" ~\u002Fsnapshot.tar.gz \u002Fsrv\u002Fwebplatform\u002Fshared\u002Fbackups\u002F\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Note that the folder "},{type:b,tag:j,props:{},children:[{type:a,value:"\u002Fsrv\u002Fwebplatform\u002Fdiscuss\u002Fshared\u002Fstandalone\u002Fbackups\u002F"}]},{type:a,value:" from\nthe docker host would end up to be in "},{type:b,tag:j,props:{},children:[{type:a,value:"\u002Fshared\u002Fbackups\u002F"}]},{type:a,value:" inside the container."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Enter the VM, make sure enable_restore is run from "},{type:b,tag:j,props:{},children:[{type:a,value:dH}]},{type:a,value:" cli utility"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:a,value:".\u002Flauncher enter app\ndiscourse enable_restore\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Find the mounted backup file from within the container"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"ll \u002Fshared\u002Fbackups\u002Fdefault\u002F\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Make sure "},{type:b,tag:j,props:{},children:[{type:a,value:"\u002Fshared\u002Fbackups\u002Ffoo.tar.gz"}]},{type:a,value:" is readable by can read"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"chmod"}]},{type:a,value:" o+r \u002Fshared\u002Fbackups\u002Fdefault\u002Ffoo.tar.gz\ndiscourse restore foo.tar.gz\ndiscourse disable_restore\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Remap domain name"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"discourse remap discourse.specifiction.org discuss.webplatform.org\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Then, work on user uploads and regenerate assets. That'll make sure ;"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"rake uploads:clean_up\nrake posts:rebake\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Refer to"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:dI,rel:[m,n,o],target:p},children:[{type:a,value:dI}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:"Most helpful post"}]},{type:a,value:l},{type:b,tag:h,props:{href:dD,rel:[m,n,o],target:p},children:[{type:a,value:dE}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:dJ,rel:[m,n,o],target:p},children:[{type:a,value:dJ}]},{type:a,value:", and\nthe "},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fdiscourse\u002Fdiscourse\u002Fblob\u002Fmaster\u002Fconfig\u002Fnginx.sample.conf",rel:[m,n,o],target:p},children:[{type:a,value:"referenced NGINX configuration in Discourse GitHub repo"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:dK,rel:[m,n,o],target:p},children:[{type:a,value:dK}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fops\u002Fissues\u002F152",rel:[m,n,o],target:p},children:[{type:a,value:"Work notes on WebPlatform GitHub issue tracker"}]}]},{type:a,value:e}]},{type:a,value:e}]},dir:"\u002Fblog\u002F2015\u002F11",path:"\u002Fblog\u002F2015\u002F11\u002Frecover-discourse-backup-change-domain-name",extension:ay,slug:"recover-discourse-backup-change-domain-name",createdAt:dL,updatedAt:dL,category:dC,prettyfiedTemporalDate:{prettified:"Friday, November 20, 2015",temporalDate:"2015-11-20"}},{title:"Managing my PGP\u002FOpenPGP keys and share across many machines",locale:aE,created:"2015-08-06T00:00:00.000Z",updated:aO,canonical:"https:\u002F\u002Frenoirboulanger.com\u002Fblog\u002F2015\u002F08\u002Fmanaging-pgp-private-keys-share-across-machines\u002F",status:ax,revising:R,migrateLinks:$,migrateImages:R,gallery:R,caption:R,categories:[aH],tags:[aQ,"vulgarization",ar,"security",aP],keywords:["PGP","subkey","OpenPGP"],excerpt:"A solution to the idea of sharing PGP private keys without risking to lose everything if one of the machines you shared it had been accessed.",preamble:{disable:$,text:l},toc:[],body:{type:ap,children:[{type:b,tag:f,props:{},children:[{type:a,value:"With "},{type:b,tag:aJ,props:{to:dM},children:[{type:a,value:"my previous position just finished"}]},{type:a,value:", I'm cleaning up my credential data\nI've stored on my computer. While doing so, I needed to update my PGP keys and I\nlearned something that I'm glad existed."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"When you use PGP to encrypt and\u002For sign your messages, you can only read\nmessages sent to you from the machine you have the private key. Right?"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The obvious solution would be to copy that private key everywhere; You mobile,\nservers, laptops."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"WRONG!"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The problem is that security experts would say that you shouldn't do that unless\nyou are certain things are \"safe\". But what is safe anyway, once somebody else,\nor a zombie process, accessed your machine, it's possible somebody gained access\nto your keys."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"OpenPGP has a way to address this issue and it's called \"SubKeys\". Quoting\n"},{type:b,tag:h,props:{href:"https:\u002F\u002Fwww.gnupg.org\u002Fgph\u002Fen\u002Fmanual.html#AEN526",rel:[m,n,o],target:p},children:[{type:a,value:"gnupg.org manual"}]}]},{type:a,value:e},{type:b,tag:bj,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"By default, a DSA master signing key and an ElGamal encryption subkey are\ngenerated when you create a new keypair. This is convenient, because the roles\nof the two keys are different, (...). The master signing key is used to make\ndigital signatures (...). The encryption key is used only for decrypting\nencrypted documents sent to you."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"This made me think I should make sure that I create a subkey, backup my main\nidentity, erase any traces of it from my main computer, then import the new\nsubkey."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"That way, I would only need to use the main key to update the data on key\nservers and to edit my keys."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"A nice effect of this way of working is that we can revoke a subkey. Since\nsubkeys, signatures and revocation are part of the public key that you sync with\nkey on keyservers, you can make the compromised subkey invalid."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The compromised key will be able to decrypt messages sent for that private\nsubkey, provided the attacker can also gain access to where the messages are\nstored, but you won't lose the most important part of the identity system.\nYou'll be able to create another subkey and keep the same identity."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"I hope I got it right. If I'm wrong, don't hesitate to tell me and I'll adjust!"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"I got to read more about all of this, but I am glad I learned about subkeys."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Here are some notes I found that helped me understand this all better."}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Falexcabal.com\u002Fcreating-the-perfect-gpg-keypair\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"AlexCabal: Creating the perfect GPG keypair"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fwiki.debian.org\u002FSubkeys",rel:[m,n,o],target:p},children:[{type:a,value:"Debian Wiki: Using OpenPGP subkeys"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"http:\u002F\u002Firtfweb.ifa.hawaii.edu\u002F~lockhart\u002Fgpg\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"GPG quick cheat sheet"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fsuperuser.com\u002Fquestions\u002F466396\u002Fhow-to-manage-gpg-keys-across-multiple-systems",rel:[m,n,o],target:p},children:[{type:a,value:"SuperUser: How to manage GPG keys across multiple systems"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fhelp.riseup.net\u002Fen\u002Fsecurity\u002Fmessage-security\u002Fopenpgp\u002Fbest-practices",rel:[m,n,o],target:p},children:[{type:a,value:"OpenPGP best practices"}]}]},{type:a,value:e}]}]},dir:"\u002Fblog\u002F2015\u002F08",path:"\u002Fblog\u002F2015\u002F08\u002Fmanaging-pgp-private-keys-share-across-machines",extension:ay,slug:"managing-pgp-private-keys-share-across-machines",createdAt:bD,updatedAt:bD,category:aH,prettyfiedTemporalDate:{prettified:"Thursday, August 6, 2015",temporalDate:"2015-08-06"}},{title:"Migrating WebPlatform.org MediaWiki into Git as Markdown files",locale:aE,created:"2015-07-30T00:00:00.000Z",updated:"2020-11-18T00:00:00.000Z",status:ax,revising:$,categories:[am],tags:["archiving",cn,ar,aP],description:"How to take a full MediaWiki content and edit history into a Git repository keeping the history and author attributions into Markdown",coverImage:{src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F07\u002Fmonit_dashboard_201502_status.png",text:"The WebPlatform project was running from a about 20 VMs\nand the availability, in part, managed by Monit.\nAt the end of the project, the infrastructure \"had to go away\"\n"},preamble:{disable:$,text:l},toc:[{id:dN,depth:U,text:dO},{id:dP,depth:U,text:dQ},{id:ck,depth:U,text:dR},{id:co,depth:ab,text:dS},{id:dT,depth:ab,text:bk},{id:dU,depth:U,text:cp},{id:dV,depth:ab,text:cq},{id:bE,depth:U,text:bF}],body:{type:ap,children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"On July 1st 2015, "},{type:b,tag:x,props:{},children:[{type:a,value:"The WebPlatform project"}]},{type:a,value:" has been discontinued, by having\n"},{type:b,tag:h,props:{href:"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20130328132045\u002Fhttp:\u002F\u002Fwww.webplatform.org\u002Fstewards\u002F",rel:[m,n,o],target:p,title:"WebPlatform Project sponsors"},children:[{type:a,value:"its sponsors"}]},{type:a,value:" retracting from the project."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"I was hired by the W3C solely to maintain the WebPlatform project. Without\nfunding, and no budget at W3C\u002FMIT to transfer me, my contract was going to end."}]},{type:a,value:e},{type:a,value:e},{type:b,tag:cr,props:{style:dW},children:[{type:a,value:"\nüëÄ This was written in December 2020 and taken from notes I‚Äôve been sharing around via email.\n"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"With me as the only full-time person on the project with knowledge of the\ninfrastructure, and also as a believer of ‚Äú"},{type:b,tag:h,props:{href:"https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FLearn\u002FGetting_started_with_the_web\u002FThe_web_and_web_standards#Dont_break_the_web",rel:[m,n,o],target:p},children:[{type:a,value:"don‚Äôt break the\nweb"}]},{type:a,value:"‚Äù, I wanted to keep everything online."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"When "},{type:b,tag:h,props:{href:"https:\u002F\u002Fwebplatform.github.io\u002Fblog\u002F2013\u002F08\u002Fhi-my-name-s-renoir-ill-be-your-devops-for-the-web-platform\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"I inherited the project"}]},{type:a,value:", I "},{type:b,tag:h,props:{href:"https:\u002F\u002Fwebplatform.github.io\u002Fdocs\u002FWPD\u002FInfrastructure\u002Fanalysis\u002F2013-Migrating_to_a_new_cloud_provider\u002F",rel:[m,n,o],target:p,title:"2013 Infrastructure project: Migrating to a new provider"},children:[{type:a,value:"went through migrating\n"},{type:b,tag:x,props:{},children:[{type:a,value:"from one cloud provider to another"}]}]},{type:a,value:" the full\ninfrastructure, "},{type:b,tag:h,props:{href:"https:\u002F\u002Fwebplatform.github.io\u002Fdocs\u002FWPD\u002FInfrastructure\u002Fanalysis\u002F2013-Usage_and_future_state\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"it has been running from about 20 Linux\nVMs"}]},{type:a,value:", worked on a few projects such as an attempt at having\nSingle-SignOn, and better compatibility tables."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Since the project was being closed, most of what I‚Äôve worked lost their use. The\ninfrastructure was also going to become a burden."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"While planning my last weeks, I‚Äôve agreed with the W3C systems team\n\""},{type:b,tag:h,props:{href:dX,rel:[m,n,o],target:p},children:[{type:a,value:"w3t-systeam"}]},{type:a,value:"\" to convert as much as possible as a static site."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The following are notes about the software I‚Äôve written to migrate a WordPress\nblog and multiple MediaWiki namespaces into a Git repository."}]},{type:a,value:e},{type:b,tag:Z,props:{id:dN},children:[{type:b,tag:h,props:{href:"#priorities",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:dO}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The priorities were to keep the documentation pages up, preserve the\ncontribution history and attributions, also keep the blog contents, and have\neverything to be served as static HTML hosted on GitHub pages."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"I wanted to have this done before "},{type:b,tag:aJ,props:{to:dM},children:[{type:a,value:"I leave the W3C"}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Since the "},{type:b,tag:h,props:{href:dX,rel:[m,n,o],target:p},children:[{type:a,value:"SysTeam"}]},{type:a,value:" would keep control of the "},{type:b,tag:j,props:{},children:[{type:a,value:cs}]},{type:a,value:"\ndomain, they‚Äôve decided to support some redirect from the original domain to\n"},{type:b,tag:h,props:{href:dY,rel:[m,n,o],target:p,title:dZ},children:[{type:a,value:bG}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Once everything was migrated, we‚Äôve added a note;"}]},{type:a,value:e},{type:b,tag:bj,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The WebPlatform project, supported by various stewards between 2012 and 2015,\nhas been discontinued"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:"sup",props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:d_},{type:b,tag:h,props:{href:dY,rel:[m,n,o],target:p,title:dZ},children:[{type:a,value:bG}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:Z,props:{id:dP},children:[{type:b,tag:h,props:{href:"#outcome",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:dQ}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The conversion work took the "},{type:b,tag:x,props:{},children:[{type:a,value:"two last months"}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"All links to pages showing the "},{type:b,tag:x,props:{},children:[{type:a,value:"WebPlatform"}]},{type:a,value:" logo from this article is the\nresult of what I‚Äôm describing here, as the migration and all servers were shut\ndown and decommissioned in 2016."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The source of the site was generated from\n"},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fgenerator-docs",rel:[m,n,o],target:p},children:[{type:a,value:"webplatform\u002Fgenerator-docs"}]},{type:a,value:", and we‚Äôve created\n"},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fwebplatform.github.io\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"webplatform\u002Fwebplatform.github.io"}]},{type:a,value:"\nto host the site on GitHub pages. Eventualy, the W3C SysTeam set the repository\nas read-only."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"There were other things that we‚Äôve initially planned, but couldn‚Äôt (see\n"},{type:b,tag:aJ,props:{to:"\u002Fblog\u002F2015\u002F07\u002Fmigrating-webplatform-org-mediawiki-into-git-history-and-into-markdown-files#requirements-we-couldnt-meet"},children:[{type:a,value:cq}]},{type:a,value:"):"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Here is what I could migrate"}]},{type:a,value:e},{type:b,tag:s,props:{style:"font-size:small",className:["table-parent","table-auto"]},children:[{type:a,value:e},{type:a,value:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{type:b,tag:d$,props:{},children:[{type:b,tag:ea,props:{},children:[{type:b,tag:aB,props:{},children:[{type:b,tag:aF,props:{},children:[{type:a,value:"From"}]},{type:b,tag:aF,props:{},children:[{type:a,value:"To"}]},{type:b,tag:aF,props:{},children:[{type:a,value:"Repository"}]},{type:b,tag:aF,props:{},children:[{type:a,value:"Comment"}]},{type:b,tag:aF,props:{},children:[{type:a,value:"Commits"}]},{type:b,tag:aF,props:{},children:[{type:a,value:"Documents"}]},{type:b,tag:aF,props:{},children:[{type:a,value:"Deleted"}]}]}]},{type:b,tag:eb,props:{},children:[{type:b,tag:aB,props:{},children:[{type:b,tag:L,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"docs.webplatform.org\u002Fwiki\u002F*"}]}]},{type:b,tag:L,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"webplatform.github.io\u002Fdocs\u002F*"}]}]},{type:b,tag:L,props:{},children:[{type:b,tag:h,props:{href:ec,rel:[m,n,o],target:p,title:ed},children:[{type:a,value:"webplatform\u002Fdocs"}]}]},{type:b,tag:L,props:{},children:[{type:a,value:"The main docs pages"}]},{type:b,tag:L,props:{},children:[{type:a,value:"37,000"}]},{type:b,tag:L,props:{},children:[{type:a,value:"4,675"}]},{type:b,tag:L,props:{},children:[{type:a,value:"418"}]}]},{type:b,tag:aB,props:{},children:[{type:b,tag:L,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"docs.webplatform.org\u002Fwiki\u002FMeta:*"}]}]},{type:b,tag:L,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"webplatform.github.io\u002Fdocs\u002FMeta\u002F*"}]}]},{type:b,tag:L,props:{},children:[{type:b,tag:h,props:{href:ee,rel:[m,n,o],target:p,title:ef},children:[{type:a,value:"webplatform\u002Fdocs-meta"}]}]},{type:b,tag:L,props:{},children:[{type:a,value:"Archived content that needed to be moved during initial mass imports."}]},{type:b,tag:L,props:{},children:[{type:a,value:"300"}]},{type:b,tag:L,props:{},children:[{type:a,value:"58"}]},{type:b,tag:L,props:{},children:[{type:a,value:"170"}]}]},{type:b,tag:aB,props:{},children:[{type:b,tag:L,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"docs.webplatform.org\u002Fwiki\u002FWPD:*"}]}]},{type:b,tag:L,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"webplatform.github.io\u002Fdocs\u002FWPD\u002F*"}]}]},{type:b,tag:L,props:{},children:[{type:b,tag:h,props:{href:ct,rel:[m,n,o],target:p,title:cu},children:[{type:a,value:eg}]}]},{type:b,tag:L,props:{},children:[{type:a,value:"Community and notes section. Example "},{type:b,tag:h,props:{href:"https:\u002F\u002Fweb.archive.org\u002Fweb\u002F20160722084044\u002Fhttps:\u002F\u002Fdocs.webplatform.org\u002Fwiki\u002FWPD:Infrastructure",rel:[m,n,o],target:p},children:[{type:a,value:"\u002Fwiki\u002FWPD:Infrastructure"}]},{type:a,value:" into "},{type:b,tag:h,props:{href:"https:\u002F\u002Fwebplatform.github.io\u002Fdocs\u002FWPD\u002FInfrastructure\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"\u002Fdocs\u002FWPD\u002FInfrastructure"}]},{type:a,value:eh},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fdocs-wpd\u002Fblob\u002Fmanual-edits\u002FInfrastructure\u002Findex.md",rel:[m,n,o],target:p},children:[{type:a,value:"source"}]},{type:a,value:ag}]},{type:b,tag:L,props:{},children:[{type:a,value:"5,700"}]},{type:b,tag:L,props:{},children:[{type:a,value:"358"}]},{type:b,tag:L,props:{},children:[{type:a,value:"323"}]}]},{type:b,tag:aB,props:{},children:[{type:b,tag:L,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"blog.webplatform.org"}]}]},{type:b,tag:L,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"webplatform.github.io\u002Fblog\u002F*"}]}]},{type:b,tag:L,props:{},children:[{type:b,tag:h,props:{href:ei,rel:[m,n,o],target:p},children:[{type:a,value:"webplatform\u002Fblog"}]}]},{type:b,tag:L,props:{},children:[{type:a,value:"The blog content"}]},{type:b,tag:L,props:{},children:[{type:a,value:bH}]},{type:b,tag:L,props:{},children:[{type:a,value:"53"}]},{type:b,tag:L,props:{},children:[{type:a,value:"N\u002FA"}]}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:Z,props:{id:ck},children:[{type:b,tag:h,props:{href:"#migration",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:dR}]},{type:a,value:e},{type:b,tag:cr,props:{style:dW},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"üëÄ During this migration project, I was hoping to find a way to take any web\npage, from any CMS, and get a full copy (including images) of it into Markdown.\nThere was none. In 2017, I‚Äôve created\n"},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Frenoirb\u002Farchivator",rel:[m,n,o],target:p},children:[{type:b,tag:x,props:{},children:[{type:a,value:ej}]}]},{type:a,value:ek},{type:b,tag:h,props:{href:"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Farchivator",rel:[m,n,o],target:p},children:[{type:a,value:"npm"}]},{type:a,value:") to help with such work.\nInstead of using the last step described here, anyone could use "},{type:b,tag:x,props:{},children:[{type:a,value:ej}]},{type:a,value:" to\nretrieve a copy of their web pages."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"While building the solution, a few requirements emerged, they‚Äôre listed in\n"},{type:b,tag:aJ,props:{to:"\u002Fblog\u002F2015\u002F07\u002Fmigrating-webplatform-org-mediawiki-into-git-history-and-into-markdown-files#requirements"},children:[{type:a,value:cp}]}]},{type:a,value:e},{type:b,tag:ac,props:{id:co},children:[{type:b,tag:h,props:{href:"#blog",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:dS}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"For migrating the "},{type:b,tag:h,props:{href:ei,rel:[m,n,o],target:p},children:[{type:a,value:co}]},{type:a,value:", it was made manually, I‚Äôve just\nconverted the HTML into Markdown using Pandoc."}]},{type:a,value:e},{type:b,tag:ac,props:{id:dT},children:[{type:b,tag:h,props:{href:"#mediawiki",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:bk}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"For migrating MediaWiki, the proces was a bit more complex."}]},{type:a,value:e},{type:b,tag:cr,props:{title:"Want to migrate your own MediaWiki?"},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"ü§≤üèº If you‚Äôre looking for an HowTo to migrate your own MediaWiki installation,\n"},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fmediawiki-conversion#use",rel:[m,n,o],target:p},children:[{type:a,value:"the procedure is written in ‚û°Ô∏è "},{type:b,tag:E,props:{},children:[{type:a,value:cv}]},{type:a,value:"‚Äôs README"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"To migrate, we needed an history of each pages, from creation to the last edit."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"With MediaWiki, we have "},{type:b,tag:h,props:{href:"https:\u002F\u002Fwww.mediawiki.org\u002Fwiki\u002FManual:DumpBackup.php",rel:[m,n,o],target:p,title:"dumpBackup.php file creates an XML dump for export or backup. XML dumps contain the content of the wiki"},children:[{type:b,tag:E,props:{},children:[{type:a,value:"Manual:DumpBackup.php"}]}]},{type:a,value:", that creates\nan XML file (\""},{type:b,tag:x,props:{},children:[{type:a,value:el}]},{type:a,value:"\") of all history of all pages. One per\n"},{type:b,tag:h,props:{href:em,rel:[m,n,o],target:p},children:[{type:a,value:"namespace"}]},{type:a,value:", for WebPlatform Docs‚Äô wikis, we had:\n"},{type:b,tag:h,props:{href:ee,rel:[m,n,o],target:p,title:ef},children:[{type:b,tag:j,props:{},children:[{type:a,value:"\u002Fwiki\u002FMeta:*"}]}]},{type:a,value:aR},{type:b,tag:h,props:{href:ct,rel:[m,n,o],target:p,title:cu},children:[{type:b,tag:j,props:{},children:[{type:a,value:en}]}]},{type:a,value:",\n"},{type:b,tag:h,props:{href:ec,rel:[m,n,o],target:p,title:ed},children:[{type:b,tag:j,props:{},children:[{type:a,value:"\u002Fwiki\u002F*"}]}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"A big part of processing and converting history is about the data model so we\ncould read from one format and use the data model as data-source for conversion."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"For this, I‚Äôve created "},{type:b,tag:h,props:{href:eo,rel:[m,n,o],target:p,title:ep},children:[{type:a,value:eq}]},{type:a,value:", an\nabstract library specialized for data manipulation to help \""},{type:b,tag:x,props:{},children:[{type:a,value:"Transform CMS\ncontent from a format into another"}]},{type:a,value:" [format]\". It‚Äôs written in PHP, and might\nstill work even though it hasn‚Äôt been touched since 2015."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:h,props:{href:eo,rel:[m,n,o],target:p,title:ep},children:[{type:a,value:eq}]},{type:a,value:" takes care of manipulating\ndata for:"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Date of contribution and author information"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Content management systems like "},{type:b,tag:x,props:{},children:[{type:a,value:bk}]},{type:a,value:" has a way to tell the user and\ndate of an edition."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Take each edit contents as they were"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Do not change any of the contents for each edits, even though they are in a\nformat understood by the original engine, here being "},{type:b,tag:x,props:{},children:[{type:a,value:bk}]},{type:a,value:T}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"To convert each page history edit into "},{type:b,tag:E,props:{},children:[{type:a,value:"Git commits"}]},{type:a,value:", I‚Äôve created\n"},{type:b,tag:h,props:{href:cw,rel:[m,n,o],target:p,title:cx},children:[{type:a,value:cv}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"This is the utility that takes care of making the conversion "},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fmediawiki-conversion\u002Fblob\u002Fmaster\u002Fsrc\u002FWebPlatform\u002FImporter\u002FCommands\u002FRunCommand.php#L48",rel:[m,n,o],target:p,title:"Comments describing mediawiki-conversion"},children:[{type:a,value:"see comments made\nhere"}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:ak,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:"Handle deleted pages"}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"For each edit create a git revisions commit until the final file delete. At\nthe end of that step, the Git repository should have an history, but no\naparent files. At this step, we can also use the entries and make a redirect\nmap."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:"Handle pages that weren‚Äôt deleted in history"}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Do the same as above. At this step, we should have a repository with text\nfiles where each file has exactly the same content as the source history. So\nwe can add them on top of the deleted pages following the same process as\nabove. We can also use those as a list of current pages we‚Äôll want to be\nconverted into Markdown."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:"Convert content"}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"For all pages "},{type:b,tag:x,props:{},children:[{type:a,value:"that weren‚Äôt deleted in history"}]},{type:a,value:". Query "},{type:b,tag:x,props:{},children:[{type:a,value:bk}]},{type:a,value:" API to\nretrieve the full HTML, including "},{type:b,tag:h,props:{href:"https:\u002F\u002Fwww.mediawiki.org\u002Fwiki\u002FTransclusion",rel:[m,n,o],target:p},children:[{type:a,value:"Transclusions"}]},{type:a,value:" pass it to\nPandoc, so we get it converted into Markdown. Commit the rewritten file\ncontents with Markdown."}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"By design "},{type:b,tag:h,props:{href:cw,rel:[m,n,o],target:p,title:cx},children:[{type:a,value:cv}]},{type:a,value:" allows to\nre-run the 3rd step so we could always get all edits until we\n"},{type:b,tag:h,props:{href:"https:\u002F\u002Fwww.mediawiki.org\u002Fwiki\u002FManual:Lock_the_database",rel:[m,n,o],target:p},children:[{type:b,tag:x,props:{},children:[{type:a,value:"Lock the database"}]},{type:a,value:" (i.e. cut-off)"}]},{type:a,value:"\nso we could keep the production site active until a cut-off date."}]},{type:a,value:e},{type:a,value:e},{type:b,tag:Z,props:{id:dU},children:[{type:b,tag:h,props:{href:"#requirements",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:cp}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Along with what's described in the\n"},{type:b,tag:aJ,props:{to:"\u002Fblog\u002F2015\u002F07\u002Fmigrating-webplatform-org-mediawiki-into-git-history-and-into-markdown-files#migration-steps"},children:[{type:a,value:"Migration steps"}]},{type:a,value:",\nwe wanted also to ensure we properly support the following."}]},{type:a,value:e},{type:b,tag:ak,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Keep author attributions but have them anonymized"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"We didn‚Äôt want to leak all contributor‚Äôs accounts email addresses to be\npublished without their consent. So, I‚Äôve setup a "},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fdocs\u002Fblob\u002Fmanual-edits\u002F.mailmap",rel:[m,n,o],target:p},children:[{type:b,tag:j,props:{},children:[{type:a,value:".mailmap"}]},{type:a,value:" so that\ncontributors could add a PR to advertize publicly on GitHub"}]},{type:a,value:T}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Keep code examples in Markdown so we can colourize them"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Golden standard pages should look the same"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The \"Golden Standard\" pages were ones we were regularly referring to see how\nthey would look and see if things are broken."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Also, since we were removing infrastructure, we should see features that were\nenabled at the time of "},{type:b,tag:x,props:{},children:[{type:a,value:"Web.Archive.org"}]},{type:a,value:" snapshot, but would be omitted in\nthe "},{type:b,tag:x,props:{},children:[{type:a,value:"Static version"}]},{type:a,value:" (i.e. "},{type:b,tag:j,props:{},children:[{type:a,value:bG}]},{type:a,value:ag}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:"Compatibility data"}]},{type:a,value:" was removed"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:"Contents"}]},{type:a,value:" on the right should be removed"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:"Overview table"}]},{type:a,value:" should look different"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"On "},{type:b,tag:x,props:{},children:[{type:a,value:"static version"}]},{type:a,value:" code blocks should be more colorized differently (it's\nusing a different process)"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Examples:"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002Fcss\u002Fproperties\u002Fborder-radius"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002Fcss\u002Fproperties\u002Fdisplay"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002Fjavascript\u002Ffunctions","web-archive-date":"20140626071828"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002Fjavascript\u002FArray\u002Ffilter"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002Fjavascript\u002FDate"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002FBeginners\u002Fhtml","web-archive-date":er},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002Ftutorials\u002Fcanvas_notearsgame","web-archive-date":er},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002Ftutorials\u002Fsvg_clipping_and_masking","web-archive-date":"20150905205843"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:bl}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"MediaWiki is pretty relax about what it allows in its URLs."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Since we‚Äôre migrating into a filesystem, we wanted to have only valid\nfilesystem file names and decided to normalize all paths into ASCII\ncharacters."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"For example, the "},{type:b,tag:h,props:{href:em,rel:[m,n,o],target:p},children:[{type:a,value:"Namespaces"}]},{type:a,value:" (e.g. "},{type:b,tag:j,props:{},children:[{type:a,value:en}]},{type:a,value:") adds a\ncolumn character, that would be URLEncoded into "},{type:b,tag:j,props:{},children:[{type:a,value:"%3A"}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"There were many other discrepancies like:"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Case insensitivity ‚Äî Because some URLs in pages were not in the same casing"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Supporting spaces ‚Äî Sometimes with underscore \""},{type:b,tag:j,props:{},children:[{type:a,value:"_"}]},{type:a,value:"\", other times with "},{type:b,tag:j,props:{},children:[{type:a,value:"%20"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Normalize\n"},{type:b,tag:h,props:{href:"https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FAPI\u002FURL\u002Fpathname",rel:[m,n,o],target:p},children:[{type:a,value:"URL Path"}]},{type:a,value:ek},{type:b,tag:h,props:{href:"https:\u002F\u002Furl.spec.whatwg.org\u002F#concept-url-path",rel:[m,n,o],target:p},children:[{type:a,value:"spec"}]},{type:a,value:") (e.g. anything that\nwould be URLEncoded such as "},{type:b,tag:j,props:{},children:[{type:a,value:"()!@:"}]},{type:a,value:ag}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:bl}]},{type:a,value:": A page in another language should\nbe migrated"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002FMain_Page\u002Fja","web-archive-date":"20160613060459"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002FMain_Page\u002Fko"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:bl}]},{type:a,value:": A Page with "},{type:b,tag:j,props:{},children:[{type:a,value:"()"}]},{type:a,value:" in URL should be\nnormalized"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002Fcss\u002Ffunctions\u002Ftranslate()"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002Fsvg\u002Fproperties\u002FanimVal_(SVGAnimatedPreserveAspectRatio)"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002Fsvg\u002Fproperties\u002Fcx_(SVGRadialGradientElement)"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:bl}]},{type:a,value:": Pages within WPD namespace should\nbe migrated"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002FWPD:Infrastructure\u002FMonitoring\u002FMonit"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002FWPD:Infrastructure\u002Fanalysis\u002F2013-Migrating_to_a_new_cloud_provider"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The image comes from "},{type:b,tag:j,props:{},children:[{type:a,value:"\u002FWPD\u002Fassets\u002F"}]},{type:a,value:" which means the image is hosted in the\n"},{type:b,tag:h,props:{href:ct,rel:[m,n,o],target:p,title:cu},children:[{type:a,value:eg}]},{type:a,value:" in the assets\u002F folder."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:bl}]},{type:a,value:": Pages in Meta namespace should be\nmigrated"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002FMeta:HTML\u002FElements\u002Fstyle"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002FMeta:web_platform_wednesday"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002FMeta:Editors_Guide"},children:[{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ac,props:{id:dV},children:[{type:b,tag:h,props:{href:"#requirements-we-couldnt-meet",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:cq}]},{type:a,value:e},{type:a,value:e},{type:b,tag:ak,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Ensure ALL assets uploads are displayed properly"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Before, we would use GlusterFS to store images for MediaWiki. There has been\nwork made to store on "},{type:b,tag:j,props:{},children:[{type:a,value:cy}]},{type:a,value:", all the pages uses the link,\nbut the SysTeam decided not to keep the redirects."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Now that the site is archived, I‚Äôm unsure this can be fixed."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"If you want to see them, add this bookmarklet to your bookmarks bar\n"},{type:b,tag:h,props:{style:"text-decoration:none;display:inline-block;padding: 1px 6px;color: #fff;background: #32a0eb;-webkit-border-radius: 4px;-moz-border-radius: 4px;border-radius: 4px;",href:"javascript:(function()%7B%5B%5D.forEach.call(document.querySelectorAll('img')%2Cfunction(img)%7Bif%20('src'%20in%20img)%20%7Bsrc%20%3D%20img.src%3Bsrc%20%3D%20src.replace('static.webplatform.org'%2C%20'webplatform.github.io%2Fdocs-assets')%3Bimg.src%3Dsrc%3B%7D%7D)%7D)()"},children:[{type:a,value:"WebPlatform.github.io\nShow images"}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The project "},{type:b,tag:h,props:{href:es,rel:[m,n,o],target:p},children:[{type:a,value:es}]},{type:a,value:" was meant to be used as\nan origin for "},{type:b,tag:j,props:{},children:[{type:a,value:cy}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:"Should we want to fix the issue"}]},{type:a,value:", we could setup an HTTP redirect from\n"},{type:b,tag:j,props:{},children:[{type:a,value:cy}]},{type:a,value:" to "},{type:b,tag:j,props:{},children:[{type:a,value:"webplatform.github.io\u002Fdocs-assets\u002F"}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The following (should be) the same file;"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:et,rel:[m,n,o],target:p},children:[{type:a,value:et}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:eu,rel:[m,n,o],target:p},children:[{type:a,value:eu}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:ev,rel:[m,n,o],target:p},children:[{type:a,value:ev}]}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Make sure page links "},{type:b,tag:x,props:{},children:[{type:a,value:"with different casing"}]},{type:a,value:" are redirected properly"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"For example the page for \""},{type:b,tag:j,props:{},children:[{type:a,value:"Internet_and_Web"}]},{type:a,value:"\" is sometimes linked with\ndifferent casing, e.g. at \""},{type:b,tag:j,props:{},children:[{type:a,value:"Internet_and_Web\u002FThe_History_of_the_Web"}]},{type:a,value:"\" or\n\""},{type:b,tag:j,props:{},children:[{type:a,value:"internet_and_web\u002FThe_History_of_the_Web"}]},{type:a,value:"\", it is migrated once;\n"},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002Fconcepts\u002FInternet_and_Web\u002FThe_History_of_the_Web"},children:[]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Some page has links to with different casing \""},{type:b,tag:j,props:{},children:[{type:a,value:"internet_and_web"}]},{type:a,value:"\", we can see\nfrom\n"},{type:b,tag:ad,props:{slug:"docs.webplatform.org\u002Fwiki\u002Fconcepts"},children:[]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"MediaWiki would redirect, but on GitHub pages, nothing has been put in place\nfor those. If we wanted to support, we could have used the same entries used\nto create "},{type:b,tag:h,props:{href:ew,rel:[m,n,o],target:p},children:[{type:a,value:"NGINX rewrite rules"}]},{type:a,value:", and add empty HTML pages\nlike GitHub pages would. In the case of WebPlatform project, it's been\ndecided to leave as-is."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Enforce all redirects from "},{type:b,tag:j,props:{},children:[{type:a,value:"*.webplatform.org"}]},{type:a,value:" to properly redirect to\n"},{type:b,tag:j,props:{},children:[{type:a,value:bG}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"This migration process supported creating "},{type:b,tag:h,props:{href:ew,rel:[m,n,o],target:p},children:[{type:a,value:"NGINX rewrite\nrules"}]},{type:a,value:", I‚Äôm unsure if they‚Äôve been used."}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:"hr",props:{},children:[]},{type:a,value:e},{type:b,tag:Z,props:{id:bE},children:[{type:b,tag:h,props:{href:ex,ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:bF}]},{type:a,value:e},{type:b,tag:s,props:{style:cz,className:[cA,cB]},children:[{type:a,value:e},{type:b,tag:ah,props:{figcaption:l,src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F07\u002Fmediawiki-history-to-git-conversion.png"},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:h,props:{href:cw,rel:[m,n,o],target:p,title:cx},children:[{type:a,value:"WebPlatform\u002Fmediawiki-conversion"}]},{type:a,value:" is made to run in 3\nsteps, here we see it running at the 3rd step. Where we would take the latest\nversion, get the HTML version from the MediaWiki API, and pass to Pandoc to get\nMarkdown."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ah,props:{figcaption:l,src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F07\u002Fmediawiki-history-to-git-output.png"},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Making sure during development that the conversion was effectively the same"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ah,props:{figcaption:l,src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F07\u002Fdocs-page-history-github.png"},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"We can see directly on GitHub.com the converted page's Git history"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ah,props:{figcaption:l,src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F07\u002Fdocs-page-markdown.png"},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"We can see directly on GitHub.com the converted Markdown contents."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ah,props:{figcaption:l,src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F07\u002Fdocs-page-view-syntaxhighlight.png"},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The final output should support code blocks with"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ah,props:{figcaption:l,src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F07\u002Fmediawiki-history-to-git-log.png",alt:"MediaWiki history converted into Git Commits"},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The end result is that for each "},{type:b,tag:x,props:{},children:[{type:a,value:el}]},{type:a,value:" can be converted into text\nfiles where each edits are made as Git commits keeping author and date of edit."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ah,props:{figcaption:l,src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F07\u002Fdocs-page-history-onsite.png"},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:"Not implemented"}]},{type:a,value:" Screenshot of an experiment to display the page's Git\nhistory calling GitHub API. There is no trace of this to my recollection, and It\nwas effectively the first time I used Vue.js."}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},dir:"\u002Fblog\u002F2015\u002F07",path:"\u002Fblog\u002F2015\u002F07\u002Fmigrating-webplatform-org-mediawiki-into-git-history-and-into-markdown-files",extension:ay,slug:"migrating-webplatform-org-mediawiki-into-git-history-and-into-markdown-files",createdAt:bD,updatedAt:bD,category:am,prettyfiedTemporalDate:{prettified:"Thursday, July 30, 2015",temporalDate:"2015-07-30"}},{title:"Run a NodeJS process through forever from within a Docker container",locale:aE,created:"2015-05-12T00:00:00.000Z",updated:aO,canonical:"https:\u002F\u002Frenoirboulanger.com\u002Fblog\u002F2015\u002F05\u002Frun-nodejs-process-forever-within-docker-container\u002F",status:ax,revising:$,migrateLinks:$,categories:[am],tags:[aQ,aI,cn,ar,aH,aP],coverImage:{src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F05\u002Fpublican-spec-rangefinder.png",alt:"Screen capture of the RangeFinder API using Publican",text:"Specification Document for RangeFinder API\n"},excerpt:"I‚Äôve recently been through the steps to make a NodeJS web app to run from inside a Docker container. The objective of this project was to simplify the deployment of a web app that had many moving parts by making it a re-deployable service that is self-contained.",preamble:{disable:$,text:l},toc:[{id:ey,depth:U,text:"Run publican inside Docker"},{id:bI,depth:ab,text:bJ},{id:ez,depth:ab,text:eA},{id:bE,depth:ab,text:bF}],body:{type:ap,children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"One of the components that I worked on "},{type:b,tag:aJ,props:{to:"\u002Fblog\u002Ftag\u002Fwebplatform-docs"},children:[{type:a,value:"during my time on the WebPlatform\nproject"}]},{type:a,value:aR},{type:b,tag:h,props:{href:cC,rel:[m,n,o],target:p},children:[{type:a,value:cD}]},{type:a,value:", that I had to manage has many moving parts. The\nend product of that component is basically static HTML documents that ends up on\n"},{type:b,tag:h,props:{href:"https:\u002F\u002Fspecs.webplatform.org\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"specs.webplatform.org"}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Since we need to have many packages installed in very specific version, and\nautomating the installation wouldn't bring any more benefit than being\nself-contained, I thought it would be best to go through the steps of converting\nit into a Docker container."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The following is a procedure I wrote to teach "},{type:b,tag:h,props:{href:"https:\u002F\u002Fwww.w3.org\u002Fstaff\u002Falumni\u002F#robin-berjon",rel:[m,n,o],target:p},children:[{type:a,value:"my colleague"}]},{type:a,value:aR},{type:b,tag:h,props:{href:"https:\u002F\u002Fberjon.com\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"Robin\nBerjon"}]},{type:a,value:", how to run his system called "},{type:b,tag:h,props:{href:cC,rel:[m,n,o],target:p},children:[{type:a,value:cD}]},{type:a,value:" from within a Docker\ncontainer. Publican is basically a GitHub hook listener that generates specs\nwritten to be parsed by "},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fw3c\u002Frespec",rel:[m,n,o],target:p},children:[{type:a,value:"ReSpec"}]},{type:a,value:cE},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Ftabatkins\u002Fbikeshed",rel:[m,n,o],target:p},children:[{type:a,value:"Bikeshed"}]}]},{type:a,value:e},{type:b,tag:Z,props:{id:ey},children:[{type:b,tag:h,props:{href:"#run-publican-inside-docker",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:"Run "},{type:b,tag:x,props:{},children:[{type:a,value:"publican"}]},{type:a,value:" inside Docker"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"What this'll do is basically build a VM that'll run a Docker container. The\ncontainer will write in files outside of it."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"You'll quickly notice that the paths will look the same, its confusing, sorry\nabout that. Fortunately for us, the paths in the procedure are the ones that\nwill be mounted through Docker Volume (the "},{type:b,tag:j,props:{},children:[{type:a,value:aS}]},{type:a,value:" option when you call "},{type:b,tag:j,props:{},children:[{type:a,value:aI}]},{type:a,value:")\nand will, in the end, be the same files."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Once you have a Docker container running on a VM, it'll replicate how a\nproduction VM will run the tasks. Since we know where the container will write\nfiles, we'll have our frontend servers to forward requests to publican, and\nserve files it generated."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Doing all this removes the need to do any rsync. NGINX within the VM that'll run\nDocker will take care of serving static files, and frontend server will expose\nit to the public."}]},{type:a,value:e},{type:b,tag:ac,props:{id:bI},children:[{type:b,tag:h,props:{href:eB,ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:bJ}]},{type:a,value:e},{type:b,tag:ak,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Have "},{type:b,tag:h,props:{href:"https:\u002F\u002Fwww.vagrantup.com\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"Vagrant"}]},{type:a,value:eC},{type:b,tag:h,props:{href:"https:\u002F\u002Fwww.virtualbox.org\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"VirtualBox"}]},{type:a,value:" installed"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Follow what's in "},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Frenoirb\u002Fsalt-basesystem",rel:[m,n,o],target:p},children:[{type:a,value:"renoirb\u002Fsalt-basesystem README.md"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Make sure you follow "},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Frenoirb\u002Fsalt-basesystem#vagrant-sandbox-utilities",rel:[m,n,o],target:p},children:[{type:a,value:"Vagrant Sandbox utilities"}]},{type:a,value:" part"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:eD},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:eE}]},{type:a,value:cF},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aW}]},{type:a,value:" salt-call state.highstate\n "},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aW}]},{type:a,value:" salt-call state.sls vagrantsandbox.docker\n "},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:cG}]},{type:a,value:e}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Reboot the VM by doing "},{type:b,tag:j,props:{},children:[{type:a,value:"vagrant reload"}]}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:" vagrant reload\n"}]}]}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ak,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:"No need"}]},{type:a,value:" to follow what's in "},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fpublican\u002Fblob\u002Ftask-based-docker\u002FDOCKER.md",rel:[m,n,o],target:p},children:[{type:a,value:"webplatform\u002Fpublican DOCKER.md file"}]},{type:a,value:".\nThose are notes to show how to build a container. For this time, we'll "},{type:b,tag:h,props:{href:"https:\u002F\u002Fregistry.hub.docker.com\u002Fu\u002Fwebspecs\u002Fpublican\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"use a\ncontainer I already built and pushed on "},{type:b,tag:E,props:{},children:[{type:a,value:"Docker hub"}]}]},{type:a,value:eF}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Setup what's required to run the container"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:eD},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:eE}]},{type:a,value:e}]}]}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Prepare the folders;"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:l},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aW}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:cH}]},{type:a,value:cF},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:eG}]},{type:a,value:" webapps\n "},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cI}]},{type:a,value:e}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"You should see"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,bK]},children:[{type:b,tag:j,props:{},children:[{type:a,value:" uid=990(webapps) gid=990(webapps) groups=990(webapps),33(www-data),998(docker)\n"}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Prepare the folders"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:l},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:bm}]},{type:a,value:" \u002Fsrv\u002Fwebapps "},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cJ}]},{type:a,value:" publican\u002Fdata "},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:bm}]},{type:a,value:" publican\n"}]}]}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"If all went well so far; you should be able to do "},{type:b,tag:j,props:{},children:[{type:a,value:"docker ps"}]},{type:a,value:" as the\n"},{type:b,tag:j,props:{},children:[{type:a,value:"webapps"}]},{type:a,value:" user. Otherwise reboot and\u002For run "},{type:b,tag:j,props:{},children:[{type:a,value:"salt-call"}]},{type:a,value:" with both\n"},{type:b,tag:j,props:{},children:[{type:a,value:"state.highstate"}]},{type:a,value:l},{type:b,tag:j,props:{},children:[{type:a,value:"state.sls vagrantsandbox.docker"}]},{type:a,value:" states. There should be\nnothing left to do."}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aI}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"ps"}]},{type:a,value:"\n\nCONTAINER ID IMAGE COMMAND CREATED\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:cK}]}]}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Pull the publican Docker image I built (it'll take about 10 minutes)"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:l},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aI}]},{type:a,value:" pull webspecs\u002Fpublican:wip\n"}]}]}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ak,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Copy the other files in this Gist in your local coputer where you cloned the\n"},{type:b,tag:E,props:{},children:[{type:a,value:"salt-basesystem"}]},{type:a,value:" repository. From that folder you can move them inside the\nVagrant VM where you need."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Copy publican config"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:l},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:dG}]},{type:a,value:" \u002Fvagrant\u002Fconfig.json data\u002F\n"}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:"del",props:{},children:[{type:a,value:"Download Bikeshed stuff that i didn't figure out yet what's important to\nkeep, extract it in "},{type:b,tag:j,props:{},children:[{type:a,value:"\u002Fsrv\u002Fwebapps\u002Fpublican\u002Fspec-data\u002F"}]}]},{type:a,value:T}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:eH,props:{className:[eI],variant:eJ},children:[{type:a,value:e},{type:b,tag:E,props:{slot:eK},children:[{type:a,value:"Archive mentioned no longer exists"}]},{type:a,value:"\nThe archive used in the initial procedure no longer exists, it was a series of W3C specification Git repository working copies that Publican was expecting.\n"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"You can open up another terminal session and connect to the Vagrant VM\n"},{type:b,tag:j,props:{},children:[{type:a,value:"vagrant ssh"}]},{type:a,value:" (e.g. if you don't use "},{type:b,tag:j,props:{},children:[{type:a,value:"tmux"}]},{type:a,value:cE},{type:b,tag:j,props:{},children:[{type:a,value:"screen"}]},{type:a,value:ag}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cJ}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:bn}]},{type:a,value:" spec-data\u002Freadonly\u002F\n"},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cJ}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:bn}]},{type:a,value:" data\u002F"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:"gits,logs,publish,queue,temp"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:a,value:e}]}]}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ak,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Run the container"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aI}]},{type:a,value:cL},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:cM}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:cN}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:aS}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:aT},{type:b,tag:c,props:{className:[d,r]},children:[{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:bL}]},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:bM}]},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:ag}]}]},{type:a,value:eL}]},{type:a,value:eM},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:bN},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:aS}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:aT},{type:b,tag:c,props:{className:[d,r]},children:[{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:bL}]},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:bM}]},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:ag}]}]},{type:a,value:eN}]},{type:a,value:eO},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:bN},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:bn}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cO}]},{type:a,value:eP}]}]}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"If you see the following, you're in the Docker container!!"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"webapps@2f33f5c6e183:~$\n"}]}]}]},{type:a,value:e},{type:b,tag:ah,props:{src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F05\u002Fpublican-init.png",alt:"A terminal window with a few commands and a build process status and green lines, no errors",figcaption:l},children:[{type:a,value:"\n  Launching the container\n"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Initiate the empty shell we just created (it'll create stuff in the "},{type:b,tag:j,props:{},children:[{type:a,value:"data\u002F"}]},{type:a,value:"\nfolder "},{type:b,tag:x,props:{},children:[{type:a,value:eQ}]},{type:a,value:" of the container)"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"publican.js init\n"}]}]}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:eR},{type:b,tag:x,props:{},children:[{type:a,value:"Launching the container"}]},{type:a,value:eS}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Once done, exit the container. Notice that by doing this, you lose the state\nof the VM and anything that has been written in the container. But, since we\nuse volumes (notice the "},{type:b,tag:j,props:{},children:[{type:a,value:"-v \u002Fhost\u002Fpath:\u002Fcontainer\u002Fpath"}]},{type:a,value:"), we actually wrote\n"},{type:b,tag:x,props:{},children:[{type:a,value:eQ}]},{type:a,value:" of the container."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"We can "},{type:b,tag:E,props:{},children:[{type:a,value:"exit the container"}]}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:l},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:cG}]},{type:a,value:e}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"At this stage, we had publican and bikeshed to generate files (we may call\nthis a \"cache warmup\" of softs). Now, let's prepare the Vagrant VM to serve\nthe static content. Notice that the next commands are there only for the\npurpose of a local workspace, in production this step will also be managed\nautomatically."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Let's get back as the "},{type:b,tag:E,props:{},children:[{type:a,value:ap}]},{type:a,value:" user, and create a quick web server;"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:cG}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cP}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:"-yqq"}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aK}]},{type:a,value:"\nnginx "},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"mv"}]},{type:a,value:" \u002Fvagrant\u002Fdefault.conf \u002Fetc\u002Fnginx\u002Fsites-available\u002Fdefault\n"},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:eT}]},{type:a,value:" restart nginx\n"}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Let's return back to "},{type:b,tag:E,props:{},children:[{type:a,value:"as the webapps user and launch the runner"}]}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:eG}]},{type:a,value:" webapps "},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:bm}]},{type:a,value:" \u002Fsrv\u002Fwebapps\u002Fpublican\u002F\n"}]}]}]},{type:a,value:e},{type:b,tag:ah,props:{src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F05\u002Fpublican-run-hook.png",alt:"A terminal window with a build process status and green lines, no errors",figcaption:l},children:[{type:a,value:"\nStarting a build process\n"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:eU}]},{type:a,value:"; this will also be managed automatically in\nproduction."}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,"language-shell"]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aI}]},{type:a,value:cL},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:cM}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:cN}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:aS}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:aT},{type:b,tag:c,props:{className:[d,r]},children:[{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:bL}]},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:bM}]},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:ag}]}]},{type:a,value:eL}]},{type:a,value:eM},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:eV},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:aS}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:aT},{type:b,tag:c,props:{className:[d,r]},children:[{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:bL}]},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:bM}]},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:ag}]}]},{type:a,value:eN}]},{type:a,value:eO},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:eV},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:bn}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cO}]},{type:a,value:eP}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:eR},{type:b,tag:x,props:{},children:[{type:a,value:eU}]},{type:a,value:eS}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"get your Vagrant VM IP address"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"ifconfig"}]},{type:a,value:e}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Should start by "},{type:b,tag:j,props:{},children:[{type:a,value:"172..."}]},{type:a,value:cE},{type:b,tag:j,props:{},children:[{type:a,value:"192..."}]},{type:a,value:"; visit a browser to that address"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ac,props:{id:ez},children:[{type:b,tag:h,props:{href:"#gists",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:eA}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Here are the files mentioned in this post"}]},{type:a,value:e},{type:a,value:e},{type:b,tag:aL,props:{id:"configjson"},children:[{type:b,tag:h,props:{href:"#configjson",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:"config.json"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:h,props:{href:cC,rel:[m,n,o],target:p},children:[{type:a,value:cD}]},{type:a,value:" expects this file as "},{type:b,tag:j,props:{},children:[{type:a,value:"data\u002Fconfig.json"}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,"language-json"]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,au]},children:[{type:a,value:"\"bikeshed\""}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:J}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"\u002Fopt\u002Fbikeshed\u002Fbikeshed.py\""}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aC}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,au]},children:[{type:a,value:"\"rsyncPath\""}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:J}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"\u002Fsrv\u002Fwebapps\u002Fpublican\u002F\""}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aC}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,au]},children:[{type:a,value:"\"python\""}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:J}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"python2\""}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aC}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,au]},children:[{type:a,value:"\"logFile\""}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:J}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"logs\u002Fall.log\""}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aC}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,au]},children:[{type:a,value:"\"email\""}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:J}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,au]},children:[{type:a,value:"\"to\""}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:J}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:eW}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aC}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,au]},children:[{type:a,value:"\"from\""}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:J}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:eW}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aC}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,au]},children:[{type:a,value:"\"host\""}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:J}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"localhost\""}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aC}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,au]},children:[{type:a,value:"\"level\""}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:J}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"error\""}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aC}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,au]},children:[{type:a,value:"\"handleExceptions\""}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:J}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,aM]},children:[{type:a,value:z}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aC}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,au]},children:[{type:a,value:"\"purgeAllURL\""}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:J}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"https:\u002F\u002Fapi.fastly.com\u002Fservice\u002Ffooo\u002Fpurge_all\""}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aC}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,au]},children:[{type:a,value:"\"purgeAllKey\""}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:J}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"baar\""}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:aL,props:{id:"defaultconf"},children:[{type:b,tag:h,props:{href:"#defaultconf",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:"default.conf"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"A minimal NGINX web server digging for static content that Publican generates."}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,cQ]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# file: \u002Fetc\u002Fnginx\u002Fsites-enabled\u002Fdefault"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bo}]}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bO}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:eX}]},{type:a,value:" default_server"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:ap}]},{type:a,value:" \u002Fsrv\u002Fwebapps\u002Fpublican\u002Fdata\u002Fpublish"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"index"}]},{type:a,value:" index.html index.htm"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bP}]},{type:a,value:" localhost"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:as},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:eY}]},{type:a,value:eZ}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"try_files"}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:e_}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:e_}]},{type:a,value:"\u002F =404"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:"h5",props:{id:"dockerfile"},children:[{type:b,tag:h,props:{href:"#dockerfile",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:"Dockerfile"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Here is the project's Dockerfile I created. I think it should be smaller, but\nPublican works with the following script."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Each step in a Dockerfile creates a \"commit\", make sure you have as few of them\nas possible, and also make sure that you clean after yourself. Remember that a\nDocker container is re-deployable and smallest the size of the container, the\nbetter!"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Notice a few details;"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"ENV DEBIAN_FRONTEND=noninteractive"}]},{type:a,value:" helps with dialogs"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"USER webapps"}]},{type:a,value:" tells \"where\" the rest of the script will make commands as a\ndifferent user than root. Make sure what's required by root to be done before!"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"COPY ..."}]},{type:a,value:" this is basically how you import content inside the container (i.e.\nmake the container heavier)"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,"language-dockerfile"]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:e$}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Publican Docker runner"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:e$}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# See also:"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"#   * https:\u002F\u002Fgithub.com\u002Fnodesource\u002Fdocker-node\u002Fblob\u002Fmaster\u002Fubuntu\u002Ftrusty\u002Fnode\u002F0.10.36\u002FDockerfile"}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"FROM"}]},{type:a,value:" nodesource\u002Ftrusty:0.10.36"}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"MAINTAINER"}]},{type:a,value:" Renoir Boulanger \u003Crenoir@w3.org\u003E"}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:aX}]},{type:a,value:" DEBIAN_FRONTEND=noninteractive"}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Dependencies: Bikeshed, PhantomJS, Bikshed‚Äôs lxml"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:cR}]},{type:a,value:" apt-get update && apt-get -y upgrade && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    apt-get install -yqq git python2.7 python-dev python-pip libxslt1-dev libxml2-dev zlib1g-dev && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    apt-get install -yqq libfontconfig1 libfreetype6 curl && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    apt-get autoremove -yqq --purge && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    pip install --upgrade lxml"}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Copy everything we have locally into the container"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# REMINDER: Make sure you run `make clone-bikeshed`, we prefer to keep a copy locally outside"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# of the data volume. Otherwise it would make problems saying that bikeshed clone is not in the"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# same filesystem."}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"COPY"}]},{type:a,value:" . \u002Fsrv\u002Fwebapps\u002Fpublican\u002F"}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Make sure we have a \"non root\" user and"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# delete any local workbench data\u002F directory"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:cR}]},{type:a,value:" \u002Fusr\u002Fsbin\u002Fgroupadd --system --gid 990 webapps && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    \u002Fusr\u002Fsbin\u002Fuseradd --system --gid 990 --uid 990 -G sudo --home-dir \u002Fsrv\u002Fwebapps --shell \u002Fbin\u002Fbash webapps && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    sed -i "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"'\u002F^%sudo\u002Fd'"}]},{type:a,value:" \u002Fetc\u002Fsudoers && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    echo "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"'%sudo ALL=NOPASSWD: ALL'"}]},{type:a,value:" \u003E\u003E \u002Fetc\u002Fsudoers && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    mv \u002Fsrv\u002Fwebapps\u002Fpublican\u002Fbikeshed \u002Fopt && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    rm -rf data && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    mkdir -p data\u002Ftemp && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    rm -rf Dockerfile Makefile .git .gitignore DOCKER.md && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    chown -R webapps:webapps \u002Fsrv\u002Fwebapps\u002Fpublican && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    chown -R webapps:webapps \u002Fopt\u002Fbikeshed"}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Switch from root to webapps system user"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# It **HAS to be** the SAME uid\u002Fgid as the owner on the host from which we‚Äôll use as volume"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"USER"}]},{type:a,value:" webapps"}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Where the session will start from"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"WORKDIR"}]},{type:a,value:" \u002Fsrv\u002Fwebapps\u002Fpublican"}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Environment variables"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:aX}]},{type:a,value:" PATH \u002Fsrv\u002Fwebapps\u002Fpublican\u002Fnode_modules\u002F.bin:\u002Fsrv\u002Fwebapps\u002Fpublican\u002Fbin:\u002Fsrv\u002Fwebapps\u002Fpublican\u002F.local\u002Fbin:"},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:"$PATH"}]}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:aX}]},{type:a,value:" HOME \u002Fsrv\u002Fwebapps\u002Fpublican"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:aX}]},{type:a,value:" TMPDIR \u002Fsrv\u002Fwebapps\u002Fpublican\u002Fdata\u002Ftemp"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:aX}]},{type:a,value:" NODE_ENV production"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:aX}]},{type:a,value:" GIT_DISCOVERY_ACROSS_FILESYSTEM true"}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Run what `make deps` would do"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:cR}]},{type:a,value:" pip install --upgrade --user --editable \u002Fopt\u002Fbikeshed && "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:y}]},{type:a,value:"\n    mkdir -p node_modules && npm install"}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Declare which port we expect to expose"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"EXPOSE"}]},{type:a,value:" 7002"}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Allow cli entry for debug, but make sure docker-compose.yml uses \"command: bin\u002Frun.sh\""}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,an]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"ENTRYPOINT"}]},{type:a,value:" ["},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"\u002Fbin\u002Fbash\""}]},{type:a,value:M}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Note leftover: Ideally, it should exclusively run"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"#ENTRYPOINT [\"\u002Fbin\u002Fbash\", \"\u002Fsrv\u002Fwebapps\u002Fpublican\u002Fbin\u002Frun.sh\"]"}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Note leftover: What it ends up doing"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"#CMD [\"node_modules\u002Fforever\u002Fbin\u002Fforever\", \"--fifo\", \"logs\", \"0\"]"}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:aL,props:{id:"forever-start-script"},children:[{type:b,tag:h,props:{href:"#forever-start-script",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:"Forever start script"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"If you notice in the Docker run command, I call a file "},{type:b,tag:j,props:{},children:[{type:a,value:"bin\u002Frun.sh"}]},{type:a,value:", here it is."}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aI}]},{type:a,value:cL},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:cM}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:bN},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:cN}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:bN},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:bn}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cO}]},{type:a,value:":7002 "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n       webspecs\u002Fpublican:latest "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n       bin\u002Frun.sh\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Publican runs its process using "},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fforeverjs\u002Fforever",rel:[m,n,o],target:p},children:[{type:a,value:"Forever"}]},{type:a,value:". The objective of forever is to\nkeep a process to run at all times."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"While this isn't ideal for NodeJS services, in the present use-case of a Docker\ncontainer who has the only purpose to run a process; Forever apt for the job!"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,"shebang","important"]},children:[{type:a,value:"#!\u002Fbin\u002Fbash"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:"export"}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:"RUNDIR"}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"\u002Fsrv\u002Fwebapps\u002Fpublican\""}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:bm}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:fa}]},{type:a,value:"\nnode_modules\u002Fforever\u002Fbin\u002Fforever start "},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:fa}]},{type:a,value:"\u002Fbin\u002Fserver.js\nnode_modules\u002Fforever\u002Fbin\u002Fforever "},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:"--fifo"}]},{type:a,value:" logs "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cS}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"That‚Äôs it, it‚Äôs all I had."}]},{type:a,value:e},{type:b,tag:ac,props:{id:bE},children:[{type:b,tag:h,props:{href:ex,ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:bF}]},{type:a,value:e},{type:a,value:e},{type:b,tag:s,props:{style:cz,className:[cA,cB,fb,fc,fd]},children:[{type:a,value:e},{type:b,tag:ah,props:{className:[bQ],src:fe,alt:"A W3C Specification preview where we can see on the left the specification, and on the right the source highlighting changes in the source",figcaption:l},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"W3C Publican prototype build process helping with specification change tracking during review process"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ah,props:{className:[bQ],src:ff,figcaption:l},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:fg}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:s,props:{style:cz,className:[cA,cB,fb,fc,fd]},children:[{type:a,value:e},{type:b,tag:ah,props:{className:[bQ],src:fe,alt:cT,figcaption:l},children:[{type:a,value:"\n...\n"}]},{type:a,value:e},{type:b,tag:ah,props:{className:[bQ],src:ff,figcaption:l},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:fg}]},{type:a,value:e}]},{type:a,value:e}]}]},dir:cU,path:"\u002Fblog\u002F2015\u002F05\u002Frun-nodejs-process-forever-within-docker-container",extension:ay,slug:"run-nodejs-process-forever-within-docker-container",createdAt:bR,updatedAt:"2024-10-24T19:43:51.727Z",category:am,prettyfiedTemporalDate:{prettified:"Tuesday, May 12, 2015",temporalDate:"2015-05-12"}},{title:"Make Discourse ‚Äúlong polling‚Äù work behind Fastly or Varnish",locale:aE,created:"2015-05-03T00:00:00.000Z",updated:aO,canonical:"https:\u002F\u002Frenoirboulanger.com\u002Fblog\u002F2015\u002F05\u002Fmake-discourse-long-polling-work-behind-fastly\u002F",status:ax,revising:$,caption:R,caracteresBizzares:R,gallery:R,migrateCode:$,migrateImages:$,migrateLinks:$,categories:[am],tags:[aQ,ar,aP,bp],keywords:[cj,fh,aU,"Long Polling behind Varnish",fi],excerpt:"In the Discourse forums, if you‚Äôve seen something saying that you have to provide a different origin to make long polling work, maybe you didn‚Äôt understand what you have to do. Here are the details of why and how to do it correctly.",coverImage:{src:cl,text:cm},preamble:{text:fj},toc:[{id:fk,depth:U,text:fl}],body:{type:ap,children:[{type:b,tag:f,props:{},children:[{type:a,value:"While working on deploying Discourse, "},{type:b,tag:h,props:{href:"https:\u002F\u002Fmeta.discourse.org\u002Ft\u002Ffull-site-cdn-acceleration-for-discourse\u002F21467\u002F4",rel:[m,n,o],target:p},children:[{type:a,value:"I've came across a statement that took\ntime for me to understand"}]},{type:a,value:". Discourse has a subsystem that's similar to\nWebSocket and Server Sent events which takes care to automatically update the\npage asynchronously. Note that this post "},{type:b,tag:h,props:{href:"https:\u002F\u002Fmeta.discourse.org\u002Ft\u002Ffull-site-cdn-acceleration-for-discourse\u002F21467",rel:[m,n,o],target:p},children:[{type:a,value:"is canonical version of my answer"}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The confusing part was;"}]},{type:a,value:e},{type:b,tag:bj,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:h,props:{href:fm,rel:[m,n,o],target:p},children:[{type:a,value:fn}]},{type:a,value:" To server \"long polling\" requests from a different domain, set the\nSite Setting long polling base url to the origin server. For example, if your\nCDN is pulling from \""},{type:b,tag:j,props:{},children:[{type:a,value:"http:\u002F\u002Fexample.org"}]},{type:a,value:"\" be sure to plug in\n"},{type:b,tag:j,props:{},children:[{type:a,value:fo}]},{type:a,value:" into the site setting. If you don't your site will be\nbroken."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"This post is about clarifying why and how to work around this particular\nproblem."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The confusing part is that if \""},{type:b,tag:j,props:{},children:[{type:a,value:fo}]},{type:a,value:"\". If you are behind Fastly,\nyou have to use a CNAME entry and then you have to have a sub domain name and\nnot the top level."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:"Background:"}]},{type:a,value:" In DNS, a top level domain name (i.e. \"example.org\") can "},{type:b,tag:x,props:{},children:[{type:a,value:"only"}]},{type:a,value:"\nhave "},{type:b,tag:j,props:{},children:[{type:a,value:bS}]},{type:a,value:" records. Since Fastly requires we use a "},{type:b,tag:j,props:{},children:[{type:a,value:bT}]},{type:a,value:" entry, we have no\nchoice but to use a sub domain name."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Let's say that we will then use \""},{type:b,tag:j,props:{},children:[{type:a,value:"http:\u002F\u002Fdiscourse.example.org\u002F"}]},{type:a,value:"\" to serve our\nDiscourse forum so we can use Fastly."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Now there's this thing called \"long polling\" which is basically an "},{type:b,tag:j,props:{},children:[{type:a,value:"OPTION"}]},{type:a,value:" HTTP\nrequest with a long time before returning anything. If we use the Fastly or\nVarnish address, as Discourse would by default, Varnish will time out and \"long\npolling\" won't work."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:"More background:"}]},{type:a,value:" Varnish has this option to bypass in known contexts through\n"},{type:b,tag:j,props:{},children:[{type:a,value:"vcl_pipe"}]},{type:a,value:" which is roughly a raw TCP socket. But Fastly doesn't offer it\n"},{type:b,tag:h,props:{href:"https:\u002F\u002Fcommunity.fastly.com\u002Ft\u002Fvcl-pipe-heads-up\u002F163",rel:[m,n,o],target:p},children:[{type:a,value:"because of the "},{type:b,tag:x,props:{},children:[{type:a,value:"size"}]},{type:a,value:" of their setup"}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:Z,props:{id:fk},children:[{type:b,tag:h,props:{href:"#proposed-setup",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:fl}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Let's enable long polling and expose our site under Fastly. We'll need two\nnames, one pointing to Fastly's and the other to the IP addresses we give within\nthe service dashboard."}]},{type:a,value:e},{type:b,tag:ak,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:"discourse.example.org"}]},{type:a,value:" that's our desired Discourse site domain name"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:fp}]},{type:a,value:" (pick any name) that we'll configure in\nDiscourse to access directly to our public facing frontend web server"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"In my case, I generally have many web apps running that are only accessible from\nmy internal network. I refer to them as \"upstream\"; the same term NGINX uses in\ntheir config. Since this number of web apps you would host on a site can\nfluctuate, you might still want the number public IP address to remain stable.\nThat's why I setup a NGINX server in front that proxies to internal web app\nserver. I refer to them as \"frontends\"."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Let's say you have two public facing frontends running NGINX."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Those would be the ones you setup in Fastly like this."}]},{type:a,value:e},{type:b,tag:ah,props:{style:aY,src:fq,figcaption:l},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:fr}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Here we see two "},{type:b,tag:x,props:{},children:[{type:a,value:"Backends"}]},{type:a,value:" in Fastly pannel at "},{type:b,tag:j,props:{},children:[{type:a,value:fs}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Notice that in this example i'm using "},{type:b,tag:j,props:{},children:[{type:a,value:bU}]},{type:a,value:" port because my backends are\nconfigured to communicate between Fastly and my frontends through TLS. But you\ndon't need to."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Quoting again @sam;"}]},{type:a,value:e},{type:b,tag:bj,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:h,props:{href:fm,rel:[m,n,o],target:p},children:[{type:a,value:fn}]},{type:a,value:" To server \"long polling\" requests from a different domain, set the\nSite Setting long polling base url to the origin server."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Really means here is that we would have to put one of those IP addresses in\nDiscourse settings."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"What I'd recommend is to create a list of "},{type:b,tag:j,props:{},children:[{type:a,value:bS}]},{type:a,value:" entries for all your frontends."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"In the end we need three things:"}]},{type:a,value:e},{type:b,tag:ak,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"What's the public name that Fastly will serve"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Which IPs are the frontends"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Which hostname we want to use for long polling and we'll add it to our\nVirtualHost"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The zone file would look like this;"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,ft]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"# The public facing URL\ndiscourse.example.org.  "},{type:b,tag:c,props:{className:[d,bq,w]},children:[{type:a,value:br}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,bs,w]},children:[{type:a,value:bT}]},{type:a,value:" global.prod.fastly.net.\n\n# The list of IP addresses you‚Äôd give to Fastly as origins\u002Fbackends\nfrontends.example.org.  "},{type:b,tag:c,props:{className:[d,bq,w]},children:[{type:a,value:br}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,bs,w]},children:[{type:a,value:bS}]},{type:a,value:" 8.8.8.113\nfrontends.example.org.  "},{type:b,tag:c,props:{className:[d,bq,w]},children:[{type:a,value:br}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,bs,w]},children:[{type:a,value:bS}]},{type:a,value:" 8.8.8.115\n\n# The long polling URL entry\ndiscoursepolling.example.org.  "},{type:b,tag:c,props:{className:[d,bq,w]},children:[{type:a,value:br}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,bs,w]},children:[{type:a,value:bT}]},{type:a,value:" frontends.example.org.\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"That way you can setup the \"long polling base url\" correctly without setting a\nsingle point of failure."}]},{type:a,value:e},{type:b,tag:ah,props:{style:aY,src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F05\u002Fdiscourse-polling-ui.png",figcaption:"In Discourse admin, adjust long polling base url setting"},children:[{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Then, we can go in Discourse admin zone and adjust the \"long polling base url\"\nto our other domain name."}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,cQ]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# \u002Fetc\u002Fnginx\u002Fsites-enabled\u002F10-discourse"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Let‚Äôs redirect to SSL, in case somebody tries to access the direct IP with"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# host header."}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bo}]}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bO}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:eX}]}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bP}]},{type:a,value:fu}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bV}]},{type:a,value:"     common_params"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"return"}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"301"}]},{type:a,value:" https:\u002F\u002F"},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:"$server_name"}]},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:"$request_uri"}]}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bo}]}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bO}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bU}]},{type:a,value:fv}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bP}]},{type:a,value:fu}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Rest of NGINX server block"}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Also, I would make a condition if we are in discoursepolling but not"}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# under using anything specific to polling."}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# #TODO; find paths specific to polling"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"To see if it works; look at your web browser developer tool \"Network inspector\"\nfor "},{type:b,tag:j,props:{},children:[{type:a,value:"\u002Fpoll"}]},{type:a,value:" calls on "},{type:b,tag:j,props:{},children:[{type:a,value:fp}]},{type:a,value:", and see if you have\n"},{type:b,tag:j,props:{},children:[{type:a,value:"200 OK"}]},{type:a,value:" status code."}]},{type:a,value:e},{type:b,tag:ah,props:{style:aY,src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F05\u002Fdiscourse-polling.png",figcaption:"Use your web browser developer tools and inspect network traffic to see if requests made to discoursepolling worked"},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Note that this screenshot is showing "},{type:b,tag:j,props:{},children:[{type:a,value:cs}]},{type:a,value:" but that's beside the\npoint i'm trying to illustrate."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Hope this helped."}]}]},dir:cU,path:"\u002Fblog\u002F2015\u002F05\u002Fmake-discourse-long-polling-work-behind-fastly",extension:ay,slug:"make-discourse-long-polling-work-behind-fastly",createdAt:bR,updatedAt:bR,category:am,prettyfiedTemporalDate:{prettified:"Sunday, May 3, 2015",temporalDate:"2015-05-03"}},{title:"Add OpenStack instance meta-data info in your salt grains",locale:aE,created:"2015-05-22T00:00:00.000Z",updated:"2023-11-17T00:00:00.000Z",canonical:"https:\u002F\u002Frenoirboulanger.com\u002Fblog\u002F2015\u002F05\u002Fadd-openstack-instance-meta-data-info-salt-grains\u002F",status:ax,revising:R,migrateLinks:$,migrateImages:R,gallery:R,caption:R,categories:[fw],tags:[aQ,ar,cV,bp,cn],keywords:["Ansible","Infrastructure as Code"],preamble:{text:"It is possible the code shown here no longer works.\nThis was written at the time before VMWare aquired SaltStack and maybe\ncode shown uses parts of Salt Stack that no longer exists.\n"},coverImage:{src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F05\u002Fwebplatform-openstack-cluster-2014-10-06.png",alt:"A terminal window showing Open Stack nova client output",text:"Open Stack NOVA client is leveraging an internal HTTP API to display data we can\nconsume from the CLI.\nThe present article shows how to add data from OpenStack into Salt Stack.\n"},excerpt:"Ever wanted to target salt states based on data only the underlying OpenStack cluster knows. Here‚Äôs how I did it.",toc:[{id:fx,depth:U,text:fy},{id:fz,depth:U,text:fA},{id:fB,depth:U,text:fC},{id:aK,depth:U,text:fD}],body:{type:ap,children:[{type:b,tag:f,props:{},children:[{type:a,value:"During a work session on my salt-states for WebPlatform.org I wanted to shape be\nable to query the OpenStack cluster meta-data so that I can adjust more\nefficiently my salt configuration."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"What are grains? Grains are structured data that describes what a minion has\nsuch as which version of GNU\u002FLinux its running, what are the network adapters,\netc."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The following is a Python script that adds data in Salt Stack' internal database\ncalled grains."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"I have to confess that I didn't write the script but adapted it to work within\nan OpenStack cluster. More precisely on DreamHost's DreamCompute cluster. The\noriginal script came from "},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fsaltstack\u002Fsalt-contrib",rel:[m,n,o],target:p},children:[{type:a,value:"saltstack\u002Fsalt-contrib"}]},{type:a,value:" and the original file was\n"},{type:b,tag:h,props:{href:fE,rel:[m,n,o],target:p},children:[{type:a,value:"ec2_info.py"}]},{type:a,value:" to read data from EC2."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The "},{type:b,tag:h,props:{href:fE,rel:[m,n,o],target:p},children:[{type:a,value:"original script"}]},{type:a,value:" wasn't getting any data in the cluster. Most likely due\nto API changes and that EC2 API exposes dynamic meta-data that the\nDreamCompute\u002FOpenStack cluster don't."}]},{type:a,value:e},{type:b,tag:eH,props:{variant:eJ,className:[eI]},children:[{type:a,value:e},{type:b,tag:E,props:{slot:eK},children:[{type:a,value:"Script source"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The article‚Äôs source script is available on GitHub as a Python script we can\ninsert into SaltStack as a grain"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fsalt-states\u002Fblob\u002Fmaster\u002F_grains\u002Fdreamcompute.py",rel:[m,n,o],target:p},children:[{type:a,value:"github.com\u002Fwebplatform\u002Fsalt-states"}]}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"In the end, I edited the file to make it work on DreamCompute and also truncated\nsome data that the grains subsystem already has."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"My original objective was to get a list of "},{type:b,tag:j,props:{},children:[{type:a,value:fF}]},{type:a,value:" the VM was\nassigned. Unfortunately the API doesn't give that information yet. Hopefully\nI'll find a way to get that information some day."}]},{type:a,value:e},{type:b,tag:Z,props:{id:fx},children:[{type:b,tag:h,props:{href:"#get-openstack-instance-detail-using-salt",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:fy}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Locally"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"salt-call grains.get dreamcompute:uuid\n"}]}]}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,bW]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:aV}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n    10a4f390"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:fG},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:fH},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:cW},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:fI}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Or for another machine"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"salt app1 grains.get dreamcompute:uuid\n"}]}]}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,bW]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:fJ}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n    510f5f24"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:"217b"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:"4fd2"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:cW},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:"f00000000000\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"What size did we create a particular VM?"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"salt app1 grains.get dreamcompute:instance_type\n"}]}]}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,bW]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:fJ}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n    lightspeed\n"}]}]}]},{type:a,value:e},{type:b,tag:Z,props:{id:fz},children:[{type:b,tag:h,props:{href:"#what-data-you-can-get",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:fA}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Here is a sample of the grain data that will be added to every salt minion you\nmanage."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"You might notice that some data will be repeated such as the 'hostname', but the\nrest can be very useful if you want to use the data within your configuration\nmanag"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,bW]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"dreamcompute"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:fK}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n        iad"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bX}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"block_device_mapping"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"ami"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:fL},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"ebs0"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n            \u002Fdev\u002Fvdb\n        "},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"ebs1"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:fL},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:ap}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n            \u002Fdev\u002Fvda\n    "},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"hostname"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n        salt.novalocal\n    "},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"instance_action"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n        none\n    "},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"instance_id"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n        i"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"00000000"}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"instance_type"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n        lightspeed\n    "},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"launch_index"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cS}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"local_ipv4"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n        10.10.10.11\n    "},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:fM}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n        salt\n    "},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"network_config"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"content_path"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n            \u002Fcontent\u002F0000\n        "},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:fM}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n            network_config\n    "},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"placement"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:fK}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n            iad"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bX}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"public_ipv4"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n        203.0.113.11\n    "},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"public_keys"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aq}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"someuser"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n            ssh"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:"rsa "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:cT}]},{type:a,value:"an rsa public key"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:cT}]},{type:a,value:" someuser"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:"comment@example.org\n    "},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"ramdisk_id"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:fN},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"reservation_id"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n        r"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"33333333"}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:fF}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:fN},{type:b,tag:c,props:{className:[d,X,Y]},children:[{type:a,value:"uuid"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:J}]},{type:a,value:"\n        10a4f390"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:fG},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:fH},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:cW},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aa}]},{type:a,value:fI}]}]}]},{type:a,value:e},{type:b,tag:Z,props:{id:fB},children:[{type:b,tag:h,props:{href:"#what-does-the-script-do",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:fC}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The script basically scrapes OpenStack meta-data service and serializes into\nsaltstack grains system the data it gets."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:h,props:{href:fO,rel:[m,n,o],target:p},children:[{type:a,value:"OpenStack's meta-data service"}]},{type:a,value:" is similar to what you'd get from AWS, but\ndoesn't expose exactly the same data. This is why I had to adapt the original\nscript."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"To get data from an instance you simply (really!) need to make an HTTP call to\nan "},{type:b,tag:h,props:{href:fO,rel:[m,n,o],target:p},children:[{type:a,value:"internal IP address that OpenStack nova"}]},{type:a,value:" answers. (that‚Äôs what the IPv4\naddress starting by "},{type:b,tag:j,props:{},children:[{type:a,value:"169."}]},{type:a,value:" is)"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"For example, from an AWS\u002FOpenStack VM, you can know the instance hostname by\ndoing"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cX}]},{type:a,value:" http:\u002F\u002F169.254.169.254\u002Flatest\u002Fmeta-data\u002Fhostname\n\nsalt.novalocal\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"To know what the script calls, "},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fsalt-states\u002Fcommit\u002F821ca803#diff-6eea2056af3e939361a559b84665c1d97fc9e062f7b7f79910567fc688881056R33",rel:[m,n,o],target:p},children:[{type:a,value:"you can add a line at "},{type:b,tag:j,props:{},children:[{type:a,value:"_call_aws(url)"}]},{type:a,value:"\nmethod"}]},{type:a,value:eh},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fsalt-states\u002Fcommit\u002F821ca803#diff-6eea2056af3e939361a559b84665c1d97fc9e062f7b7f79910567fc688881056R32-R34",rel:[m,n,o],target:p},children:[{type:a,value:"lines 32-34"}]},{type:a,value:"), like so;"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,"language-diff"]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"diff --git a\u002F_grains\u002Fdreamcompute.py b\u002F_grains\u002Fdreamcompute.py\nindex 682235d..c3af659 100644\n"},{type:b,tag:c,props:{className:[d,fP]},children:[{type:a,value:"--- a\u002F_grains\u002Fdreamcompute.py"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,fP]},children:[{type:a,value:"+++ b\u002F_grains\u002Fdreamcompute.py"}]},{type:a,value:"\n@@ -25,6 +25,7 @@ def _call_aws(url):\n\n"},{type:b,tag:c,props:{className:[d,aZ]},children:[{type:b,tag:c,props:{className:[d,bu,aZ]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,bv]},children:[{type:a,value:"    \"\"\"\n"}]},{type:b,tag:c,props:{className:[d,bu,aZ]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,bv]},children:[{type:a,value:"    conn = httplib.HTTPConnection(\"169.254.169.254\", 80, timeout=1)\n"}]}]},{type:b,tag:c,props:{className:[d,"inserted-sign",fQ]},children:[{type:b,tag:c,props:{className:[d,bu,fQ]},children:[{type:a,value:"+"}]},{type:b,tag:c,props:{className:[d,bv]},children:[{type:a,value:"    LOG.info('API call to ' + url )\n"}]}]},{type:b,tag:c,props:{className:[d,aZ]},children:[{type:b,tag:c,props:{className:[d,bu,aZ]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,bv]},children:[{type:a,value:"    conn.request('GET', url)\n"}]},{type:b,tag:c,props:{className:[d,bu,aZ]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,bv]},children:[{type:a,value:"    return conn.getresponse()\n"}]}]}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"When you "},{type:b,tag:j,props:{},children:[{type:a,value:"saltutil.sync_all"}]},{type:a,value:" (i.e. refresh grains and other data), the log will\ntell you which endpoints it queried."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"In my case they were:"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,"language-shellsession"]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,"output"]},children:[{type:a,value:"[INFO    ] API call to \u002Fopenstack\u002F2012-08-10\u002Fmeta_data.json\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002F\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fblock-device-mapping\u002F\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fblock-device-mapping\u002Fami\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fblock-device-mapping\u002Febs0\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fblock-device-mapping\u002Febs1\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fblock-device-mapping\u002Froot\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fhostname\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Finstance-action\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Finstance-id\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Finstance-type\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Flocal-ipv4\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fplacement\u002F\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fplacement\u002Favailability-zone\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fpublic-ipv4\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Framdisk-id\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Freservation-id\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fsecurity-groups\n[INFO    ] API call to \u002Fopenstack\u002F2012-08-10\u002Fmeta_data.json\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002F\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fblock-device-mapping\u002F\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fblock-device-mapping\u002Fami\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fblock-device-mapping\u002Febs0\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fblock-device-mapping\u002Febs1\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fblock-device-mapping\u002Froot\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fhostname\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Finstance-action\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Finstance-id\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Finstance-type\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Flocal-ipv4\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fplacement\u002F\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fplacement\u002Favailability-zone\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fpublic-ipv4\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Framdisk-id\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Freservation-id\n[INFO    ] API call to \u002Flatest\u002Fmeta-data\u002Fsecurity-groups\n"}]}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Its quite heavy."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Hopefully the script respects HTTP headers and don't bypass "},{type:b,tag:j,props:{},children:[{type:a,value:"304 Not Modified"}]},{type:a,value:"\nresponses. Otherwise it'll add load to nova. Maybe I should check that\n(note-to-self)."}]},{type:a,value:e},{type:b,tag:Z,props:{id:aK},children:[{type:b,tag:h,props:{href:"#install",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:fD}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"You can add this feature by adding a file in your salt states repository in the\n"},{type:b,tag:j,props:{},children:[{type:a,value:"_grains\u002F"}]},{type:a,value:" folder. The file can have any name ending by "},{type:b,tag:j,props:{},children:[{type:a,value:".py"}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"You can grab the grain python code "},{type:b,tag:h,props:{href:"https:\u002F\u002Fgist.github.com\u002FWebPlatformDocs\u002F6b26b67321fe15870aa0",rel:[m,n,o],target:p,title:"Gist where you can add openstack meta-data in your grains"},children:[{type:a,value:"in this gist"}]},{type:a,value:T}]},{type:a,value:e},{type:a,value:e},{type:a,value:e}]},dir:cU,path:"\u002Fblog\u002F2015\u002F05\u002Fadd-openstack-instance-meta-data-info-salt-grains",extension:ay,slug:"add-openstack-instance-meta-data-info-salt-grains",createdAt:bw,updatedAt:bR,category:fw,prettyfiedTemporalDate:{prettified:"Friday, May 22, 2015",temporalDate:"2015-05-22"}},{title:"Setting up Discourse with Fastly as a CDN provider and TLS",locale:aE,created:"2015-04-29T00:00:00.000Z",updated:aO,canonical:"https:\u002F\u002Frenoirboulanger.com\u002Fblog\u002F2015\u002F04\u002Fsetting-discourse-fastly-cdn-provider-ssl\u002F",status:ax,revising:$,caption:R,caracteresBizzares:R,gallery:R,migrateCode:$,migrateImages:$,migrateLinks:R,categories:[am],tags:[ar,bp,aP,aQ,"caching","varnish"],keywords:[cj,fh,aU,"TLS","NGINX",fi],preamble:{text:fj},coverImage:{src:cl,text:cm},excerpt:"Here‚Äôs how I setup a Discourse web application so that I can scale it by adding more Docker instances while keeping a low number of exposed web servers",description:"Allow horizontal scaling by separating internal app servers from exposed frontend web servers",title_alternate:fR,toc:[{id:fS,depth:U,text:fT},{id:bI,depth:U,text:bJ}],body:{type:ap,children:[{type:b,tag:f,props:{},children:[{type:a,value:"The following is a copy of what I published in a question on\n"},{type:b,tag:h,props:{href:"https:\u002F\u002Fmeta.discourse.org\u002Ft\u002Fenable-a-cdn-for-your-discourse\u002F14857\u002F26?u=renoirb",rel:[m,n,o],target:p},children:[{type:b,tag:x,props:{},children:[{type:a,value:"meta.discourse.org"}]},{type:a,value:" about \""},{type:b,tag:E,props:{},children:[{type:a,value:fR}]},{type:a,value:aT}]},{type:a,value:" while\nworking on "},{type:b,tag:x,props:{},children:[{type:a,value:"discuss.webplatform.org"}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:Z,props:{id:fS},children:[{type:b,tag:h,props:{href:"#setup-detail",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:fT}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Our setup uses "},{type:b,tag:h,props:{href:"https:\u002F\u002Fwww.fastly.com\u002F",rel:[m,n,o],target:p},children:[{type:a,value:aU}]},{type:a,value:", and leverage "},{type:b,tag:h,props:{href:fU,rel:[m,n,o],target:p},children:[{type:a,value:"their SSL feature"}]},{type:a,value:". Note that in\norder for you to use SSL too, you'll have to contact them to have it onto your\naccount."}]},{type:a,value:e},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:"SEE ALSO"}]},{type:a,value:" this "},{type:b,tag:aJ,props:{to:fV},children:[{type:a,value:"post about "},{type:b,tag:x,props:{},children:[{type:a,value:fW}]}]},{type:a,value:". This step is "},{type:b,tag:E,props:{},children:[{type:a,value:"required"}]},{type:a,value:" and is a logical next step to this\nprocedure."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"In summary;"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:fX},{type:b,tag:x,props:{},children:[{type:a,value:"users"}]},{type:a,value:eC},{type:b,tag:x,props:{},children:[{type:a,value:aU}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:fX},{type:b,tag:x,props:{},children:[{type:a,value:aU}]},{type:a,value:" and \""},{type:b,tag:x,props:{},children:[{type:a,value:cY}]},{type:a,value:"\" servers. (That's the IP we put into\nFastly hosts configuration, and are also refered to as \"origins\" or \"backends\"\nin CDN-speak)"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Docker Discourse instance (\""},{type:b,tag:x,props:{},children:[{type:a,value:bY}]},{type:a,value:"\") which listens only on private network\nand port (e.g. "},{type:b,tag:x,props:{},children:[{type:a,value:"10.10.10.3:8000"}]},{type:a,value:ag}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"More than two publicly exposed web servers (\""},{type:b,tag:x,props:{},children:[{type:a,value:cY}]},{type:a,value:"\"), with SSL, that we\nuse as \""},{type:b,tag:x,props:{},children:[{type:a,value:"backends"}]},{type:a,value:"\" in "},{type:b,tag:x,props:{},children:[{type:a,value:aU}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:x,props:{},children:[{type:a,value:cY}]},{type:a,value:" server running NGINX with an "},{type:b,tag:h,props:{href:"https:\u002F\u002Fnginx.org\u002Fen\u002Fdocs\u002Fhttp\u002Fngx_http_upstream_module.html",rel:[m,n,o],target:p},children:[{type:b,tag:x,props:{},children:[{type:a,value:bY}]},{type:a,value:" block"}]},{type:a,value:" proxying\ninternal "},{type:b,tag:x,props:{},children:[{type:a,value:bY}]},{type:a,value:" web servers that the Discourse Docker provides."}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"We use NGINX's "},{type:b,tag:j,props:{},children:[{type:a,value:fY}]},{type:a,value:" HTTP header in the frontend to make sure we\nminimize connections"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Using this method, if we need to scale, we only need add more internal\n"},{type:b,tag:x,props:{},children:[{type:a,value:"Discourse Docker instances"}]},{type:a,value:", we can add more NGINX upstream entries."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Note that I recommend to use direct private IP addresses instead of internal\nnames. It removes complexity and the need to rewrite "},{type:b,tag:j,props:{},children:[{type:a,value:"Hosts:"}]},{type:a,value:" HTTP headers."}]},{type:a,value:e},{type:b,tag:Z,props:{id:bI},children:[{type:b,tag:h,props:{href:eB,ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:bJ}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Everything is the same as basic Fastly configuration, refer to "},{type:b,tag:h,props:{href:"https:\u002F\u002Fdocs.fastly.com\u002Fguides\u002Fgetting-started\u002Fsign-up-and-create-your-first-service",rel:[m,n,o],target:p},children:[{type:a,value:"setup your\ndomain"}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Here are the differences;"}]},{type:a,value:e},{type:b,tag:ak,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Setup your domain name with the CNAME Fastly will provide you ("},{type:b,tag:h,props:{href:fU,rel:[m,n,o],target:p},children:[{type:a,value:"you will have\nto contact them for your account though"}]},{type:a,value:"), ours is like that ;"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,ft]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"discuss.webplatform.org. "},{type:b,tag:c,props:{className:[d,bq,w]},children:[{type:a,value:br}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,bs,w]},children:[{type:a,value:bT}]},{type:a,value:" webplatform.map.fastly.net.\n"}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"In Fastly pannel at "},{type:b,tag:j,props:{},children:[{type:a,value:fs}]},{type:a,value:", we tell which publicly available\n"},{type:b,tag:x,props:{},children:[{type:a,value:fZ}]},{type:a,value:" IPs"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Notice we use port "},{type:b,tag:j,props:{},children:[{type:a,value:bU}]},{type:a,value:aR},{type:b,tag:h,props:{href:"https:\u002F\u002Fdocs.fastly.com\u002Fguides\u002Fssl\u002Fcan-i-use-ssl-to-communicate-to-my-backend-servers",rel:[m,n,o],target:p},children:[{type:a,value:"so SSL is between "},{type:b,tag:x,props:{},children:[{type:a,value:aU}]},{type:a,value:" and our "},{type:b,tag:x,props:{},children:[{type:a,value:fZ}]}]},{type:a,value:".\nAlso, you "},{type:b,tag:E,props:{},children:[{type:a,value:"can"}]},{type:a,value:" setup "},{type:b,tag:x,props:{},children:[{type:a,value:"Shielding"}]},{type:a,value:" (which is how you activate the CDN behavior\nwithin Fastly) by enabling it on only one. I typically set it on the one I call\n\"first\"."}]},{type:a,value:e},{type:b,tag:ah,props:{style:aY,src:fq,figcaption:fr},children:[{type:a,value:e}]},{type:a,value:e},{type:b,tag:ak,props:{start:ab},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"In Fastly pannel "},{type:b,tag:j,props:{},children:[{type:a,value:"Configure -\u003E Settings -\u003E Request Settings"}]},{type:a,value:"; we make sure we\nforward "},{type:b,tag:j,props:{},children:[{type:a,value:"X-Forwarded-For"}]},{type:a,value:" header. You "},{type:b,tag:E,props:{},children:[{type:a,value:"DONT"}]},{type:a,value:" need this; you can remove it."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ah,props:{style:aY,src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F04\u002Fdiscuss-fastly-XFF.png",figcaption:"Fastly service configuration, at Settings tab"},children:[{type:a,value:e}]},{type:a,value:e},{type:b,tag:ak,props:{start:f_},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Frontend NGINX server has a block similar to this."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"In our case, we use "},{type:b,tag:h,props:{href:"https:\u002F\u002Fsaltstack.com\u002Fcommunity\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"Salt Stack"}]},{type:a,value:" as the configuration management system, it\nbasically generates the Virtual Hosts for us as using "},{type:b,tag:h,props:{href:"https:\u002F\u002Fdocs.saltstack.com\u002Fen\u002Flatest\u002Ftopics\u002Freactor\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"Salt reactor"}]},{type:a,value:" system.\nEvery time a Docker instance would become available, the configuration will be\nrewritten using this template."}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"{{ upstream_port }}"}]},{type:a,value:" would be at "},{type:b,tag:j,props:{},children:[{type:a,value:"8000"}]},{type:a,value:" in this example"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"{{ upstreams }}"}]},{type:a,value:" would be an array of current internal Docker instances, e.g.\n"},{type:b,tag:j,props:{},children:[{type:a,value:"['10.10.10.3','10.10.10.4']"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"{{ tld }}"}]},{type:a,value:" would be "},{type:b,tag:x,props:{},children:[{type:a,value:cs}]},{type:a,value:" in production, but can be anything else\nwe need in other deployment, it gives great flexibility."}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Notice the use of "},{type:b,tag:j,props:{},children:[{type:a,value:"discoursepolling"}]},{type:a,value:" alongside the "},{type:b,tag:j,props:{},children:[{type:a,value:dH}]},{type:a,value:" subdomain name.\nRefer to "},{type:b,tag:aJ,props:{to:fV},children:[{type:a,value:"this post about "},{type:b,tag:x,props:{},children:[{type:a,value:fW}]}]},{type:a,value:" to understand its purpose"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,cQ]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bY}]},{type:a,value:" upstream_discourse"}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:"%- for b in upstreams %"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bo}]}]},{type:a,value:"    "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:" b "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:" upstream_port "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:"%- endfor %"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:fY}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"16"}]}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bo}]}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bO}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bU}]},{type:a,value:fv}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bP}]},{type:a,value:" discoursepolling."}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:f$},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"discourse."}]}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:f$},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:cZ},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:ap}]},{type:a,value:"    \u002Fvar\u002Fwww\u002Fhtml"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bV}]},{type:a,value:" common_params"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bV}]},{type:a,value:" ssl_params"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:cZ},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"ssl"}]},{type:a,value:ga},{type:b,tag:c,props:{className:[d,aM]},children:[{type:a,value:gb}]}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"ssl_certificate"}]},{type:a,value:"     \u002Fetc\u002Fssl\u002F2015\u002Fdiscuss.pem"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"ssl_certificate_key"}]},{type:a,value:" \u002Fetc\u002Fssl\u002F2015\u002F201503.key"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:cZ},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Use internal Docker runner instance exposed port"}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:eY}]},{type:a,value:eZ}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ae}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"proxy_pass"}]},{type:a,value:"             http:\u002F\u002Fupstream_discourse"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bV}]},{type:a,value:"                proxy_params"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"proxy_intercept_errors"}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,aM]},children:[{type:a,value:gb}]}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:"\n\n        "},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# Backend keepalive"}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"# ref: http:\u002F\u002Fnginx.org\u002Fen\u002Fdocs\u002Fhttp\u002Fngx_http_upstream_module.html#keepalive"}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"proxy_http_version"}]},{type:a,value:" 1.1"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:"proxy_set_header"}]},{type:a,value:" Connection "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"\""}]}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:S},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:af}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Note that I removed the "},{type:b,tag:j,props:{},children:[{type:a,value:"include proxy_params;"}]},{type:a,value:" line. If you have lines similar\nto "},{type:b,tag:j,props:{},children:[{type:a,value:"proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;"}]},{type:a,value:", you don't\nneed them (!)"}]}]},dir:gc,path:"\u002Fblog\u002F2015\u002F04\u002Fsetting-discourse-fastly-cdn-provider-ssl",extension:ay,slug:"setting-discourse-fastly-cdn-provider-ssl",createdAt:bw,updatedAt:bw,category:am,prettyfiedTemporalDate:{prettified:"Wednesday, April 29, 2015",temporalDate:"2015-04-29"}},{title:"Upgrade to Python 2.7.9 on Ubuntu 14.04 LTS and make your own .deb package for deployment",locale:aE,created:"2015-04-05T00:00:00.000Z",updated:aO,canonical:"https:\u002F\u002Frenoirboulanger.com\u002Fblog\u002F2015\u002F04\u002Fupgrade-python-2-7-9-ubuntu-14-04-lts-making-deb-package\u002F",status:ax,revising:$,caption:R,caracteresBizzares:R,gallery:R,migrateCode:$,migrateImages:R,migrateLinks:R,categories:[am],tags:[aP,aH,ar,"best-practices"],keywords:["Python","ubuntu"],excerpt:"Need to run your web app with Python 2.7.9, but server environment uses Ubuntu Long Term Support? Don‚Äôt replace Python, leverage VirtualEnv instead!",toc:[{id:gd,depth:U,text:ge},{id:aH,depth:U,text:gf},{id:gg,depth:U,text:gh},{id:gi,depth:ab,text:gj},{id:gk,depth:U,text:gl}],body:{type:ap,children:[{type:b,tag:f,props:{},children:[{type:a,value:"I had this post hanging in my drafts on how I attempted to install a valid\nPython 2.7.9 runtime environment on Ubuntu 14.04 and make my own .deb package\nfor easy re-deployment."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:dF}]},{type:a,value:" This procedure isn't complete as I had to shift focus elsewhere. I\nmight rework this article to adjust what's missing."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"While I understand that Ubuntu 14.04 "},{type:b,tag:h,props:{href:"https:\u002F\u002Faskubuntu.com\u002Fquestions\u002F559036\u002Fwhen-will-the-python-2-7-9-upgrades-be-available-from-apt-get-for-14-04lts#answer-560159",rel:[m,n,o],target:p},children:[{type:a,value:"will"}]},{type:a,value:l},{type:b,tag:h,props:{href:"https:\u002F\u002Fserverfault.com\u002Fquestions\u002F669859\u002Fhow-can-i-upgrade-python-to-2-7-9-on-ubuntu-14-4",rel:[m,n,o],target:p},children:[{type:a,value:"remain"}]},{type:a,value:" using "},{type:b,tag:x,props:{},children:[{type:a,value:"Python 2.7.6"}]},{type:a,value:"\ninternally, applications we run can be configured to use another python\nenvironment. Its what virtualenv is all about after all, isn't it."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"This post attempts to install, and make an installable "},{type:b,tag:x,props:{},children:[{type:a,value:".deb"}]},{type:a,value:" package of\n"},{type:b,tag:E,props:{},children:[{type:a,value:"Python 2.7.9"}]},{type:a,value:" and is meant to be used by web applications without touching\nthe system's python runtime."}]},{type:a,value:e},{type:b,tag:Z,props:{id:gd},children:[{type:b,tag:h,props:{href:"#why-not-replacing-internal-python-version",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:ge}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The reason is simple. If you replace internal Python version, other softwares\nwithin the OS will have broken dependencies."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"I realized this while I wanted to upgrade the version and breaking an hard\ndependency I have on Salt Stack. Since many components within a given Ubuntu\nversion relies on Python, it could break anything else. This is why I stopped\nworking on the idea of replacing internally, but instead to configure VirtualEnv\nto use another version instead."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"If you see procedures that shows you to replace telling you to use\n"},{type:b,tag:j,props:{},children:[{type:a,value:"update-alternatives"}]},{type:a,value:" to replace python, don't do it! Go instead learn how to\nrun your own Python version in VirtualEnv."}]},{type:a,value:e},{type:b,tag:Z,props:{id:aH},children:[{type:b,tag:h,props:{href:"#procedure",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:gf}]},{type:a,value:e},{type:b,tag:ak,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Install build dependencies"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Those were the ones I ran last before a successful build on "},{type:b,tag:E,props:{},children:[{type:a,value:"Ubuntu 14.04\nLTS"}]},{type:a,value:", if you aren't using the same distribution, you might get a different\nlist."}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cP}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aK}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:gm}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        autotools-dev "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        blt-dev "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"bzip2"}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        dpkg-dev "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        g++-multilib "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        gcc-multilib "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:gn},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:gn},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:go},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:go},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:gp},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:gp},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        libffi-dev "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        libffi6 "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        libffi6-dbg "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        libgdbm-dev "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        libgpm2 "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        libncursesw5-dev "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        libreadline-dev "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        libsqlite3-dev "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:gq},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:gq},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        libtinfo-dev "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        mime-support "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        net-tools "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        netbase "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        python-crypto "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        python-mox3 "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        python-pil "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        python-ply "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        quilt "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        tk-dev "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        zlib1g-dev "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        zlib1g-dev\n"}]}]}]},{type:a,value:e},{type:b,tag:ak,props:{start:U},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Get Python sources and compile"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:c_}]},{type:a,value:" https:\u002F\u002Fwww.python.org\u002Fftp\u002Fpython\u002F2.7.9\u002FPython-2.7.9.tgz\n"},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"tar"}]},{type:a,value:" xfz Python-2.7.9.tgz\n"},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:bm}]},{type:a,value:" Python-2.7.9\u002F\n.\u002Fconfigure "},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:"--prefix"}]},{type:a,value:" \u002Fusr\u002Flocal\u002Flib\u002Fpython2.7.9 --enable-ipv6\n"},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:gr}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:gr}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aK}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:ak,props:{start:ab},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Test if the version works"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"\u002Fusr\u002Flocal\u002Flib\u002Fpython2.7.9\u002Fbin\u002Fpython "},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:"-V"}]},{type:a,value:"\n\nPython "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"2.7"}]},{type:a,value:".9\n"}]}]}]},{type:a,value:e},{type:b,tag:ak,props:{start:f_},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Then prepare package through FPM"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cP}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aK}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:gm}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        ruby-dev "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n        gcc\n\ngem "},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aK}]},{type:a,value:" fpm\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Its basically about creating a .deb based on your new runtime setup. You can do\nthat by using "},{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fjordansissel\u002Ffpm",rel:[m,n,o],target:p},children:[{type:a,value:"fpm"}]},{type:a,value:" (\"Fabulous Package Manager\"), I am "},{type:b,tag:h,props:{href:"https:\u002F\u002Frenoirboulanger.com\u002Fblog\u002F2015\u002F02\u002Finstall-php5-memcached-pecl-extension-support-igbinary\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"using this technique\nin a post I published recently about installing a PHP library"}]},{type:a,value:T}]},{type:a,value:e},{type:b,tag:Z,props:{id:gg},children:[{type:b,tag:h,props:{href:"#incomplete-scratchpad",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:gh}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"But that's as far as my notes goes for now. Sorry about that."}]},{type:a,value:e},{type:b,tag:ac,props:{id:gi},children:[{type:b,tag:h,props:{href:"#setuptools",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:gj}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"As per recommended in "},{type:b,tag:h,props:{href:"https:\u002F\u002Fpypi.python.org\u002Fpypi\u002Fsetuptools#unix-wget",rel:[m,n,o],target:p},children:[{type:a,value:"Setuptools instructions"}]},{type:a,value:", we can run "},{type:b,tag:j,props:{},children:[{type:a,value:"easy_install"}]},{type:a,value:"\nthrough a "},{type:b,tag:j,props:{},children:[{type:a,value:c_}]},{type:a,value:", like so;"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:c_}]},{type:a,value:" https:\u002F\u002Fbootstrap.pypa.io\u002Fez_setup.py "},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:"-O"}]},{type:a,value:" - "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:"|"}]},{type:a,value:" \u002Fusr\u002Flocal\u002Flib\u002Fpython2.7.9\u002Fbin\u002Fpython\n\n  \u002Fusr\u002Flocal\u002Flib\u002Fpython2.7.9\u002Fbin\u002Feasy_install pip\n  \u002Fusr\u002Flocal\u002Flib\u002Fpython2.7.9\u002Fbin\u002Fpip "},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aK}]},{type:a,value:" virtualenv\n\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Then, create symbolic links"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:gs}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:cH}]},{type:a,value:" \u002Fusr\u002Flocal\u002Flib\u002Fpython2.7.9\u002Fbin\u002Feasy_install \u002Fusr\u002Fbin\u002Feasy_install\n"},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:gs}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:cH}]},{type:a,value:" \u002Fusr\u002Flocal\u002Flib\u002Fpython2.7.9\u002Fbin\u002Fpip \u002Fusr\u002Fbin\u002Fpip\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"You can try if it worked"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"pip list\n\n  pip "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aD}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"6.0"}]},{type:a,value:".8"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ag}]},{type:a,value:"\n  setuptools "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aD}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"14.3"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ag}]},{type:a,value:"\n  virtualenv "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aD}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"12.0"}]},{type:a,value:".7"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ag}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:Z,props:{id:gk},children:[{type:b,tag:h,props:{href:"#resources",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:gl}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:gt,rel:[m,n,o],target:p},children:[{type:a,value:gt}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:gu,rel:[m,n,o],target:p},children:[{type:a,value:gu}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:gv,rel:[m,n,o],target:p},children:[{type:a,value:gv}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:gw,rel:[m,n,o],target:p},children:[{type:a,value:gw}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:gx,rel:[m,n,o],target:p},children:[{type:a,value:gx}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:gy,rel:[m,n,o],target:p},children:[{type:a,value:gy}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:gz,rel:[m,n,o],target:p},children:[{type:a,value:gz}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"http:\u002F\u002Fwww.stylesen.org\u002Fpython%5C_27%5C_debian%5C_squeeze%5C_60",rel:[m,n,o],target:p},children:[{type:a,value:"http:\u002F\u002Fwww.stylesen.org\u002Fpython\\_27\\_debian\\_squeeze\\_60"}]}]},{type:a,value:e}]}]},dir:gc,path:"\u002Fblog\u002F2015\u002F04\u002Fupgrade-python-2-7-9-ubuntu-14-04-lts-making-deb-package",extension:ay,slug:"upgrade-python-2-7-9-ubuntu-14-04-lts-making-deb-package",createdAt:bw,updatedAt:bw,category:am,prettyfiedTemporalDate:{prettified:"Sunday, April 5, 2015",temporalDate:"2015-04-05"}},{title:"Creating a new Ubuntu Salt master from the terminal using Cloud-Init",locale:aE,created:"2015-03-09T00:00:00.000Z",updated:aO,canonical:"https:\u002F\u002Frenoirboulanger.com\u002Fblog\u002F2015\u002F03\u002Fcreating-new-ubuntu-salt-master-terminal-using-cloud-init\u002F",status:ax,revising:$,caption:R,caracteresBizzares:R,gallery:R,migrateCode:$,migrateImages:R,migrateLinks:R,categories:[am],tags:[ar,aQ,cV,bp],keywords:["GNU","OpenStack","Cloud Init"],excerpt:"Cloud-Init is made in a way that it handles distribution specific package installation details automatically. With it, you can create a new salt master in a few commands.",coverImage:{src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F03\u002Fopenstack-cloudinit-screenshot.jpg",text:"[Open Stack Cloud-Init](https:\u002F\u002Fcloudinit.readthedocs.io\u002Fen\u002Flatest\u002F) documentation.\n"},description:"Creating new Salt master in a few commands with Cloud-Init",toc:[{id:gA,depth:U,text:gB}],body:{type:ap,children:[{type:b,tag:f,props:{},children:[{type:a,value:"If you run on Virtual Machines on a provider that runs OpenStack you can also\nleverage a component that‚Äôs made to automatically install softwares at creation\ntime. With this, you can any new node in your cluster, including the salt-master\nin a few terminal commands."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Before starting out, you need to make sure your cloud provider runs Open Stack\nand has "},{type:b,tag:h,props:{href:bZ,rel:[m,n,o],target:p,title:b_},children:[{type:a,value:a_}]},{type:a,value:" enabled. To check it out, look in the \"Launch instance\"\ndialog to create a new VM a tab titled \"Post-Creation\", it might just simply\nwork."}]},{type:a,value:e},{type:b,tag:ah,props:{style:aY,src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F03\u002Fopenstack-cloudinit-launchinstance-dialog.png",alt:"OpenStack Cloud-Init dialog"},children:[{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:h,props:{href:bZ,rel:[m,n,o],target:p,title:b_},children:[{type:a,value:a_}]},{type:a,value:" is basically reading a manifest that declares what‚Äôs the\nspecifics of the new VM and is part of the conversion from the initial image\nOpenStack into the specific instance you will be using. You can follow those\n"},{type:b,tag:h,props:{href:b$,rel:[m,n,o],target:p,title:gC},children:[{type:a,value:"two"}]},{type:a,value:l},{type:b,tag:h,props:{href:b$,rel:[m,n,o],target:p,title:c$},children:[{type:a,value:"articles"}]},{type:a,value:" that describes well how "},{type:b,tag:x,props:{},children:[{type:a,value:a_}]},{type:a,value:" works."}]},{type:a,value:e},{type:b,tag:bj,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:h,props:{href:bZ,rel:[m,n,o],target:p,title:b_},children:[{type:a,value:a_}]},{type:a,value:" is made in a way that it handles distribution specific\npackage installation details automatically."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The following is specific to an "},{type:b,tag:x,props:{},children:[{type:a,value:"Ubuntu server"}]},{type:a,value:" VM, but you might need to adjust\nthe package names to match your current server distribution as those tools are\ngetting more and more popular in the industry."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Before testing out on a new VM, you could also check from an existing instance\nand ask through an HTTP request what was the current instance‚Äô post-creation\nscript using cURL."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Note that the IP address you see below is a virtual interface provided by\nOpenStack but can be navigated through HTTP, try it out like this;"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cX}]},{type:a,value:" http:\u002F\u002F169.254.169.254\u002Fopenstack\u002F\n\n  "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"2012"}]},{type:a,value:"-08-10\n  "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:gD}]},{type:a,value:"-04-04\n  "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:gD}]},{type:a,value:"-10-17\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"If you see a similar output, you can ask what was the post-creation\nconfiguration (\"userdata\") it used at creation time. You can dig the tree,\nhere‚Äôs how you can find it in an OpenStack (CURRENT VERSION NICKNAME) cluster."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"For instance, my a salt master would have the following configuration;"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cX}]},{type:a,value:" http:\u002F\u002F169.254.169.254\u002Fopenstack\u002F2013-10-17\u002Fuser_data\n\n  "},{type:b,tag:c,props:{className:[d,O]},children:[{type:a,value:"#cloud-config"}]},{type:a,value:"\n  manage_etc_hosts: "},{type:b,tag:c,props:{className:[d,aM]},children:[{type:a,value:gE}]},{type:a,value:"\n  manage-resolv-conf: "},{type:b,tag:c,props:{className:[d,aM]},children:[{type:a,value:gE}]},{type:a,value:"\n  locale: en_US.UTF-8\n  timezone: America\u002FNew_York\n  package_upgrade: "},{type:b,tag:c,props:{className:[d,aM]},children:[{type:a,value:z}]},{type:a,value:"\n  package_update: "},{type:b,tag:c,props:{className:[d,aM]},children:[{type:a,value:z}]},{type:a,value:"\n  package_reboot_if_required: "},{type:b,tag:c,props:{className:[d,aM]},children:[{type:a,value:z}]},{type:a,value:"\n\n  ssh_import_id: "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:"saltstack"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:"\n  apt_sources:\n    - source: "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"ppa:saltstack\u002Fsalt\""}]},{type:a,value:"\n\n  packages:\n    - salt-minion\n    - salt-common\n    - salt-master\n    - python-software-properties\n    - software-properties-common\n    - python-novaclient\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"To boot an instance from the terminal, you can use the \"nova\" command like this;"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[F,v]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"nova boot "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:da},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:"--image"}]},{type:a,value:" Ubuntu-14.04-Trusty "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n     --user-data \u002Fsrv\u002Fcloudconfig.yml "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:da},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:"--key_name"}]},{type:a,value:" keyname "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:da},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:"--flavor"}]},{type:a,value:" subsonic "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n     --security-groups default "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:y}]},{type:a,value:"\n     salt\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"This assumes that you have the following available in your OpenStack dashboard:"}]},{type:a,value:e},{type:b,tag:ak,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"An SSH public key called \"keyname\" in your tenant"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"A flavor called \"subsonic\" that has a predefined configuration of vCPU, vRAM,\netc."}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"A security group called \"default\", you could use more than one by separating\nthem by comas; e.g. default,foo,bar"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"A text file in "},{type:b,tag:j,props:{},children:[{type:a,value:gF}]},{type:a,value:" in YAML format that holds your\n"},{type:b,tag:h,props:{href:bZ,rel:[m,n,o],target:p,title:b_},children:[{type:a,value:a_}]},{type:a,value:" (a.k.a. \"userdata\") configuration."}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"You have your nova configuration available (look in your cloud provider\ndashboard \"Download OpenStack RC File\" link in \"Access & Security\" and \"API\naccess\") and available in your server‚Äôs "},{type:b,tag:j,props:{},children:[{type:a,value:"\u002Fetc\u002Fprofile.d\u002F"}]},{type:a,value:" profile folder."}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"You have \""},{type:b,tag:j,props:{},children:[{type:a,value:"python-novaclient"}]},{type:a,value:"\" (or its equivalent) installed"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"To test it out yourself, you could use the block I gave earlier and create a\nfile in "},{type:b,tag:j,props:{},children:[{type:a,value:gF}]},{type:a,value:" and give the the "},{type:b,tag:x,props:{},children:[{type:a,value:gG}]},{type:a,value:" command a try."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"In this case, you might want to call the new VM \"salt\" as the default Salt stack\nconfiguration will try to communicate to it to make it its salt master. In this\ncase, it‚Äôll be itself."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The creation of the salt master could also contain a few git repositories to be\ncloned at the salt master creation time making your salt master as easily\nreplaceable as any other components in your \"cloud\"."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"A set of sample scripts I use to create a new salt master off of a few\n"},{type:b,tag:h,props:{href:"https:\u002F\u002Fgist.github.com\u002FWebPlatformDocs\u002F01c09df78f05612c281f",rel:[m,n,o],target:p},children:[{type:a,value:"git repositories can be found in the following Gist"}]}]},{type:a,value:e},{type:b,tag:Z,props:{id:gA},children:[{type:b,tag:h,props:{href:"#read-more",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:gB}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"The following articles was found to be describing in more detail what I\nintroduced in this article."}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:b$,rel:[m,n,o],target:p,title:gC},children:[{type:a,value:"Easily automate The provisioning of your DigitalOcean Droplets"}]},{type:a,value:". Don‚Äôt be\nfooled by the name, the article is actually describing "},{type:b,tag:x,props:{},children:[{type:a,value:a_}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:b$,rel:[m,n,o],target:p,title:c$},children:[{type:a,value:c$}]}]},{type:a,value:e}]}]},dir:"\u002Fblog\u002F2015\u002F03",path:"\u002Fblog\u002F2015\u002F03\u002Fcreating-new-ubuntu-salt-master-terminal-using-cloud-init",extension:ay,slug:"creating-new-ubuntu-salt-master-terminal-using-cloud-init",createdAt:gH,updatedAt:gH,category:am,prettyfiedTemporalDate:{prettified:"Monday, March 9, 2015",temporalDate:"2015-03-09"}},{title:"Quelques bouts de code pour automatiser le d√©ploiement",locale:gI,created:"2015-01-28T00:00:00.000Z",updated:"2015-02-17T00:00:00.000Z",canonical:"https:\u002F\u002Frenoirboulanger.com\u002Fblog\u002F2015\u002F01\u002Fquelques-bouts-de-code-pour-automatiser-le-deploiement\u002F",status:ax,revising:R,migrateLinks:$,migrateImages:R,gallery:R,caption:R,categories:[am],tags:[bp,"development",ar,cV],coverImage:{src:"~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F01\u002Fautomate-all-the-things-300x284.png",srcset:["https:\u002F\u002Frenoirb.github.io\u002Fsite-assets\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F01\u002Fautomate-all-the-things-300x284.png 300w","https:\u002F\u002Frenoirb.github.io\u002Fsite-assets\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F01\u002Fautomate-all-the-things-1024x971.png 1024w","https:\u002F\u002Frenoirb.github.io\u002Fsite-assets\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F01\u002Fautomate-all-the-things.png 1600w"],sizes:"(max-width: 300px) 100vw, 300px",alt:"Illustration souvent utilis√©e pour un m√®me de l‚ÄôInternet d‚Äôun dessin fait rapidement √† la main illustrant un personnage avec une lumi√®re √©clatante derri√®re comme l‚Äôintroduction d‚Äôun super h√©ros. Le personnage tient un balai d‚Äôune main et brandissant l‚Äôautre bras et les yeux pas tr√®s align√©s. Il proclame Automatisons tout!",text:"Automatisons Tout!!1\n"},preamble:{disable:$,text:l},excerpt:"Avez-vous d√©j√† voulu automatiser le d√©ploiement de votre infrastructure serveurs web de A-Z? C‚Äôest exactement sur quoi je travaille en ce moment.",toc:[{id:gJ,depth:U,text:gK},{id:gL,depth:U,text:gM},{id:gN,depth:U,text:gO}],body:{type:ap,children:[{type:b,tag:f,props:{},children:[{type:a,value:"Ce billet n‚Äôest qu‚Äôun simple ¬´link dump¬ª pour retrouver parmi plusieurs notes\n√©parpill√©s. Je compte √©ventuellement publier la totalit√© de mon travail dans des\nprojets publics sur GitHub une fois la boucle compl√©t√©e. Le tout sans fournir\nles donn√©es priv√©s, √©videmment."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Faire le saut vers l‚Äôautomatisation demande beaucoup de pr√©paration et je prends\nle temps de publier ici quelques bouts de code que j‚Äôai √©crits pour compl√©ter la\nt√¢che."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Au final, mon projet permettra de d√©ployer un site qui s‚Äôappuie sur un cluster\nMariaDB, Memcached, une stack LAMP (¬´prefork¬ª) lorsqu‚Äôon a pas le choix, une\nstack [HHVM\u002Fphp5-fpm, Python, nodejs] app servers pour le reste servi par un\nfrontend NGINX. Mes scripts vont d√©ployer une s√©rie d‚Äôapplications web avec\ntoutes les d√©pendances qui les adaptent g√©r√© dans leur propre ¬´git repo¬ª parent.\nDans mon cas, ce sera: WordPress, MediaWiki, Discourse, et quelques autres."}]},{type:a,value:e},{type:b,tag:Z,props:{id:gJ},children:[{type:b,tag:h,props:{href:"#requis",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:gK}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Instantiation √† partir de commandes "},{type:b,tag:j,props:{},children:[{type:a,value:gG}]},{type:a,value:" du terminal, cr√©e une nouvelle VM\nmise √† jour et son nom d√©finit son r√¥le dans le r√©seau interne"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Les VMs sont uniquement accessible par un Jump box (i.e. r√©seau interne\nseulement)"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Un syst√®me regarde si un r√©pertoire clone git √† eu des changements sur la\nbranche ¬´master¬ª, lance un √©v√©nement si c‚Äôest le cas"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Chaque machine sont construites √† partir d‚Äôune VM minimale. Dans ce cas-ci;\nUbuntu 14.04 LTS"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Syst√®me doit s‚Äôassurer que TOUTES les mises √† jour sont appliqu√©s\nr√©guli√®rement"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Syst√®me doit s‚Äôassurer que ses services interne sont fonctionnels"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Dans le cas d‚Äôune situation o√π une VM atteint le seuil critique OOM, la VM\nred√©marre automatiquement"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Le nom de la VM d√©crit son r√¥le, et les scripts d‚Äôinstallation installent les\nrequis qui y sont affect√©s"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Les configurations utilisent les d√©tails (e.g. adresses IP priv√©s et\npubliques) de chaque pool (e.g. redis, memcache, mariadb) et ajuste\nautomatiquement les configurations dans chaque application"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"... etc."}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:Z,props:{id:gL},children:[{type:b,tag:h,props:{href:"#bouts-de-code",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:gM}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Frenoirboulanger.com\u002Fblog\u002F2015\u002F01\u002Fcreate-mariadb-cluster-replication-ssl-salt-stack\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"Installation automatis√©e d‚Äôun cluster MariaDB avec r√©plication SSL"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fgist.github.com\u002FWebPlatformDocs\u002F6ecf0d852a9148741bef",rel:[m,n,o],target:p},children:[{type:a,value:"Configuration SSH pour acc√©der aux VMs du r√©seau interne"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fgist.github.com\u002FWebPlatformDocs\u002F437f763b948c926ca7ba",rel:[m,n,o],target:p},children:[{type:a,value:"V√©rifier si un git repo a chang√©"}]},{type:a,value:", j‚Äôai pr√©vu faire un \"salt-call\" qui\ntrigger un √©v√©nement Salt Reactor pour lancer un build run"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:gP,rel:[m,n,o],target:p},children:[{type:a,value:"Configuration Monit"}]},{type:a,value:" pour s‚Äôassurer que les services ¬´sont up and running¬ª"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:gQ,rel:[m,n,o],target:p},children:[{type:a,value:"Installer automatiquement une VM enregistr√©e au salt-master"}]},{type:a,value:" via Salt\nReactor. Le nom de la VM d√©clare son r√¥le, le reste se fait tout seul\n(incomplet mais un d√©but)"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fgist.github.com\u002Frenoirb\u002F1b42edac44c723185c9d",rel:[m,n,o],target:p},children:[{type:a,value:"Installer des plugins WordPress √† partir des repos Git\u002FSVN\u002FFichiers Zip"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:gR,rel:[m,n,o],target:p},children:[{type:a,value:"Installation automatique d‚Äôun salt-master"}]},{type:a,value:" et des d√©pendances de build"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fgist.github.com\u002Frenoirb\u002Fb2e0222ad52e5d453298",rel:[m,n,o],target:p},children:[{type:a,value:"D√©finir le r√¥le d‚Äôune VM bas√© sur son nom + TLD"}]},{type:a,value:" (e.g.\nredis-sessions.production.wpdn)"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fgist.github.com\u002Frenoirb\u002F11258261",rel:[m,n,o],target:p},children:[{type:a,value:"V√©rifier avec l‚Äôorigine d‚Äôun clone git s‚Äôil y a des changements upstream,\nlancer un √©v√©nement si c‚Äôest le cas"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:gQ,rel:[m,n,o],target:p},children:[{type:a,value:"Automatiser des commands selon certains √©v√©nemnts dans un cluster g√©r√© par\nSalt"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:gR,rel:[m,n,o],target:p},children:[{type:a,value:"Automatiser l‚Äôinstallation d‚Äôun salt master bas√© uniquement sur une s√©rie de\ngit repos et d‚Äôun bootstrapper script"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fgist.github.com\u002FWebPlatformDocs\u002Fe925fee9b6085d7cbec4",rel:[m,n,o],target:p},children:[{type:a,value:"Automatiser les backups ElasticSearch"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:gP,rel:[m,n,o],target:p},children:[{type:a,value:"Syst√®me pour s‚Äôassurer que tous les services son fonctionnels, comment tester\ns‚Äôils fonctionnent et comment les red√©marrer"}]},{type:a,value:" avec "},{type:b,tag:E,props:{},children:[{type:a,value:"Monit"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:Z,props:{id:gN},children:[{type:b,tag:h,props:{href:"#billets-inspirants-sur-le-sujet",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:gO}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"http:\u002F\u002Fblog.hendrikvolkmer.de\u002F2013\u002F04\u002F03\u002Fthere-will-be-no-reliable-cloud-part-1\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"There will be no reliable cloud (part 1)"}]},{type:a,value:aR},{type:b,tag:h,props:{href:"http:\u002F\u002Fblog.hendrikvolkmer.de\u002F2013\u002F04\u002F09\u002Fthere-will-be-no-reliable-cloud-part-2\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"part 2"}]},{type:a,value:aR},{type:b,tag:h,props:{href:"http:\u002F\u002Fblog.hendrikvolkmer.de\u002F2013\u002F04\u002F12\u002Fthere-will-be-no-reliable-cloud-part-3\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"part 3"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"http:\u002F\u002Fblog.hendrikvolkmer.de\u002F2013\u002F10\u002F11\u002Fthe-missing-piece-operating-systems-for-web-scale-cloud-apps\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"The missing piece operating systems for \"Web Scale\" Cloud Apps"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"http:\u002F\u002Fwww.rightbrainnetworks.com\u002Fblog\u002Fwhy-an-ec2-instance-isnt-a-server\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"Why an X (VM) \"instance\" isn‚Äôt a server"}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:h,props:{href:"http:\u002F\u002Fsamj.net\u002F2012\u002F03\u002F08\u002Fsimplifying-cloud-reliability\u002F",rel:[m,n,o],target:p},children:[{type:a,value:"Simplifying cloud reliability"}]}]},{type:a,value:e}]},{type:a,value:e}]},dir:"\u002Fblog\u002F2015\u002F01",path:"\u002Fblog\u002F2015\u002F01\u002Fquelques-bouts-de-code-pour-automatiser-le-deploiement",extension:ay,slug:"quelques-bouts-de-code-pour-automatiser-le-deploiement",createdAt:"2024-10-24T19:43:51.722Z",updatedAt:"2024-10-24T19:43:51.723Z",category:am,prettyfiedTemporalDate:{prettified:"mercredi 28 janvier 2015",temporalDate:"2015-01-28"}},{title:"Tester le fonctionnement d'un serveur SMTP",locale:gI,created:"2008-04-19T00:00:00.000Z",updated:"2014-02-19T00:00:00.000Z",canonical:"https:\u002F\u002Frenoirboulanger.com\u002Fblog\u002F2008\u002F04\u002Ftester-le-fonctionnement-dun-serveur-smtp\u002F",status:ax,revising:$,categories:[am],tags:[aQ,aH,ar,"techniques","tutoriels"],excerpt:"Envoyer et recevoir des courriels implique une combinaison de syst√®mes qui interagissent d'une fa√ßon assez complexe et un probl√®me de r√©ception ou de classement peut √™tre caus√© par plusieurs raisons. √âtant donn√© que tout est tr√®s intrins√®que sur un serveur, voici une proc√©dure pour s'assurer que tout est en ordre.",toc:[{id:gS,depth:ab,text:gT},{id:gU,depth:U,text:gV},{id:gW,depth:ab,text:gX},{id:gY,depth:ab,text:gZ},{id:g_,depth:ab,text:g$},{id:ha,depth:ab,text:hb},{id:hc,depth:ab,text:hd},{id:he,depth:ab,text:hf},{id:hg,depth:ab,text:hh},{id:hi,depth:ab,text:hj},{id:hk,depth:ab,text:hl},{id:hm,depth:U,text:hn},{id:ho,depth:ab,text:hp},{id:hq,depth:ab,text:hr},{id:hs,depth:U,text:ht},{id:hu,depth:U,text:hv},{id:hw,depth:U,text:hx},{id:hy,depth:U,text:hz},{id:hA,depth:ab,text:hB},{id:hC,depth:U,text:hD}],body:{type:ap,children:[{type:b,tag:ac,props:{id:gS},children:[{type:b,tag:h,props:{href:"#v%C3%A9rifier-si-le-firewall-bloque-certains-services",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:gT}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Id√©alement il faut faire ces tests d'un autre ordinateur que celui qu'on veut\nv√©rifier."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Ainsi on voit si les services sont fonctionnels en tant que tel, et si le\nfirewall ne les bloquent pas."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Quelques ports √† tester, qui donnent une r√©ponse"}]},{type:a,value:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{type:b,tag:d$,props:{},children:[{type:b,tag:ea,props:{},children:[{type:b,tag:aB,props:{},children:[{type:b,tag:aF,props:{},children:[{type:a,value:"Nom du service"}]},{type:b,tag:aF,props:{},children:[{type:a,value:"Port TCP"}]}]}]},{type:b,tag:eb,props:{},children:[{type:b,tag:aB,props:{},children:[{type:b,tag:L,props:{},children:[{type:a,value:"POP"}]},{type:b,tag:L,props:{},children:[{type:a,value:"101"}]}]},{type:b,tag:aB,props:{},children:[{type:b,tag:L,props:{},children:[{type:a,value:hE}]},{type:b,tag:L,props:{},children:[{type:a,value:hF}]}]},{type:b,tag:aB,props:{},children:[{type:b,tag:L,props:{},children:[{type:a,value:"SMTP"}]},{type:b,tag:L,props:{},children:[{type:a,value:av}]}]},{type:b,tag:aB,props:{},children:[{type:b,tag:L,props:{},children:[{type:a,value:"FTP"}]},{type:b,tag:L,props:{},children:[{type:a,value:hG}]}]}]}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:ca}]},{type:a,value:" web1.renoirboulanger.com\n"},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:hH}]},{type:a,value:" +OK POP3 Welcome to vm-pop3d "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:hI}]},{type:a,value:".7f-DA-2\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:cb},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:ca}]},{type:a,value:db},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:hF}]},{type:a,value:"\n* OK "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:"CAPABILITY IMAP4REV1 LITERAL+ SASL-IR LOGIN-REFERRALS "},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:"AUTH"}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:"LOGIN"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:"\nweb1.renoirboulanger.com IMAP4rev1 "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"2004.357"}]},{type:a,value:" at Tue, "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aN}]},{type:a,value:a$},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:az}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aG}]},{type:a,value:":08:17 "},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:ba}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aD}]},{type:a,value:"EST"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ag}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:cb},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:ca}]},{type:a,value:db},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:av}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cc}]},{type:a,value:hJ},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dc}]},{type:a,value:" Tue, "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aN}]},{type:a,value:a$},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:az}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aG}]},{type:a,value:":11:10 "},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:ba}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:cb},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:ai},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:ca}]},{type:a,value:db},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:hG}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cc}]},{type:a,value:" ProFTPD "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"1.3"}]},{type:a,value:".1rc2 Server ready.\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:cb},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Note: la note [^c] implique qu'on peut faire "},{type:b,tag:hK,props:{},children:[{type:a,value:"Ctrl"}]},{type:a,value:" + "},{type:b,tag:hK,props:{},children:[{type:a,value:"c"}]},{type:a,value:"\npour quitter plus rapidement de l'attente"}]},{type:a,value:e},{type:b,tag:Z,props:{id:gU},children:[{type:b,tag:h,props:{href:"#tester-le-serveur-courriel",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:gV}]},{type:a,value:e},{type:b,tag:ac,props:{id:gW},children:[{type:b,tag:h,props:{href:"#cr%C3%A9er-un-compte-de-test",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:gX}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Permet d'√©viter de remplir le compte courriel d'un client."}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Cr√©er un compte dans "},{type:b,tag:E,props:{},children:[{type:a,value:"DirectAdmin"}]},{type:a,value:hL},{type:b,tag:E,props:{},children:[{type:a,value:"Show all Users"}]},{type:a,value:"\", "},{type:b,tag:x,props:{},children:[{type:a,value:"username"}]},{type:a,value:hL},{type:b,tag:E,props:{},children:[{type:a,value:"E-Mail Accounts"}]},{type:a,value:aT}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ac,props:{id:gY},children:[{type:b,tag:h,props:{href:"#test-envoi-local-vers-virtual_local-avec-exim",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:gZ}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Avant de tester avec une application (remote en shell, ou GMail par exemple) On\ndevrait tester en local"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Ensuite... via une application locale √† Gmail "},{type:b,tag:E,props:{},children:[{type:a,value:"Cas de nos courriels\nrenoirboulanger"}]},{type:a,value:", voir \"Test envoi local vers une machine remote avec exim\"\nci-haut."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Le serveur de mon exemple poss√®de Exim comme serveur de transport de courrier\n(SMTP)."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"L'avantage d'utiliser "},{type:b,tag:j,props:{},children:[{type:a,value:"exim -v -odf"}]},{type:a,value:" c'est qu'on sait en shell le output et on\nsait les messages directement"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:hM},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:aS}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:hN}]},{type:a,value:" test@renoirboulanger.com         "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:bx},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:hO},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dd}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:aV}]},{type:a,value:" a virtuallocal "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:bx},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:"\nMessage body                                  "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:bx},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:T}]},{type:a,value:"                                             "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:bx},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:hP},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:de}]},{type:a,value:hQ},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:df}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:hR},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:dg}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:dh},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:bb}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:hS}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:bc}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:hT}]},{type:a,value:"\ndelivering 1JSZkp-0001JH-8H\nLOG: MAIN\n  "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:" support "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:at}]},{type:a,value:"support@renoirboulanger.com"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:di}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:at}]},{type:a,value:by},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:dj}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:hU},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:bc}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:hV},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:bb}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"571"}]},{type:a,value:hW}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Note: La ligne \""},{type:b,tag:E,props:{},children:[{type:a,value:dk}]},{type:a,value:"\" je note g√©n√©ralement un titre explicatif du genre\n\"Test lundi am 5 local a virtuallocal\" qui donne une id√©e de quels tests qui\npassent."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Le output des 7 derni√®res lignes est une r√©ponse expect√©e si tout va bien."}]},{type:a,value:e},{type:b,tag:aL,props:{id:"les-commandes-via-exim"},children:[{type:b,tag:h,props:{href:"#les-commandes-via-exim",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:"Les commandes via exim"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:E,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"exim -v -odf john.doe@example.org"}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"C'est les options qui permettent d'utiliser une instance de Exim pour tester\n("},{type:b,tag:E,props:{},children:[{type:a,value:"odf"}]},{type:a,value:") puis de permettre la (v)erbosit√©"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:E,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:hX}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Il faut entrer "},{type:b,tag:j,props:{},children:[{type:a,value:dk}]},{type:a,value:" Pour annoncer qu'on ajoute au header le sujet, on\npourrait meme ajouter un header comme on veut."}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:"√âcrire le message"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Le prompt condidere que si on commence pas par une commande qui termine par \":\",\nest consid√©r√© comme du "},{type:b,tag:E,props:{},children:[{type:a,value:hY}]},{type:a,value:" pour le courriel en tant que tel (aka. Le )."}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Terminer par \".\""}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:hZ}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ac,props:{id:g_},children:[{type:b,tag:h,props:{href:"#v%C3%A9rifier-le-log-denvoi-smtp",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:g$}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Utile pour chaque tentative... voir o√π le message v√†!"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aW}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cd}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:ce}]},{type:a,value:" \u002Fvar\u002Flog\u002Fexim\u002Fmainlog\n "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:az}]},{type:a,value:dl},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aw}]},{type:a,value:h_},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:de}]},{type:a,value:hQ},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:df}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:hR},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:dg}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:dh},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:bb}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"356"}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:bc}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:hT}]},{type:a,value:dm},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:at}]},{type:a,value:by},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bd}]},{type:a,value:" test@renoirboulanger.com\n "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:az}]},{type:a,value:dl},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aw}]},{type:a,value:h_},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:h$}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:at}]},{type:a,value:"test@renoirboulanger.com"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:di}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:at}]},{type:a,value:by},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:dj}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:hU},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:bc}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:hV},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:bb}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:hS}]},{type:a,value:cF},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:az}]},{type:a,value:dl},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aw}]},{type:a,value:":02:16 1JSZkp-0001JH-8H Completed\n"}]}]}]},{type:a,value:e},{type:b,tag:ac,props:{id:ha},children:[{type:b,tag:h,props:{href:"#tester-r%C3%A9ception-imap",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hb}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"G√©n√©ralement dans *le client "},{type:b,tag:"abbr",props:{},children:[{type:a,value:hE}]},{type:a,value:" (v√©rifie le\nprocessus IMAP) on peut aller acc√©der au compte cr√©√© dans \"Cr√©er un compte de\ntest courriel\"."}]},{type:a,value:e},{type:b,tag:ac,props:{id:hc},children:[{type:b,tag:h,props:{href:"#v%C3%A9rifier-le-log-impad",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hd}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aW}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cd}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:ce}]},{type:a,value:ia},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:av}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aw}]},{type:a,value:dn},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:do0}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:": imap "},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:eT}]},{type:a,value:" init from "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bz}]},{type:a,value:".0.1\n   Feb "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:av}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aw}]},{type:a,value:dn},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:do0}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:": Login "},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:ib}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:ic},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:dp}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:id},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bz}]},{type:a,value:dq},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:ie},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:av}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aw}]},{type:a,value:dn},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:do0}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:": Logout "},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:ib}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:ic},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:dp}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:id},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bz}]},{type:a,value:dq},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:dr},{type:b,tag:j,props:{},children:[{type:a,value:ds}]},{type:a,value:dt}]},{type:a,value:e},{type:b,tag:ac,props:{id:he},children:[{type:b,tag:h,props:{href:"#v%C3%A9rifier-pop-en-telnet",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hf}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"On peut lancer le test √† partir de n'importe quel type de client telnet."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Pour s'assurer que le mail server r√©pond sur le bon, on peut aussi lancer la\nrequete telnet sur le domaine du mail exchange (MX) du client."}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"telnet mail.renoirboulanger.com "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:hH}]},{type:a,value:ga},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:bx},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:"\nTrying "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cf}]},{type:a,value:cg},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:".\nConnected to mail.renoirboulanger.com "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aD}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cf}]},{type:a,value:cg},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ag}]},{type:a,value:".\nEscape character is "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:if0}]},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:T}]},{type:a,value:"\n+OK POP3 Welcome to vm-pop3d "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:hI}]},{type:a,value:".7f-DA-2\nuser test@renoirboulanger.com                         "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:ig},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"user (username)\""}]},{type:a,value:bA},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:"\n+OK\npass GMkRZaKQ                                         "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:ig},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"pass (mot de passe)\""}]},{type:a,value:bA},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:"\n+OK opened mailbox "},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bd}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:h$}]},{type:a,value:"\nlist                                                  "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:"Pour lister les messages "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"list\""}]},{type:a,value:bA},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:"\n+OK\n"},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bX}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"780"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bH}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"488"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bB}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:ih}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:T}]},{type:a,value:"\nretr "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bB}]},{type:a,value:"                                                "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:"Pour obtenir un message, "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"retr (numero du message)\""}]},{type:a,value:bA},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:"\n+OK "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:ih}]},{type:a,value:" octets\nReturn-path: "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:at}]},{type:a,value:by},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:"\nEnvelope-to: test@renoirboulanger.com\nDelivery-date: Mon, "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:av}]},{type:a,value:a$},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:az}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aw}]},{type:a,value:du},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:ba}]},{type:a,value:"\nReceived: from renoirb by web1.renoirboulanger.com with "},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:aV}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aD}]},{type:a,value:"Exim "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dc}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ag}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aD}]},{type:a,value:"envelope-from "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:at}]},{type:a,value:by},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ag}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cI}]},{type:a,value:" 1JTgiM-00057L-SW\n        "},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bd}]},{type:a,value:" test@renoirboulanger.com"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:_}]},{type:a,value:" Mon, "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:av}]},{type:a,value:a$},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:az}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aw}]},{type:a,value:du},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:ba}]},{type:a,value:hO},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dd}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:aV}]},{type:a,value:" a virtuallocal\nMessage-Id: "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:at}]},{type:a,value:"1JSZkp-0001JH-8H@web1.renoirboulanger.com"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:"\nFrom: renoirb@web1.renoirboulanger.com\nDate: Mon, "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:av}]},{type:a,value:a$},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:az}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aw}]},{type:a,value:du},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:ba}]},{type:a,value:"\n\nMessage body\n\n"},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:T}]},{type:a,value:"\nquit                                                  "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:a,value:"Finalement, "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"quit\""}]},{type:a,value:bA},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:"\n+OK\nConnection closed by foreign host.\n"}]}]}]},{type:a,value:e},{type:b,tag:ac,props:{id:hg},children:[{type:b,tag:h,props:{href:"#v%C3%A9rifier-le-log-pop3d",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hh}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Si tout va bien en telnet, pourquoi ne pas tester pour √™tre s√ªr!?"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aW}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cd}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:ce}]},{type:a,value:ia},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:av}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aw}]},{type:a,value:":13:18 web1 vm-pop3d"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dv}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:": User "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:ii}]},{type:a,value:" logged "},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:ij}]},{type:a,value:dm},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:ch}]},{type:a,value:ik},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:il}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bB}]},{type:a,value:ie},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:av}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aw}]},{type:a,value:":13:22 web1 vm-pop3d"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dv}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:": bytes: domain renoirboulanger.com "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"491"}]},{type:a,value:" bytes\n   Feb "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:av}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aw}]},{type:a,value:":13:23 web1 vm-pop3d"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dv}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:": Session ended "},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bd}]},{type:a,value:" user: "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:ii}]},{type:a,value:dm},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:ch}]},{type:a,value:ik},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:il}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bB}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:"ndel"}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cS}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:dr},{type:b,tag:j,props:{},children:[{type:a,value:ds}]},{type:a,value:dt}]},{type:a,value:e},{type:b,tag:ac,props:{id:hi},children:[{type:b,tag:h,props:{href:"#test-envoi-remote-vers-virtual_local-avec-telnet",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hj}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Au lieu d'avoir un programme comme mail install√© sur une station Linux, on peut\nsimplement utiliser telnet avec ces commandes"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"telnet web1.renoirboulanger.com "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:av}]},{type:a,value:"\n   Trying "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cf}]},{type:a,value:cg},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:".\n   Connected to web1.renoirboulanger.com.\n   Escape character is "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:if0}]},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:T}]},{type:a,value:im},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cc}]},{type:a,value:hJ},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dc}]},{type:a,value:" Fri, "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"22"}]},{type:a,value:a$},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:az}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"10"}]},{type:a,value:":42:44 "},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:ba}]},{type:a,value:"\nhelo renoirboulanger.com\n   "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aA}]},{type:a,value:" web1.renoirboulanger.com Hello mtrlpq02-1168108314.sdsl.bell.ca "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:ch}]},{type:a,value:".235.26"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:"\nmail from: lunique@renoirboulanger.com\n   "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aA}]},{type:a,value:" OK\nrcpt to: renoir.boulanger@renoirboulanger.com\n   "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aA}]},{type:a,value:" Accepted\n   data\n   "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dw}]},{type:a,value:" Enter message, ending with "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:in0}]},{type:a,value:" on a line by itself\nSubject: Test courriel "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:io}]},{type:a,value:"\nVia tsc-webmestre-dev dans le bureau de renoirboulanger vers web1 qui va rediriger √† gmail directement"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:eF}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:T}]},{type:a,value:im},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aA}]},{type:a,value:" OK "},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:cI}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:"1JSa3U-0003TM-Tv\nquit\n   "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"221"}]},{type:a,value:" web1.renoirboulanger.com closing connection\n   Connection closed by foreign host.\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Note: les codes 250, 354, 220 sont des numeros de messages voir:\n"},{type:b,tag:h,props:{href:ip,rel:[m,n,o],target:p},children:[{type:a,value:ip}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"J'ai mis trois espaces devant la r√©ponse re√ßue."}]},{type:a,value:e},{type:b,tag:aL,props:{id:"les-commandes-telnet-envoi-smtp"},children:[{type:b,tag:h,props:{href:"#les-commandes-telnet-envoi-smtp",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:"Les commandes telnet envoi smtp"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:"telnet "},{type:b,tag:j,props:{},children:[{type:a,value:"web1.renoirboulanger.com"}]}]}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"... Trying et connected signifient qu'il a essay√© et r√©ussi"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,bK]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"220 web1.renoirboulanger.com ESMTP Exim 4.66 Fri, 22 Feb 2008 10:42:44 -0500\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Signifie 220 (c'est le code du message) que web1 utilise Exim 4.66.... et qu'on\nest le 22 Feb... C'est ok!"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:E,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"helo domaine.du.helo.renoirboulanger.com"}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:dx},{type:b,tag:j,props:{},children:[{type:a,value:iq}]},{type:a,value:"\" puis le domaine de l'envoyant"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:iq}]},{type:a,value:" (et "},{type:b,tag:j,props:{},children:[{type:a,value:"ehlo"}]},{type:a,value:") sont des conventions pour savoir quel est le hostname qui envoit le courriel"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:E,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"mail from: john.doe@example.org"}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:dx},{type:b,tag:j,props:{},children:[{type:a,value:"mail from:"}]},{type:a,value:"\" puis l'adresse de l'envoyant"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Ce qui permet de dire le From: field"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:E,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:"rcpt to: john.doe@example.org"}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:dx},{type:b,tag:j,props:{},children:[{type:a,value:"rcpt to:"}]},{type:a,value:"\" puis l'adresse du recipient"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"C'est le recipient."}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:E,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:hY}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Annonce au MTA (le serveur SMTP) qu'il va envoyer des donn√©es textes"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:E,props:{},children:[{type:b,tag:j,props:{},children:[{type:a,value:hX}]}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Faut au minimum entrer \""},{type:b,tag:j,props:{},children:[{type:a,value:dk}]},{type:a,value:"\" car c'est ce que le serveur attend."}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"√âcrire le message, tout simplement"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:"Terminer"}]},{type:a,value:" par un dernier [procedures:"},{type:b,tag:E,props:{},children:[{type:a,value:"Enter"}]},{type:a,value:"] et laisser un poin\n\""},{type:b,tag:E,props:{},children:[{type:a,value:T}]},{type:a,value:aT}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Ensuite, le message SMTP #"},{type:b,tag:j,props:{},children:[{type:a,value:dw}]},{type:a,value:" annonce que l'on peut √©crire notre courriel a\nvolont√©... jusqu'a ce qu'on ajoute une ligne vide avec uniquement un \".\" (qui\nannonce la fin du message)"}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:hZ}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:ac,props:{id:hk},children:[{type:b,tag:h,props:{href:"#test-envoi-local-vers-une-machine-remote-avec-exim",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hl}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Permet de savoir si l'envoi local vers un remote fonctionne bien"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Il s'agit de l'exemple typique d'un email local envoy√© vers Gmail par exemple."}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:hM},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:aS}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:hN}]},{type:a,value:" sysadmin@renoirboulanger.com\nSubject: Test lundi am "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:ir}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:aV}]},{type:a,value:" to remote\nMessage correct pour voir de l'usager joe sur web1 vers sysadmin hsu at renoirboulanger\n"},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:T}]},{type:a,value:hP},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:de}]},{type:a,value:" joe@web1.renoirboulanger.com "},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:df}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:"joe "},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:dg}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:dh},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:bb}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"437"}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:bc}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"Test lundi am 4 local to remote\""}]},{type:a,value:"\ndelivering 1JSZmM-0001LR-S8\nConnecting to ASPMX.L.GOOGLE.COM "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:is}]},{type:a,value:it},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:":25 "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:". connected\n  SMTP"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:be}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cc}]},{type:a,value:" mx.google.com ESMTP z21si1091485qbc.21\n  SMTP"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:bf}]},{type:a,value:" EHLO web1.renoirboulanger.com\n  SMTP"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:be}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aA}]},{type:a,value:"-mx.google.com at your service, "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:cf}]},{type:a,value:cg},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:iu},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aA}]},{type:a,value:"-SIZE "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"28311552"}]},{type:a,value:iu},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aA}]},{type:a,value:"-8BITMIME\n         "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aA}]},{type:a,value:" ENHANCEDSTATUSCODES\n  SMTP"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:bf}]},{type:a,value:" MAIL FROM:"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:at}]},{type:a,value:iv},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:"SIZE"}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"1470"}]},{type:a,value:dy},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:be}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aA}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:iw}]},{type:a,value:".0 OK\n  SMTP"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:bf}]},{type:a,value:" RCPT TO:"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:at}]},{type:a,value:"a@test.com"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:dy},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:be}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aA}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:iw}]},{type:a,value:".5 OK\n  SMTP"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:bf}]},{type:a,value:" DATA\n  SMTP"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:be}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dw}]},{type:a,value:" Go ahead\n  SMTP"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:bf}]},{type:a,value:" writing message and terminating "},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:in0}]},{type:a,value:dy},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:be}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aA}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"2.0"}]},{type:a,value:".0 OK "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"1203693994"}]},{type:a,value:" z21si1091485qbc.21\n  SMTP"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:bf}]},{type:a,value:" QUIT\nLOG: MAIN\n  "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:" sysadmin@renoirboulanger.com "},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:di}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:at}]},{type:a,value:iv},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:dj}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:"lookuphost "},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:bc}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:"remote_smtp "},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:bb}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"450"}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:"H"}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:"ASPMX.L.GOOGLE.COM "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:is}]},{type:a,value:it},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:"C"}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,N]},children:[{type:a,value:"\"250 2.0.0 OK 1203693994 z21si1091485qbc.21\""}]},{type:a,value:hW}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Note: C'est quoi EHLO ou HELO? voir \"Description du HELO\""}]},{type:a,value:e},{type:b,tag:Z,props:{id:hm},children:[{type:b,tag:h,props:{href:"#tester-mail-remote-vers-mailserver-pour-voir-le-bon-fonctionnement-de-spamassassin",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hn}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Le but de ce test est de s'assurer que le service de spam antivirus est lanc√©,\nil faut s'assurer que le service \"SpamAssassin\" est activ√© dans la config du\nclient dans le pannel, et qu'on envoie le test en remote."}]},{type:a,value:e},{type:b,tag:ac,props:{id:ho},children:[{type:b,tag:h,props:{href:"#envoi-courriel-via-une-machine-remote-via-mail",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hp}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Sert a s'assurer que l'envoi d'un courriel remote (application ou en shell)\nfonctionne bien de l'ext√©rieur."}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"mail test@test.com\nSubject: Test lundi am "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dz}]},{type:a,value:" remote to virtuallocal\nMessage body, with random content\n"},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:T}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:ac,props:{id:hq},children:[{type:b,tag:h,props:{href:"#regarder-le-log-spamd",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hr}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Permet de savoir si le message envoy√© dans le test \"Envoi courriel via une\nmachine remote via mail\" √† bien pass√©"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:cd}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,I,r]},children:[{type:a,value:ce}]},{type:a,value:" \u002Fvar\u002Flog\u002Fmaillog\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:cK},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bX}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aN}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aG}]},{type:a,value:":31:54 web1 spamd"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"3160"}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:": prefork: child states: II\n"},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bH}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aN}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aG}]},{type:a,value:dA},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bC}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:": spamd: connection from web1 "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bz}]},{type:a,value:dq},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:" at port "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:ix}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bB}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aN}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aG}]},{type:a,value:dA},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bC}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:": spamd: setuid to renoirb succeeded\n"},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:ir}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aN}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aG}]},{type:a,value:dA},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bC}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:": spamd: processing message "},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:at}]},{type:a,value:iy},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:iz}]},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:iA}]},{type:a,value:iB},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bd}]},{type:a,value:" renoirb:501\n"},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dd}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aN}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aG}]},{type:a,value:iC},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bC}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:": spamd: identified spam "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aD}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"7.0"}]},{type:a,value:"\u002F5.0"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ag}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:bd}]},{type:a,value:" renoirb:501 "},{type:b,tag:c,props:{className:[d,w]},children:[{type:a,value:ij}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:iD}]},{type:a,value:" seconds, "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:iE}]},{type:a,value:" bytes.\n"},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dz}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aN}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aG}]},{type:a,value:iC},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bC}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:a,value:": spamd: result: Y "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:dz}]},{type:a,value:" - HTML_MESSAGE,RAZOR2_CF_RANGE_51_100,RAZOR2_CF_RANGE_E4_51_100,RAZOR2_CF_RANGE_E8_51_100,RAZOR2_CHECK,RDNS_NONE,URIBL_JP_SURBL "},{type:b,tag:c,props:{className:[d,K,r]},children:[{type:a,value:"scantime"}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:iD}]},{type:a,value:",size"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:iE}]},{type:a,value:",user"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:"renoirb,uid"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"501"}]},{type:a,value:",required_score"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"5.0"}]},{type:a,value:",rhost"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:"web1,raddr"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bz}]},{type:a,value:".0.1,rport"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:ix}]},{type:a,value:",mid"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:at}]},{type:a,value:iy},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:iz}]},{type:b,tag:c,props:{className:[d,r]},children:[{type:a,value:iA}]},{type:a,value:iB},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:ao}]},{type:a,value:",autolearn"},{type:b,tag:c,props:{className:[d,q]},children:[{type:a,value:G}]},{type:a,value:"no\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:cK}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Voici ce que le spamscanner a fait..."}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Ligne 4: Il process le message pour le user"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Ligne 5: Donne le resultat, (soit "},{type:b,tag:E,props:{},children:[{type:a,value:"identified spam"}]},{type:a,value:" ou "},{type:b,tag:E,props:{},children:[{type:a,value:"clean message"}]},{type:a,value:")\navec la note entre parenth√®ses (note re√ßue \u002F note maximale)"}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:"Ligne 6: Le r√©sultat Y=C'est un spam... N=Le message est propre... puis la\nvaleur des tests coul√©s (HTML_MESSAGE,RAZOR2_CF_RANGE_51_100,...)"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:dr},{type:b,tag:j,props:{},children:[{type:a,value:ds}]},{type:a,value:dt}]},{type:a,value:e},{type:b,tag:Z,props:{id:hs},children:[{type:b,tag:h,props:{href:"#tester-spamassassin",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:ht}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Pour savoir comment SpamAssassin (aka. SA) traite le spam, on peut lancer\nquelques commandes comme celles ci."}]},{type:a,value:e},{type:b,tag:aL,props:{id:"sa-avec-tests-razor2-sur-un-sample-spam"},children:[{type:b,tag:h,props:{href:"#sa-avec-tests-razor2-sur-un-sample-spam",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:"SA avec tests Razor2 sur un sample spam"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,bK]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"spamassassin -t -D razor2 \u003C \u002Fusr\u002Fshare\u002Fsample-nonspam.txt\n\n... plusieurs lignes ...\n\n[19464] dbg: razor2: razor2 is available, version 2.82\n Razor-Log: read_file: 16 items read from \u002Fetc\u002Fmail\u002Fspamassassin\u002F.razor\u002Frazor-agent.conf\n Razor-Log: Found razorhome: \u002Fetc\u002Fmail\u002Fspamassassin\u002F.razor\nFeb 28 10:48:38.385733 check[19464]: [ 2] [bootup] Logging initiated LogDebugLevel=9 to stdout\nFeb 28 10:48:38.386209 check[19464]: [ 5] computed razorhome=\u002Fetc\u002Fmail\u002Fspamassassin\u002F.razor, conf=\u002Fetc\u002Fmail\u002Fspamassassin\u002F.razor\u002Frazor-agent.conf, ident=\u002Fetc\u002Fmail\u002Fspamassassin\u002F.razor\u002Fidentity-ruKDx1iKgh\nFeb 28 10:48:38.386500 check[19464]: [ 8] Client supported_engines: 4 8\nFeb 28 10:48:38.386960 check[19464]: [ 8]  prep_mail done: mail 1 headers=293, mime0=616\nFeb 28 10:48:38.387312 check[19464]: [ 5] read_file: 1 items read from \u002Fetc\u002Fmail\u002Fspamassassin\u002F.razor\u002Fservers.discovery.lst\n\n... inclusions des config modulaires ...\n\nFeb 28 10:48:38.405171 check[19464]: [ 5] read_file: 23 items read from \u002Fetc\u002Fmail\u002Fspamassassin\u002F.razor\u002Fserver.joy.cloudmark.com.conf\nFeb 28 10:48:38.405460 check[19464]: [ 5] 162877 seconds before closest server discovery\nFeb 28 10:48:38.405729 check[19464]: [ 6] c301.cloudmark.com is a Catalogue Server srl 5382; computed min_cf=21, Server se: 3BC8\nFeb 28 10:48:38.405995 check[19464]: [ 8] Computed supported_engines: 4 8\nFeb 28 10:48:38.406217 check[19464]: [ 8] Using next closest server c301.cloudmark.com:2703, cached info srl 5382\nFeb 28 10:48:38.406432 check[19464]: [ 8] mail 1 has no subject\nFeb 28 10:48:38.406840 check[19464]: [ 6] preproc: mail 1.0 went from 616 bytes to 503\nFeb 28 10:48:38.407064 check[19464]: [ 6] computing sigs for mail 1.0, len 503\nFeb 28 10:48:38.408529 check[19464]: [ 6] Engine (8) didn't produce a signature for mail 1.0\nFeb 28 10:48:38.408827 check[19464]: [ 6] skipping whitelist file (empty?): \u002Fetc\u002Fmail\u002Fspamassassin\u002F.razor\u002Frazor-whitelist\nFeb 28 10:48:38.409055 check[19464]: [ 5] Connecting to c301.cloudmark.com ...\nFeb 28 10:48:38.440917 check[19464]: [ 8] Connection established\nFeb 28 10:48:38.441071 check[19464]: [ 4] c301.cloudmark.com \u003E\u003E 36 server greeting: sn=C&srl=5403&a=1&a=cg&ep4=7542-10\nFeb 28 10:48:38.441476 check[19464]: [ 4] c301.cloudmark.com \u003C\u003C 25\nFeb 28 10:48:38.441548 check[19464]: [ 6] cn=razor-agents&cv=2.82\nFeb 28 10:48:38.441813 check[19464]: [ 4] c301.cloudmark.com \u003C\u003C 14\nFeb 28 10:48:38.441873 check[19464]: [ 6] a=g&pm=state\nFeb 28 10:48:38.463790 check[19464]: [ 4] c301.cloudmark.com \u003E\u003E 264\nFeb 28 10:48:38.463875 check[19464]: [ 6] response to sent.2\n...\n[19464] dbg: razor2: part=0 engine=4 contested=0 confidence=100\n[19464] dbg: razor2: results: spam? 1\n[19464] dbg: razor2: results: engine 8, highest cf score: 0\n[19464] dbg: razor2: results: engine 4, highest cf score: 100\n[19464] info: rules: meta test HS_PHARMA_1 has dependency 'HS_SUBJ_ONLINE_PHARMACEUTICAL' with a zero score\nReceived: from localhost by web1.renoirboulanger.com\n        with SpamAssassin (version 3.2.0);\n        Thu, 28 Feb 2008 10:48:41 -0500\nFrom: Sender \u003Csender@example.net\u003E\nTo: Recipient \u003Crecipient@example.net\u003E\nSubject: *****SPAM***** Test spam mail (GTUBE)\nDate: Wed, 23 Jul 2003 23:30:00 +0200\nMessage-Id: \u003CGTUBE1.1010101@example.net\u003E\nX-Spam-Flag: YES\nX-Spam-Checker-Version: SpamAssassin 3.2.0 (2007-05-01) on web1.renoirboulanger.com\nX-Spam-Level: **************************************************\nX-Spam-Status: Yes, score=1002.6 required=5.0 tests=AWL,GTUBE,NO_RECEIVED,\n        NO_RELAYS,RAZOR2_CF_RANGE_51_100,RAZOR2_CF_RANGE_E4_51_100,RAZOR2_CHECK\n        autolearn=no version=3.2.0\nMIME-Version: 1.0\nContent-Type: multipart\u002Fmixed; boundary=\"----------=_47C6D7D9.CD6EF8C3\"\n\nThis is a multi-part message in MIME format.\n\n------------=_47C6D7D9.CD6EF8C3\n...Le courriel en tant que tel\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Note: Il existe trois fichiers de tests: "},{type:b,tag:j,props:{},children:[{type:a,value:"\u002Fusr\u002Fshare\u002Fsample-spam.txt"}]},{type:a,value:" (test\nemail sample spam), "},{type:b,tag:j,props:{},children:[{type:a,value:"\u002Fusr\u002Fshare\u002Fsample-nonspam.txt"}]},{type:a,value:" (sample email correct), et\n"},{type:b,tag:j,props:{},children:[{type:a,value:"\u002Fusr\u002Fshare\u002Fsample-virus.txt"}]},{type:a,value:" (pour voir si l'antivirus est ok)"}]},{type:a,value:e},{type:b,tag:Z,props:{id:hu},children:[{type:b,tag:h,props:{href:"#tester-les-relais-smtp",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hv}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Notez que j'ai pas sous la main d'adresse courriel ou serveur connu comme\nspammeur sur notre r√©seau ce qui est tr√®s bien."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Alors si votre test donne pas un r√©sultat similaire... on a un probl√®me de spam!"}]},{type:a,value:e},{type:b,tag:aL,props:{id:"avec-exim--bh"},children:[{type:b,tag:h,props:{href:"#avec-exim--bh",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:"avec exim -bh"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Avec la commande "},{type:b,tag:j,props:{},children:[{type:a,value:"exim -bh IP-ADDRESS EMAIL-ADDRESS"}]},{type:a,value:" on peut savoir comment le\ncourriel passe, s'il est accept√©."}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,bK]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"exim -bh 69.159.235.26 renoirb@gmail.com\n\n**** SMTP testing session as if from host 69.159.235.26\n**** but without any ident (RFC 1413) callback.\n**** This is not for real!\n\n\u003E\u003E\u003E host in hosts_connection_nolog? no (option unset)\n\u003E\u003E\u003E host in host_lookup? yes (matched \"*\")\n\u003E\u003E\u003E looking up host name for 69.159.235.26\n\u003E\u003E\u003E IP address lookup yielded mtrlpq02-1168108314.sdsl.bell.ca\n\u003E\u003E\u003E gethostbyname looked up these IP addresses:\n\u003E\u003E\u003E   name=mtrlpq02-1168108314.sdsl.bell.ca address=69.159.235.26\n\u003E\u003E\u003E checking addresses for mtrlpq02-1168108314.sdsl.bell.ca\n\u003E\u003E\u003E   69.159.235.26 OK\n\u003E\u003E\u003E host in host_reject_connection? no (option unset)\n\u003E\u003E\u003E host in sender_unqualified_hosts? no (option unset)\n\u003E\u003E\u003E host in recipient_unqualified_hosts? no (option unset)\n\u003E\u003E\u003E host in helo_verify_hosts? no (option unset)\n\u003E\u003E\u003E host in helo_try_verify_hosts? no (option unset)\n\u003E\u003E\u003E host in helo_accept_junk_hosts? no (option unset)\n220 web1.renoirboulanger.com ESMTP Exim 4.66 Thu, 28 Feb 2008 11:02:19 -0500\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Exemple de test fonctionnel (On remarque le message "},{type:b,tag:j,props:{},children:[{type:a,value:"220 hostname ESMTP..."}]},{type:a,value:".\nFaire [^c] pour sortir."}]},{type:a,value:e},{type:b,tag:aL,props:{id:"avec-exim_checkaccess"},children:[{type:b,tag:h,props:{href:"#avec-exim_checkaccess",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:"Avec exim_checkaccess"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Une autre version existe qui sort moins de output"}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"exim_checkaccess "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:ch}]},{type:a,value:".235.26 contribs@renoirboulanger.com\nAccepted\n"}]}]}]},{type:a,value:e},{type:b,tag:Z,props:{id:hw},children:[{type:b,tag:h,props:{href:"#statistiques",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hx}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Il existe, a ma m√©moire, actuellement, un outil qui permet de savoir l'Activit√©\ndu serveur. Il est dans un crontab. Voici la commande."}]},{type:a,value:e},{type:b,tag:s,props:{className:[t]},children:[{type:b,tag:u,props:{className:[v,F]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"eximstats \u002Fvar\u002Flog\u002Fexim\u002Fmainlog\n\nExim statistics from "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:az}]},{type:a,value:"-02-24 04:02:35 to "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:az}]},{type:a,value:"-02-28 "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:aG}]},{type:a,value:":11:24\n\nGrand total summary\n-------------------\n                                                                  At least one address\n  TOTAL               Volume   Messages Addresses     Hosts      Delayed       Failed\n  Received             100MB       "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"6049"}]},{type:a,value:"                "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"2029"}]},{type:a,value:"       "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bH}]},{type:a,value:iF},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"0.0"}]},{type:a,value:"%     "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"37"}]},{type:a,value:iF},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"0.6"}]},{type:a,value:"%\n  Delivered            101MB       "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"6174"}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"6336"}]},{type:a,value:"        "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"17"}]},{type:a,value:"\n  Rejects                         "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"45232"}]},{type:a,value:"               "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"21772"}]},{type:a,value:"\n\nDeliveries by transport\n-----------------------\n                      Volume    Messages\n  :blackhole:           12MB        "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"2232"}]},{type:a,value:"\n  address_file         660KB          "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"64"}]},{type:a,value:"\n  remote_smtp          600KB          "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"89"}]},{type:a,value:"\n  spamcheck             46MB        "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"2966"}]},{type:a,value:"\n  virtual_localdelivery    42MB         "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"823"}]},{type:a,value:"\n\nMessages received per hour "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aD}]},{type:a,value:"each dot is "},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:io}]},{type:a,value:" messages"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ag}]},{type:a,value:"\n---------------------------------------------------\n\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:". un tableau par points "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:aD}]},{type:a,value:T},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:ag}]},{type:a,value:" qui donne une id√©e de grandeur de la quantit√© de courriel "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:".\n\nTime spent on the queue: all messages\n-------------------------------------\n\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:".\n\nTime spent on the queue: messages with at least one remote delivery\n-------------------------------------------------------------------\n\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:".\n\nRelayed messages\n----------------\n\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bi}]},{type:a,value:" mail rejection reasons by message count\n----------------------------------------------\n\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bi}]},{type:a,value:" sending hosts by message count\n-------------------------------------\n\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bi}]},{type:a,value:" sending hosts by volume\n------------------------------\n\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bi}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:aV}]},{type:a,value:" senders by message count\n-------------------------------------\n\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bi}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:aV}]},{type:a,value:" senders by volume\n------------------------------\n\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:bi}]},{type:a,value:l},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:dp}]},{type:a,value:" destinations by message count\n-----------------------------------------\n"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:al}]},{type:a,value:".\n\n"}]}]}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Tr√®s utile!"}]},{type:a,value:e},{type:b,tag:Z,props:{id:hy},children:[{type:b,tag:h,props:{href:"#vulgarisation",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hz}]},{type:a,value:e},{type:b,tag:ac,props:{id:hA},children:[{type:b,tag:h,props:{href:"#description-du-helo",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hB}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:d_},{type:b,tag:h,props:{href:dB,rel:[m,n,o],target:p},children:[{type:a,value:dB}]},{type:a,value:" (modifi√©)"}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Une discussion SMTP commence soit par "},{type:b,tag:E,props:{},children:[{type:a,value:"EHLO"}]},{type:a,value:" (ou "},{type:b,tag:E,props:{},children:[{type:a,value:"HELO"}]},{type:a,value:"). Qui, en gros,\nannonce que le serveur de courrier poss√®de quelques features am√©lior√©s compar√©\naux premi√®res g√©n√©rations de serveur smtp."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:ci}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"...But to use later additions to SMTP that have brought about two flavors of the\nlater HELO command (SMTP command generally consist of four characters)."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:ci}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"EHLO, being the more recent one makes the server advertise all the additional\nfeatures (such as delivery status notification or the ability to transport\nmessages that contain other than the safe ASCII characters) it supports."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:ci}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:"Not every server will allow this greeting, but it is required to accept a plain\nHELO which naturally assumes that no additional features are present."}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:a,value:ci}]},{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:E,props:{},children:[{type:a,value:"Both HELO (et EHLO) commands do require the client to specify its domain"}]},{type:a,value:"\nafter the **LO, however."}]},{type:a,value:e},{type:b,tag:Z,props:{id:hC},children:[{type:b,tag:h,props:{href:"#r%C3%A9f%C3%A9rences",ariaHidden:z,tabIndex:B},children:[{type:b,tag:c,props:{className:[C,D]},children:[]}]},{type:a,value:hD}]},{type:a,value:e},{type:b,tag:H,props:{},children:[{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:h,props:{href:"http:\u002F\u002Fwww.netadmintools.com\u002Fpart276.html",rel:[m,n,o],target:p},children:[{type:a,value:"Tester avec telnet"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:h,props:{href:dB,rel:[m,n,o],target:p},children:[{type:a,value:"R√©ferences du protocole SMTP"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:k,props:{},children:[{type:a,value:e},{type:b,tag:f,props:{},children:[{type:b,tag:h,props:{href:"http:\u002F\u002Femail.about.com\u002Fcs\u002Fstandards\u002Fa\u002Fsmtp_error_code.htm",rel:[m,n,o],target:p},children:[{type:a,value:"Definition messages d'erreur SMTP"}]}]},{type:a,value:e}]},{type:a,value:e}]}]},dir:"\u002Fblog\u002F2008\u002F04",path:"\u002Fblog\u002F2008\u002F04\u002Ftester-le-fonctionnement-dun-serveur-smtp",extension:ay,slug:"tester-le-fonctionnement-dun-serveur-smtp",createdAt:iG,updatedAt:iG,category:am,prettyfiedTemporalDate:{prettified:"samedi 19 avril 2008",temporalDate:"2008-04-19"}}],taxonomyKey:ar,taxonomy:{key:ar,human:{key:ar,text:"Op√©rations",description:"Essais √©crits en relation au m√©tier de g√©rer une infrastructure informatique ou infonuagique\net comment entretenir des syst√®mes pour des Applications Web r√©silientes et stables.\n"}}}],fetch:[],mutations:void 0}}("text","element","span","token","\n","p","punctuation","a","number","code","li"," ","nofollow","noopener","noreferrer","_blank","operator","variable","div","nuxt-content-highlight","pre","line-numbers","keyword","em","\\","true","function",-1,"icon","icon-link","strong","language-bash","=","ul","parameter",":","assign-left","td","]","string","comment","[","directive",false,"\n    ",".",2,"builtin","class-name","key","atrule","h2",";",true,"-",3,"h3","app-link-compare-item","{","}",")","app-image","\n\n","\n        ","ol","..","projects","instruction","\u003E","root","---","operations","\n  ","\u003C","property","25","12","publish",".md","2008","250","tr",",","(","en-CA","th","11","procedure","docker","nuxt-link","install","h4","boolean","26","2023-02-18T00:00:00.000Z","webplatform","linux",", ","-v","\"","Fastly","local","sudo","ENV","float:unset;","unchanged","Cloud-Init"," Feb ","-0500","S","T","for","\u003C\u003C","\u003E\u003E",".   Feb ",".\n\nTop ","50","blockquote","MediaWiki","Support MediaWiki special URL patterns","cd","-p","server","cloud-computing","class","IN","type","      ","prefix","line","2024-10-24T19:43:51.725Z","enter","renoirb@web1.renoirboulanger.com","127.0",", enter","3","817","2024-10-24T19:43:51.728Z","screenshots","Screenshots","webplatform.github.io","2","steps","Steps","language-text","$(","pwd","\n       ","listen","server_name","w-1\u002F3","2024-10-24T19:43:51.726Z","A","CNAME","443","include","language-yaml","1","upstream","https:\u002F\u002Fcloudinit.readthedocs.org\u002Fen\u002Flatest\u002F","Cloud-Init reference documentation pages","https:\u002F\u002Fwww.digitalocean.com\u002Fcommunity\u002Ftutorials\u002Fan-introduction-to-cloud-config-scripting","nc","^c","220","tail","-f","66.46",".177.182","69.159","(...)","Discourse","migration","~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F11\u002Fdiscourse_migration_list_gravatar_images.png","Side by side comparison while working on migrating Discourse\nwith WICG\n","open-source","blog","Requirements","Requirements we couldn‚Äôt meet","app-alert-box","webplatform.org","https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fdocs-wpd","What was under \u002Fwiki\u002FWPD:...","webplatform\u002Fmediawiki-conversion","https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fmediawiki-conversion","Export MediaWiki wiki pages and history into a git repository","static.webplatform.org","overflow:hidden;clear:both;","thumbnails","gallery","https:\u002F\u002Fgithub.com\u002Fwebspecs\u002Fpublican","Publican"," or ","\n ","exit","-s","id","mkdir",".\n"," run ","-it","--rm","7002","apt-get","language-nginx","RUN","0","...","\u002Fblog\u002F2015\u002F05","salt-stack","0000","curl","frontend","\n\n    ","wget","An introduction to cloud-config scripting","\n     "," web1.renoirboulanger.com ","4.66","5","\u003C=","U","P","local ","F","R","Subject:","-02-25 "," from ",":01:14 web1 imapd","19532","host",".0.1","Note: Rappel le ","\u002Fvar\u002Flog\u002Fmaillog"," donne le output des login IMAP(imapd), POP\n(vm-pop3d) et SpamAssasin (spamd)",":02:16 ","20764","354","Faut entrer \"","\n  SMTP","6",":32:15 web1 spamd","http:\u002F\u002Femail.about.com\u002Fcs\u002Fstandards\u002Fa\u002Fsmtp.htm","experiments","https:\u002F\u002Fmeta.discourse.org\u002Ft\u002Fmove-your-discourse-instance-to-a-different-server\u002F15721","Move your Discourse instance to a different server","IMPORTANT","cp","discourse","https:\u002F\u002Fmeta.discourse.org\u002Ft\u002Fchange-the-domain-name-or-rename-my-discourse\u002F16098","https:\u002F\u002Fmeta.discourse.org\u002Ft\u002Fmultisite-configuration-with-docker\u002F14084\u002F32","https:\u002F\u002Fmeta.discourse.org\u002Ft\u002Fmultisite-configuration-with-docker\u002F14084\u002F8","2024-10-24T19:43:51.729Z","\u002Fblog\u002F2015\u002F07\u002Fleaving-w3c\u002F","priorities","Priorities","outcome","Outcome","Migration","Blog","mediawiki","requirements","requirements-we-couldnt-meet","display:flex","https:\u002F\u002Fwww.w3.org\u002FPeople\u002Ffunctions\u002Fsysteam","https:\u002F\u002Fwebplatform.github.io\u002F","WebPlatform Docs Home Page","Source: ","table","thead","tbody","https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fdocs","What was under \u002Fwiki\u002F...","https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fdocs-meta","What was under \u002Fwiki\u002FMeta:...","webplatform\u002Fdocs-wpd"," (","https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fblog","Archivator","\n(","MediaWiki XML dump","https:\u002F\u002Fwww.mediawiki.org\u002Fwiki\u002FHelp:Namespaces","\u002Fwiki\u002FWPD:*","https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fcontent-converter","Transform CMS content from a format into another","webplatform\u002Fcontent-converter","20150513130014","http:\u002F\u002Fwebplatform.github.io\u002Fdocs-assets\u002F","https:\u002F\u002Fstatic.webplatform.org\u002Ff\u002Ff1\u002Fhtmlstructure1.jpg","https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fdocs-assets\u002Fblob\u002Fgh-pages\u002Ff\u002Ff1\u002Fhtmlstructure1.jpg","https:\u002F\u002Fwebplatform.github.io\u002Fdocs-assets\u002Ff\u002Ff1\u002Fhtmlstructure1.jpg","https:\u002F\u002Fgithub.com\u002Fwebplatform\u002Fgenerator-docs\u002Fblob\u002Fmaster\u002Fconfig\u002Fnginx\u002Fmaps\u002Fmain.map","#screenshots","run-publican-inside-docker","gists","Gists","#steps"," and "," vagrant ","ssh","!","su","rb-notice-box","my-5","info","header","\u002Fdata\"",":\u002Fsrv\u002Fwebapps\u002Fpublican\u002Fdata ","\u002Fspec-data\"",":\u002Fopt\u002Fbikeshed\u002Fbikeshed\u002Fspec-data ",":7002 webspecs\u002Fpublican:wip\n","outside","It should look like the screenshot with caption \"","\".","service","Starting a build process","\n           ","\"jdoe@example.org\"","80","location"," \u002F","$uri","#","$RUNDIR","flex","flex-row","flex-wrap","~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F05\u002Fpublican-preview.png","~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F05\u002Fpublican-deleted-spec-regeneration-question.png","Annotated screenshot, when changing a file a hook is called and regenerates the specification","Docker","Varnish","It is possible the code shown here no longer works.\nMaybe the code shown here uses parts of Discourse that no longer exists.\n","proposed-setup","Proposed setup","https:\u002F\u002Fmeta.discourse.org\u002Ft\u002Ffull-site-cdn-acceleration-for-discourse\u002F21467\u002F1","@sam","http:\u002F\u002Fexample.org\u002F","discoursepolling.example.org","~\u002Fassets\u002Fcontent\u002Fblog\u002F2015\u002F04\u002Fdiscuss-fastly-origins.png","Fastly service configuration, at Hosts tab","Configure -\u003E Hosts","language-dns-zone-file"," discoursepolling.example.org discourse.example.org"," ssl","snippet","get-openstack-instance-detail-using-salt","Get OpenStack instance detail using Salt","what-data-you-can-get","What data you can get","what-does-the-script-do","What does the script do?","Install","https:\u002F\u002Fgithub.com\u002Fsaltstack\u002Fsalt-contrib\u002Fblob\u002Fmaster\u002Fgrains\u002Fec2_info.py","security-groups","7c55","4dd3","a00000000000\n","app1","availability_zone","\n            vda\n        ","name","\n        None\n    ","http:\u002F\u002Fdocs.openstack.org\u002Fadmin-guide-cloud\u002Fcontent\u002Fsection_metadata-service.html","coord","inserted","Enable a CDN for your Discourse","setup-detail","Setup detail","https:\u002F\u002Fdocs.fastly.com\u002Fguides\u002Fssl\u002Fwhich-ssl-options-are-available","\u002Fblog\u002F2015\u002F05\u002Fmake-discourse-long-polling-work-behind-fastly\u002F","Make Discourse \"long polling\" work behind\nFastly","SSL between ","keepalive","frontends",4," tld ","                 ","on","\u002Fblog\u002F2015\u002F04","why-not-replacing-internal-python-version","Why not replacing internal Python version?","Procedure","incomplete-scratchpad","Incomplete scratchpad","setuptools","Setuptools","resources","Resources","-y","\n        libbluetooth-dev ","\n        libbz2-dev ","\n        libexpat1-dev ","\n        libssl-dev ","make","ln","http:\u002F\u002Fdavebehnke.com\u002Fpython-pyenv-ubuntu.html","https:\u002F\u002Fgithub.com\u002Fyyuu\u002Fpyenv","https:\u002F\u002Fwww.python.org\u002Fdownloads\u002Frelease\u002Fpython-279\u002F","http:\u002F\u002Faboutsimon.com\u002F2012\u002F04\u002F16\u002Fbuilding-a-python-deb-in-a-bootstrapped-ubuntu-chroot-with-fpm\u002F","http:\u002F\u002Fserverfault.com\u002Fquestions\u002F669859\u002Fhow-can-i-upgrade-python-to-2-7-9-on-ubuntu-14-4","http:\u002F\u002Faskubuntu.com\u002Fquestions\u002F101591\u002Fhow-do-i-install-python-2-7-2-on-ubuntu","https:\u002F\u002Fwiki.debian.org\u002FDebootstrap","read-more","Read more","Easily automate The provisioning of your DigitalOcean Droplets ... using Cloud-Init","2013","false","\u002Fsrv\u002Fcloudconfig.yml","nova","2024-10-24T19:43:51.724Z","fr-CA","requis","Requis","bouts-de-code","Bouts de code","billets-inspirants-sur-le-sujet","Billets inspirants sur le sujet","https:\u002F\u002Fgist.github.com\u002FWebPlatformDocs\u002F780307ff289864ba02f5","https:\u002F\u002Fgist.github.com\u002FWebPlatformDocs\u002F563cb12326b92b22a452","https:\u002F\u002Fgist.github.com\u002Frenoirb\u002Fa66b533c46ef7a8de8e3","v√©rifier-si-le-firewall-bloque-certains-services","V√©rifier si le Firewall bloque certains services","tester-le-serveur-courriel","Tester le serveur courriel","cr√©er-un-compte-de-test","Cr√©er un compte de test","test-envoi-local-vers-virtual_local-avec-exim","Test envoi local vers virtual_local avec exim","v√©rifier-le-log-denvoi-smtp","V√©rifier le log d'envoi SMTP","tester-r√©ception-imap","Tester r√©ception IMAP","v√©rifier-le-log-impad","V√©rifier le log impad","v√©rifier-pop-en-telnet","V√©rifier POP en telnet","v√©rifier-le-log-pop3d","V√©rifier le log pop3d","test-envoi-remote-vers-virtual_local-avec-telnet","Test envoi remote vers virtual_local avec telnet","test-envoi-local-vers-une-machine-remote-avec-exim","Test envoi local vers une machine remote avec exim","tester-mail-remote-vers-mailserver-pour-voir-le-bon-fonctionnement-de-spamassassin","Tester mail remote vers mailserver pour voir le bon fonctionnement de SpamAssassin","envoi-courriel-via-une-machine-remote-via-mail","Envoi courriel via une machine remote via mail","regarder-le-log-spamd","Regarder le log spamd","tester-spamassassin","Tester SpamAssassin","tester-les-relais-smtp","Tester les relais SMTP","statistiques","Statistiques","vulgarisation","Vulgarisation","description-du-helo","Description du HELO","r√©f√©rences","R√©f√©rences","IMAP","143","21","110","1.1"," web1.renoirboulanger.com ESMTP Exim ","kbd",", \"","exim ","-odf","\nSubject: Test lundi am ","\nLOG: MAIN\n  "," renoirb@web1.renoirboulanger.com ","renoirb ","390","\"Test lundi am 5 local a virtuallocal\"","virtual_user ","virtual_localdelivery ","\nLOG: MAIN\n  Completed\n","Subject: LE SUJET","data","Voil√†!",":02:16 1JSZkp-0001JH-8H ","test"," \u002Fvar\u002Flog\u002Fmaillog\n   Feb ","user","test@renoirboulanger.com ","web1 ","\n   Feb ","'^]'","Entrer ","494","'test@renoirboulanger.com'","in",".235.26, ","nmsgs","\n   ","\".\"","7","http:\u002F\u002Femail.about.com\u002Fcs\u002Fstandards\u002Fa\u002Fsmtp_error_code_2.htm","helo","4","72.14",".205.27","\n         ","joe@web1.renoirboulanger.com","2.1","56256","000801c87894","$66546900","$c07bcf52","@adminhotel",":32:19 web1 spamd","4.1","1602","  ","2024-10-24T19:43:51.677Z")));