<!doctype html>
<html data-n-head-ssr class="layout--default zone__sandwich light-mode" lang="en-CA" data-n-head="%7B%22class%22:%7B%22ssr%22:%5B%22layout--default%22,%22zone__sandwich%22,%22light-mode%22%5D%7D,%22lang%22:%7B%22ssr%22:%22en-CA%22%7D%7D">
  <head>
    <title>Thoughts about improving load resiliency for CMS driven Websites - Renoir Boulanger</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content=""><meta data-n-head="ssr" property="og:image" content="https://secure.gravatar.com/avatar/cbf8c9036c204fe85e15155f9d70faec?s=400"><meta data-n-head="ssr" property="twitter:card" content="summary_large_image"><meta data-n-head="ssr" property="twitter:site" content="@renoirb"><meta data-n-head="ssr" data-hid="keywords-mdn-mozilla-dja" name="keywords" content="MDN, Mozilla, Django, Kuma"><base href="/site/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="alternate" type="application/rss+xml" title="Renoir Boulanger’s Page Updates RSS Feed" href="https://renoirboulanger.com/feed.xml"><link data-n-head="ssr" rel="alternate" type="application/feed+json" title="Renoir Boulanger’s Page Updates Feed" href="https://renoirboulanger.com/feed.json"><link rel="preload" href="/_nuxt/runtime.js" as="script"><link rel="preload" href="/_nuxt/commons/app.js" as="script"><link rel="preload" href="/_nuxt/vendors/app.css" as="style"><link rel="preload" href="/_nuxt/vendors/app.js" as="script"><link rel="preload" href="/_nuxt/app.css" as="style"><link rel="preload" href="/_nuxt/app.js" as="script"><link rel="preload" href="/_nuxt/pages/blog.css" as="style"><link rel="preload" href="/_nuxt/pages/blog.js" as="script"><link rel="preload" href="/_nuxt/pages/blog/_year.js" as="script"><link rel="preload" href="/_nuxt/pages/blog/_year/_month.js" as="script"><link rel="preload" href="/_nuxt/pages/blog/_year/_month/_slug.css" as="style"><link rel="preload" href="/_nuxt/pages/blog/_year/_month/_slug.js" as="script"><link rel="stylesheet" href="/_nuxt/vendors/app.css"><link rel="stylesheet" href="/_nuxt/app.css"><link rel="stylesheet" href="/_nuxt/pages/blog.css"><link rel="stylesheet" href="/_nuxt/pages/blog/_year/_month/_slug.css"><link rel="preload" href="/site/_nuxt/static/1729800241/blog/2015/08/thoughts-improving-load-resiliency-cms-driven-websites/state.js" as="script"><link rel="preload" href="/site/_nuxt/static/1729800241/blog/2015/08/thoughts-improving-load-resiliency-cms-driven-websites/payload.js" as="script">
  </head>
  <body>
    <script data-n-head="ssr" data-hid="nuxt-color-mode-script" data-pbody="true">!function (){"use strict";var e=window,t=document,s=t.documentElement,n=["dark","light"],a=function(e){for(var s=e+"=",n=t.cookie.split(";"),a=0;a<n.length;a++){for(var o=n[a];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(s))return o.substring(s.length,o.length)}return null}("nuxt-color-mode")||"light",o="system"===a?i():a;function r(e){var t=e+"-mode";s.classList?s.classList.add(t):s.className+=" "+t}function c(t){return e.matchMedia("(prefers-color-scheme"+t+")")}function i(){if(e.matchMedia&&"not all"!==c("").media)for(var t of n)if(c(":"+t).matches)return t;return"light"}r(o),e["__NUXT_COLOR_MODE__"]={preference:a,value:o,getColorScheme:i,addClass:r,removeClass:function(e){var t=e+"-mode";s.classList?s.classList.remove(t):s.className=s.className.replace(new RegExp(t,"g"),"")}}}();
</script><div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="layouts--default"><!----> <nav class="app-side-bar--component fixed z-40 w-full top z-50" data-v-cf57f860 data-v-2b2f37b3><div class="zone__sandwich__top container flex items-center justify-between py-4 mx-auto" style="position:relative" data-v-cf57f860><!----> <div class="app-side-bar__identity md:px-5 flex items-center" data-v-cf57f860><button aria-label="Open Menu" class="md:hidden ml-5 mr-2" data-v-cf57f860><svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" class="w-8 h-8" data-v-cf57f860><path d="M4 6h16M4 12h16M4 18h16" data-v-cf57f860></path></svg></button> <a href="/" data-wip="components/global/AppSideBar.vue" class="identity__text font-semibold nuxt-link-active" data-v-cf57f860>
        Renoir Boulanger
      </a></div> <div class="app-side-bar__nav flex items-center" data-v-cf57f860><div class="md:flex md:justify-between md:bg-transparent text-is-italicized hidden" data-v-cf57f860><a href="/blog" class="hover:opacity-100 opacity-80 hover:underline flex items-center p-3 px-4 py-2 mr-2 font-medium text-center rounded nuxt-link-active" data-v-2b2f37b3>
      Blog
    </a><a href="/projects" class="hover:opacity-100 opacity-80 hover:underline flex items-center p-3 px-4 py-2 mr-2 font-medium text-center rounded" data-v-2b2f37b3>
      Projects
    </a><a href="/resume/as-code" class="hover:opacity-100 opacity-80 hover:underline flex items-center p-3 px-4 py-2 mr-2 font-medium text-center rounded" data-v-2b2f37b3>
      Resume
    </a><a href="/hello" class="hover:opacity-100 opacity-80 hover:underline flex items-center p-3 px-4 py-2 mr-2 font-medium text-center rounded" data-v-2b2f37b3>
      About
    </a></div></div></div> <aside class="md:invisible app-side-bar__aside fixed top-0 left-0 visible w-64 h-full overflow-auto transition-all duration-500 ease-in-out transform -translate-x-full" data-v-cf57f860><div class="app-side-bar__identity flex items-center w-full h-16 p-4 border-b" data-v-cf57f860><a href="/" class="identity__text nuxt-link-active" data-v-cf57f860>Renoir Boulanger</a></div> <div data-v-cf57f860><a href="/blog" class="hover:bg-teal-500 hover:text-white flex items-center p-4 nuxt-link-active" data-v-cf57f860><span class="mr-2" data-v-cf57f860>
          Blog
        </span></a><a href="/projects" class="hover:bg-teal-500 hover:text-white flex items-center p-4" data-v-cf57f860><span class="mr-2" data-v-cf57f860>
          Projects
        </span></a><a href="/resume/as-code" class="hover:bg-teal-500 hover:text-white flex items-center p-4" data-v-cf57f860><span class="mr-2" data-v-cf57f860>
          Resume
        </span></a><a href="/hello" class="hover:bg-teal-500 hover:text-white flex items-center p-4" data-v-cf57f860><span class="mr-2" data-v-cf57f860>
          About
        </span></a></div></aside></nav> <div class="fixed inset-0 z-40 transition-opacity" style="display:none"><div class="absolute inset-0 bg-black opacity-75"></div></div> <main class="zone__sandwich__meat middle container z-40 mx-auto"><div data-wip="layout/default.vue" class="md:m-10 grid grid-cols-1 m-5"><section data-wip="pages/blog.vue" class="pages__blog--parent"><div class="pages-blog--parent--top justify-items-stretch sm:grid-cols-2 sm:grid-flow-row md:grid-flow-col-dense grid grid-cols-1 gap-4"><nav class="breadcrumb" data-v-ede238bc><ol class="list-none p-0 inline-flex" data-v-ede238bc><li class="flex items-center" data-v-ede238bc><a href="/blog" class="nuxt-link-active" data-v-ede238bc>blog</a></li><li class="flex items-center" data-v-ede238bc><a href="/blog/2015" class="nuxt-link-active" data-v-ede238bc>2015</a></li><li class="flex items-center" data-v-ede238bc><a href="/blog/2015/08" class="nuxt-link-active" data-v-ede238bc>08</a></li></ol></nav></div> <!----> <div class="pages-blog--parent--bottom"><div q=""><!----> <div><div class="pages__blog__year__month--parent"><div class="pages__blog__year__month__slug--item" data-v-79a168f2><div data-v-79a168f2><rb-notice-box variant="warn" role="alert" class="disposition-parent app-alert-box my-4" data-v-79a168f2 data-v-79a168f2><!----> <!----> <div class="nuxt-content" data-v-79a168f2><p data-v-79a168f2>This was written at the time I was collaborating with <em data-v-79a168f2>Mozilla</em> on the <abbr lang="en" title="Mozilla Developer Network" data-v-79a168f2>MDN</abbr> project
on <a href="https://groups.google.com/d/msg/mozilla.dev.mdn/4_bFfpyvYMk/8c6S6cblZ4kJ" rel="nofollow noopener noreferrer" target="_blank" title="RE: Proposal to help scale MDN" data-v-79a168f2>a discussion about scaling the site</a>.
It was related to a contract I was working on to help on Mozilla’s Compatibility tables,
based on my <a href="https://webplatform.github.io/docs/WPD/Projects/CompaTables/" rel="nofollow noopener noreferrer" target="_blank" title="WebPlatform browser compatibility support table" data-v-79a168f2>own research about <strong data-v-79a168f2>Compatibility Tables</strong> for <strong data-v-79a168f2>WebPlatform Docs</strong></a>.</p></div></rb-notice-box></div> <div class="document document--item z-30" data-v-79a168f2><div data-wip="pages/blog/_year/_month/_slug.vue" class="title page-title lg:pr-64 mb-4 font-serif text-2xl italic" data-v-79a168f2><h1 data-v-79a168f2>Thoughts about improving load resiliency for <abbr lang="en" title="Content Management System">CMS</abbr> driven Websites</h1></div> <div class="mt-0 mb-5 font-serif text-sm italic" data-v-79a168f2><time datetime="2015-08-12" data-v-79a168f2>
        Wednesday, August 12, 2015
      </time> <a href="https://renoirboulanger.com/blog/2015/08/thoughts-improving-load-resiliency-cms-driven-websites/" lang="en" target="_blank" title="Canonical link, the URL it is meant to replace" class="canonical-link hidden" data-v-79a168f2>
        Canonical
      </a></div> <div class="taxonomy mt-0 mb-5 taxonomy-hoverizable" data-v-79a168f2><strong id="tags__222" class="taxonomy-label">
    Tags
  </strong> <ul aria-labelled-by="tags__222" class="taxonomy-items"><li class="px-2 py-1 mb-3 mr-3 is-hoverizable"><nuxtlink to="/blog/tag/vulgarization" class="no-underline">vulgarization</nuxtlink></li><li class="px-2 py-1 mb-3 mr-3 is-hoverizable"><nuxtlink to="/blog/tag/development" class="no-underline">development</nuxtlink></li> <li class="category px-2 py-1 mb-3 mr-3 is-hoverizable"><a href="/blog/category/web-integration-review" class="no-underline">📁 web-integration-review</a></li></ul></div> <div class="body mt-10" data-v-79a168f2><figure class="document-cover md:float-right lg:w-1/3 md:pl-5 sm:w-1/2 relative z-30 float-none pb-5 pl-0 mx-auto mt-1 app-image is-loading has-image" data-v-33ff8cb7 data-v-79a168f2><img anonymous loading="lazy" src="https://renoirb.github.io/site-assets/assets/content/blog/2015/08/2015-08-12-What-makes-a-page-unique-1024x921.png" alt="What makes a content site page unique from what an anonymous visitor can get?
" data-remote="https://renoirb.github.io/site-assets/assets/content/blog/2015/08/2015-08-12-What-makes-a-page-unique-1024x921.png" class="object-cover w-full rounded" data-v-33ff8cb7> <figcaption class="relative z-30 p-4 mt-2 text-sm rounded-md shadow-md" data-v-33ff8cb7><span class="figcaption-contents" data-v-33ff8cb7> </span> <div class="nuxt-content" data-v-33ff8cb7 data-v-79a168f2><p data-v-33ff8cb7 data-v-79a168f2>When we think about it, except minor details such as the current user’s info, a web page is pretty much the same for everyone.
There has to be a way to structure Front-End code to make a clear
separation and leverage more caching.
The case of Mozilla’s <abbr lang="en" title="Mozilla Developer Network" data-v-33ff8cb7 data-v-79a168f2>MDN</abbr> is most certainly not the first one.</p></div></figcaption></figure> <div class="nuxt-content" data-v-79a168f2 data-v-79a168f2><p data-v-79a168f2 data-v-79a168f2>The following is an article I wrote based on a <a href="https://groups.google.com/d/msg/mozilla.dev.mdn/4_bFfpyvYMk/KkO0alAfAgAJ" rel="nofollow noopener noreferrer" target="_blank" data-v-79a168f2 data-v-79a168f2>note I sent to the Mozilla
Developer Network mailing list</a> about an idea that crossed my mind to help
scale a CMS driven website.</p>
<p data-v-79a168f2 data-v-79a168f2>I'm convinced i am not the first one who came out with a similar idea, but I
thought it would be useful to share anyway.</p>
<h2 id="whats-common-on-a-cms-driven-website" data-v-79a168f2 data-v-79a168f2><a href="#whats-common-on-a-cms-driven-website" aria-hidden="true" tabindex="-1" data-v-79a168f2 data-v-79a168f2><span class="icon icon-link" data-v-79a168f2 data-v-79a168f2></span></a>What's common on a CMS driven Website?</h2>
<p data-v-79a168f2 data-v-79a168f2>What affects the page load is what happens in the backend before getting HTML
back to the web browser. Sometimes its about converting the text stored in the
database back into HTML, making some specific views, and the list can go on and
on.</p>
<p data-v-79a168f2 data-v-79a168f2>Problem is that we are spending a lot of CPU cycles to end up serving time and
time again the same content, unique for each user when about 90% the generated
content could be exactly the same for everybody.</p>
<p data-v-79a168f2 data-v-79a168f2>with web apps is that we make backend servers generate HTML as if it was unique
when, in truth, most of it could be cached.</p>
<p data-v-79a168f2 data-v-79a168f2>What if we could make a separation between what's common, and use caching and
serve it to everybody.</p>
<h2 id="how-http-cache-works-roughly" data-v-79a168f2 data-v-79a168f2><a href="#how-http-cache-works-roughly" aria-hidden="true" tabindex="-1" data-v-79a168f2 data-v-79a168f2><span class="icon icon-link" data-v-79a168f2 data-v-79a168f2></span></a>How HTTP cache works, roughly</h2>
<p data-v-79a168f2 data-v-79a168f2>Regardless of what software does it: Squid, Varnish, NGINX, Zeus, caching is
done the same way.</p>
<p data-v-79a168f2 data-v-79a168f2>In the end, the HTTP caching layer basically keeps in RAM generated HTTP
Response body and keeps in memory based on the headers it had when it passed it
through to the original request. Only GET Responses, <em data-v-79a168f2 data-v-79a168f2>without cookies</em>, are
cacheable. Other response body coming from a [<code data-v-79a168f2 data-v-79a168f2>PUT</code>, <code data-v-79a168f2 data-v-79a168f2>DELETE</code>, <code data-v-79a168f2 data-v-79a168f2>POST</code>] request
aren't.</p>
<p data-v-79a168f2 data-v-79a168f2>To come back on my previous example, what part is unique in the the current user
compared to what the anonymous visitor gets on a documentation Website page.</p>
<p data-v-79a168f2 data-v-79a168f2>What does a Website view serves us then? The content of the page, the "chrome"
(what's always there), Links to account settings, edit, or visualize details for
the current page, account settings, the username, link to logout.</p>
<p data-v-79a168f2 data-v-79a168f2>It means we are making unique content for things that could be cached and
wasting cycles.</p>
<p data-v-79a168f2 data-v-79a168f2>Even then, most of the content is cacheable because they would generally be with
the same paths in the CMS.</p>
<h2 id="how-about-we-separate-dynamic-from-static" data-v-79a168f2 data-v-79a168f2><a href="#how-about-we-separate-dynamic-from-static" aria-hidden="true" tabindex="-1" data-v-79a168f2 data-v-79a168f2><span class="icon icon-link" data-v-79a168f2 data-v-79a168f2></span></a>How about we separate dynamic from static?</h2>
<figure class="app-image is-loading has-image" data-v-33ff8cb7 data-v-79a168f2><img anonymous loading="lazy" src="https://renoirb.github.io/site-assets/assets/content/blog/2015/10/2015-09-21-Running-MDN-and-BrowserCompat.png" alt="Experimenting with Django/Kuma and making HTML Partial URLs" data-remote="https://renoirb.github.io/site-assets/assets/content/blog/2015/10/2015-09-21-Running-MDN-and-BrowserCompat.png" class="object-cover w-full rounded" data-v-33ff8cb7> <figcaption class="relative z-30 p-4 mt-2 text-sm rounded-md shadow-md" data-v-33ff8cb7><span class="figcaption-contents" data-v-33ff8cb7> </span> 
<p data-v-33ff8cb7 data-v-79a168f2>An example of running a presentation only HTML partial serving specialized service.</p>
<p data-v-33ff8cb7 data-v-79a168f2>We could make <a href="https://github.com/mdn/browsercompat" rel="nofollow noopener noreferrer" target="_blank" title="The Browser Compatibility API was a project to support compatibility data on the Mozilla Developer Network. " data-v-33ff8cb7 data-v-79a168f2><strong data-v-33ff8cb7 data-v-79a168f2>MDN</strong>’s <em data-v-33ff8cb7 data-v-79a168f2>BrowserCompat</em> API</a> where we could
leverage to fill in compatibiliby table back into MDN.
This screenshot dates back from 2015.</p>
</figcaption></figure>
<p data-v-79a168f2 data-v-79a168f2>This makes me wonder if we could improve site resiliency by leveraging HTTP
caching, strip off <em data-v-79a168f2 data-v-79a168f2>any cookies</em>, and factor out what's unique on a page so that
we get the same output for any context.</p>
<p data-v-79a168f2 data-v-79a168f2>As for the contextual parts of the site 'chrome', how about we expose a
context-root which would take care of serving dynamically generated HTML to use
as partials.</p>
<p data-v-79a168f2 data-v-79a168f2>One way of doing it would be to make that context-root generate simple HTML
strings that we can pass to a JavaScript manager that'll convert it into DOM and
inject it in the 'chrome'.</p>
<p data-v-79a168f2 data-v-79a168f2>Since we can make cookies to be isolated to specific context-roots, we can keep
the statefulness of the session on MDN and have a clear separation of what's
dynamic and what's not.</p></div> <div class="clearfix" data-v-79a168f2></div></div> <div class="text-md grid grid-cols-2 my-10" style="display:none" data-v-4d2003f9 data-v-79a168f2><div class="text-left" data-v-4d2003f9><a href="/blog/2015/08/managing-pgp-private-keys-share-across-machines" lang="en-CA" class="hover:underline item-prev" data-v-4d2003f9>
      Managing my PGP/OpenPGP keys and share across many machines
    </a></div> <div class="text-right" data-v-4d2003f9><a href="/blog/2015/11/recover-discourse-backup-change-domain-name" lang="en-CA" class="hover:underline item-next" data-v-4d2003f9>
      Recover Discourse from a backup, adjust domain name
    </a></div></div></div></div></div></div></div></div></section></div></main> <div timezone="America/New_York" class="app-footer--component disposition-parent w-full bottom" data-v-7116e49f><footer class="zone__sandwich__bottom container flex items-center justify-between p-10 mx-auto" style="position:relative" data-v-7116e49f><dl class="contact items-item disposition-item" data-v-7116e49f><dt class="mb-4 font-serif text-2xl" data-v-7116e49f><a href="/contact" class="underline" data-v-7116e49f>Contact</a></dt> <dd data-v-7116e49f>Fascinated By The Open Web Platform</dd> <dd aria-errormessage="why-fou-de-la-pouitte" data-v-7116e49f>
        Send your remarks using
        <em data-fou-de-la-pouitte title="Please type this manually" class="underline" data-v-7116e49f><span id="why-fou-de-la-pouitte" class="sr-only" data-v-7116e49f>
            An email address written using CSS, apologies for obfuscating
            this.
          </span></em></dd> <dd class="underline sr-only" data-v-7116e49f><a rel="me" href="https://mastodon.social/@renoirb" data-v-7116e49f>
          @renoirb@mastodon.social
        </a></dd> <dd class="underline sr-only" data-v-7116e49f><a rel="me" href="https://w3c.social/@renoirb" data-v-7116e49f>
          @renoirb@w3c.social
        </a></dd> <dd class="font-mono" data-v-7116e49f>v4.0.0-dev</dd> <span class="inline-flex" data-v-7116e49f><button aria-label="Color Mode" class="hover:text-primary-500 focus:outline-none transition duration-150 ease-in-out rounded-md"><!----> <!----></button></span></dl> <div class="items-item disposition-item" data-v-7116e49f><dl lang="fr-CA" class="see-also" data-v-7116e49f><dt data-v-7116e49f>Voir aussi…</dt> <dd data-v-7116e49f><a href="/ligne-editoriale" data-v-7116e49f> Ligne éditoriale </a></dd> <dd data-v-7116e49f><a href="/projects" data-v-7116e49f> Projets </a></dd> <dd data-v-7116e49f><a href="/glossary" lang="en" data-v-7116e49f> Glossary </a></dd> <dd data-v-7116e49f><a href="/code-review" lang="en" data-v-7116e49f>
            Code-Review notes
          </a></dd></dl></div></footer></div></div></div></div><script defer src="/site/_nuxt/static/1729800241/blog/2015/08/thoughts-improving-load-resiliency-cms-driven-websites/state.js"></script><script src="/_nuxt/runtime.js" defer></script><script src="/_nuxt/pages/blog.js" defer></script><script src="/_nuxt/pages/blog/_year.js" defer></script><script src="/_nuxt/pages/blog/_year/_month.js" defer></script><script src="/_nuxt/pages/blog/_year/_month/_slug.js" defer></script><script src="/_nuxt/commons/app.js" defer></script><script src="/_nuxt/vendors/app.js" defer></script><script src="/_nuxt/app.js" defer></script><script data-n-head="ssr" type="module" vmid="load-esm-modules-separately-please" data-body="true" defer>
/**
 * #WIP-Mingle-CustomElements-From-ESM-Modules: Added on 2024-09-18 during migration.
 */
import { registerCustomElement } from 'https://renoirb.com/esm-modules/element-utils.mjs'
import NoticeBoxElement from 'https://renoirb.com/esm-modules/notice-box-element.mjs'
try {
  registerCustomElement(window, 'rb-notice-box', NoticeBoxElement)
} catch (e) {
  // #XXX FIX ME because this gets loaded
  console.log('Already loaded', e)
}
        </script>
  </body>
</html>
